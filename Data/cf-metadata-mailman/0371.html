<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
<meta name="generator" content="hypermail 2.3.0, see http://www.hypermail-project.org/" />
<title>[CF-metadata] CF and multi-forecast system ensemble data from Bryan Lawrence on 2006-10-26 (cf-metadata-mailman)</title>
<meta name="Author" content="Bryan Lawrence (b.n.lawrence)" />
<meta name="Subject" content="[CF-metadata] CF and multi-forecast system ensemble data" />
<meta name="Date" content="2006-10-26" />
<style type="text/css">
/*<![CDATA[*/
/* To be incorporated in the main stylesheet, don't code it in hypermail! */
body {color: black; background: #ffffff}
dfn {font-weight: bold;}
pre { background-color:inherit;}
.head { border-bottom:1px solid black;}
.foot { border-top:1px solid black;}
th {font-style:italic;}
table { margin-left:2em;}map ul {list-style:none;}
#mid { font-size:0.9em;}
#received { float:right;}
address { font-style:inherit ;}
/*]]>*/
.quotelev1 {color : #990099}
.quotelev2 {color : #ff7700}
.quotelev3 {color : #007799}
.quotelev4 {color : #95c500}
.period {font-weight: bold}
</style>
</head>
<body>
<div class="head">
<a style="text-decoration:none" href="./0370.html"><img src="./red-arrow-left.jpg" width="50" alt="&lArr;"></a> <a style="text-decoration:none" href="./0372.html"><img src="./red-arrow-right.jpg" width="50" alt="&rArr;"></a><h1>[CF-metadata] CF and multi-forecast system ensemble data</h1>
<!-- received="Thu Oct 26 09:53:53 2006" -->
<!-- isoreceived="20061026085353" -->
<!-- sent="Thu, 26 Oct 2006 16:53:53 +0100" -->
<!-- isosent="20061026155353" -->
<!-- name="Bryan Lawrence" -->
<!-- email="b.n.lawrence" -->
<!-- subject="[CF-metadata] CF and multi-forecast system ensemble data" -->
<!-- id="1161878033.32416.73.camel_at_localhost.localdomain" -->
<!-- charset="US-ASCII" -->
<!-- inreplyto="1161865923.20338.148.camel_at_eld408.desktop.frd.metoffice.com" -->
<!-- expires="-1" -->
<map id="navbar" name="navbar">
<ul class="links">
<li>
<dfn>This message</dfn>:
[ <a href="#start371" name="options1" id="options1" tabindex="1">Message body</a> ]
 [ More options (<a href="#options2">top</a>, <a href="#options3">bottom</a>) ]
</li>
<li>
<dfn>Related messages</dfn>:
<!-- unext="start" -->
[ <a href="./0372.html" accesskey="d" title="John Caron: &quot;[CF-metadata] CF and multi-forecast system ensemble data&quot;">Next message</a> ]
[ <a href="./0370.html" title="Kettleborough, Jamie: &quot;[CF-metadata] CF and multi-forecast system ensemble data&quot;">Previous message</a> ]
[ <a href="./0370.html" title="Kettleborough, Jamie: &quot;[CF-metadata] CF and multi-forecast system ensemble data&quot;">In reply to</a> ]
<!-- unextthread="start" -->
[ <a href="./0372.html" accesskey="t" title="John Caron: &quot;[CF-metadata] CF and multi-forecast system ensemble data&quot;">Next in thread</a> ]
 [ <a href="#replies">Replies</a> ]
<!-- ureply="end" -->
</li>
</ul>
</map>
<ul class="links">
<li><a name="options2" id="options2"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="index.html#msg371" title="Contemporary messages by date">by date</a> ] [ <a href="thread.html#msg371" title="Contemporary discussion threads">by thread</a> ] [ <a href="subject.html#msg371" title="Contemporary messages by subject">by subject</a> ] [ <a href="author.html#msg371" title="Contemporary messages by author">by author</a> ] [ <a href="attachment.html" title="Contemporary messages by attachment">by messages with attachments</a> ]</li>
</ul>
</div>
<!-- body="start" -->
<div class="mail">
<address class="headers">
<span id="from">
<dfn>From</dfn>: Bryan Lawrence &lt;<a href="mailto:b.n.lawrence?Subject=Re%3A%20%5BCF-metadata%5D%20CF%20and%20multi-forecast%20system%20ensemble%20data">b.n.lawrence</a>&gt;
</span><br />
<span id="date"><dfn>Date</dfn>: Thu, 26 Oct 2006 16:53:53 +0100</span><br />
</address>
<br />
Hi Folks
<br />
<br />This email has no new information, just me attempting to get the email thread 
<br />
between Jonathan, Jamie and Paco into something I can digest.  I'm sending
<br />
it to the list as a public service. Feel free to ignore it if your mail
<br />
client allows you to digest Jamie's attachments without reflux ...
<br />
<br />Please, please, can we have these discussions in public !!!
<br />
<br />I'll respond to the actual content tomorrow. It may require thinking, it
<br />
certainly requires reading :-)
<br />
<br />Bryan
<br />
<br />----------------------------------------------------------------------------
<br />
<br />Jamie's Summary email (26th of October)
<br />
<br />Hello,
<br />
<br />first - apologies, I took this thread off list, but it has thrown up a
<br />
lot of issues and I think we need to bring it back to a more public
<br />
forum - but this means bombarding everyone with a set of mails all in
<br />
one go.  I'll try and summarise, but will include all mails for context.
<br />
I hope this is OK, and doesn't make this too laborious to follow.
<br />
<br />We have not settled all the issues - but here is my attempt at
<br />
summarising, what I think the current consensus is - I'm sure Jonathan
<br />
or Paco will correct me if I've misrepresented them.
<br />
<br />1) Ensemble forecasts are made over a range of time scales (short-range,
<br />
medium-range, seasonal, decadal, climate) and as far as possible we
<br />
should make sure any additions to the CF standard are applicable to all
<br />
time scales.  Its probably true that not all communities are represented
<br />
on this list... which we need to do something about to make any
<br />
suggestion useful across the board.  (I'm happy to run any suggestions
<br />
we come up with past the various ensemble groups we have at the Met
<br />
Office)
<br />
<br />2) A useful addition to the CF standard to help support ensemble
<br />
forecasts is to assign standard names to some global attributes.  This
<br />
then enables you to make NetCDF files with multi model variables in them
<br />
and carrying across the global attribute information from any single
<br />
model files. 
<br />
<br />e.g.  files mod1.nc, mod2.nc ... mod30.nc look like
<br />
<br />netcdf mod1.nc { ...
<br />
<br />variables:
<br />
&nbsp;&nbsp;&nbsp;float temp(time,lat,lon);
<br />
...
<br />
// global attributes
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: source = 'model 1 output'
<br />
}
<br />
<br />netcdf mod2.nc { ...
<br />
<br />variables:
<br />
&nbsp;&nbsp;&nbsp;float temp(time,lat,lon);
<br />
...
<br />
//global attributes
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: source = 'model 2 output'
<br />
<br />}
<br />
<br />&nbsp;etc.
<br />
<br />This then becomes a file with multi model variables
<br />
<br />netcdf ens.nc {
<br />
<br />dimensions:
<br />
...
<br />
&nbsp;&nbsp;&nbsp;realization = 30;
<br />
&nbsp;&nbsp;&nbsp;len80 = 80 ;
<br />
<br />variables:
<br />
&nbsp;&nbsp;&nbsp;float temp(time,realization,lat,lon);
<br />
<br />&nbsp;&nbsp;&nbsp;char source(realization,len80) ;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;source:standard_name='source' ;
<br />
<br />data:
<br />
&nbsp;&nbsp;&nbsp;source=['model 1 output', 'model 2 output',...]
<br />
<br />}
<br />
<br />2) New standard names 'source', 'institution', (leaving the other global
<br />
attributes mentioned in CF 2.6.2 until they are needed by someone -
<br />
though for compatibility with CMOR we may need to make 'title' a
<br />
standard name from the outset.)
<br />
<br />3) for model data use the global attribute 'source' and any variables
<br />
with the standard_name 'source' to indicate the model used (just as CMOR
<br />
does) e.g. HadCM3. This can be extended to support perturbed physics
<br />
memebers if needed.  This covers Paco's original suggestions of
<br />
forecast_system_version_number and forecast_method_number.
<br />
<br />4) for model data use the variable with the standard_name 'institution'
<br />
to indicate the institution who developed the forecast system (this may
<br />
be different from the original model developers - which is in source
<br />
(either implied or explicit).  It may also be different to the place
<br />
where the data was created or is archived.  This could be represented by
<br />
the global attribute 'institution' in a multi-model file.  (though I
<br />
think this is still to be fully resolved)
<br />
<br />5) There is still information in Paco's original posting that isn't
<br />
covered.  The explicitly scientific includes things like 'experiment_id'
<br />
and some indicator of 'initial_conditions'.  There are also bits of more
<br />
administration type information such as 'archive_time'.  Though we
<br />
haven't talked about this admin type info as much.
<br />
<br />6) 'experiment_id' could be made a global attribute and standard_name.
<br />
It is used to indicate something like the intent of the experiment.  In
<br />
a climate change context this would be something like the forcing
<br />
scenario (SRES A1B). (this forms part of the 'title' in CMOR - but its
<br />
useful to  separate this off).
<br />
<br />7) 'initial_condition' (or something like) could be made a global
<br />
attribute and a standard_name.  There is potential confusion here -
<br />
which I hadn't picked until now - in that CMOR uses 'realization' to
<br />
indicate initial condition, but CF uses 'realization' in a more general
<br />
sense (which could be initial condition, model ensemble, forcing
<br />
ensemble, or grand ensemble based on any combination of these...).  I
<br />
don't think we agreed what the content of this name should be.  Either a
<br />
simple numerical indicator, or a reference to the model start dump data
<br />
set.
<br />
<br />I hope that is a fair summary.  Any comments welcome.  E-mail history
<br />
attached.
<br />
<br />Jamie
<br />
<br />(does this start to feel a bit namespacey - we're saying if you are in
<br />
the model 'namespace' then the meaning of source, etc. is this.  Outside
<br />
of the model 'namespace' it means something a bit different?)
<br />
<br />------------------------------------------------------------------------
<br />
Offlist, from Jamie on October 24 (Email 1)
<br />
<br />Hello Paco,
<br />
<br />sorry to have sat on this a while.  This seemed quite a long detailed e-
<br />
mail so have posted to individuals who I think may be interested rather
<br />
than the whole list.
<br />
<br />The reason I suggested 'realization' as a standard name rather than
<br />
'ensemble_member' is that not all forecasts of this type come from model
<br />
ensembles.  (e.g. [sorry to blow my own trumpet/tuba] Stott and
<br />
Kettleborough, Nature 2002, 416, 723-726).  Yet you can imagine these
<br />
forecasts being processed in very similar ways to model ensembles to
<br />
produce say probability density functions of forecast variables.
<br />
<br />I think you are suggesting new meta data tags which would be used on top
<br />
of the 'realization', 'realization weight' standard_name and
<br />
standard_name qualifiers?  So you want to do something like:
<br />
<br />dimensions: 
<br />
&nbsp;&nbsp;lat = 18 ;
<br />
&nbsp;&nbsp;lon = 36 ;
<br />
&nbsp;&nbsp;time = 10 ;
<br />
&nbsp;&nbsp;realization = 100 ; 
<br />
&nbsp;&nbsp;strlen = 80 ;
<br />
variables: 
<br />
&nbsp;&nbsp;float temp(realization,time,lat,lon) ; // each sample is the result
<br />
from one realization
<br />
&nbsp;&nbsp;&nbsp;&nbsp;temp:long_name = &quot;Temperature at 1.5m&quot; ;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;temp:standard_name = &quot;air_temperature&quot; ;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;temp:ancillary_variables = &quot;weights&quot; ; 
<br />
&nbsp;&nbsp;float weights(realization) ;  // the weight applied to each
<br />
realization
<br />
&nbsp;&nbsp;&nbsp;&nbsp;weights:long_name = &quot;likelihood weights for 1.5m air temperature&quot; ;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;weights:standard_name = &quot;air_temperature realization_weights&quot; ;
<br />
&nbsp;&nbsp;char exptid(realization,strlen) ;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exptid:standard_name = &quot;experiment_identifier&quot; ; 
<br />
&nbsp;&nbsp;char oc(realization,strlen) ; 
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;oc:standard_name = &quot;originating_centre&quot; ; // etc.
<br />
<br />(of course the user does not have to use the suggested weights - they
<br />
can use their own based on exptid, oc, and your other suggested tags)
<br />
<br />I think there is a question of whether your tags are the most
<br />
appropriate ones (I'm not saying they aren't - I just think its worth
<br />
raising) - for instance I could create a single NetCDF data set from the
<br />
IPCC AR4 archive based on all the models e.g. monthly mean surface
<br />
temperature from all the models, for all future forcing scenarios (has
<br />
this been done?).  In that case I think you could populate your meta
<br />
data arrays with parts of the CMOR single file global headers (as
<br />
mentioned elsewhere)
<br />
<br />Specifically:
<br />
* experiment_identifier represents the CMOR experiment_id that goes into
<br />
the single model title attribute.
<br />
* originating_centre represents the CMOR institution
<br />
forecast_system_version_number represents something like the CMOR source
<br />
string
<br />
* forecast_method_number - I don't think this has an equivalent in
<br />
CMOR/IPCC, but it could in a perturbed physics forecast (e.g
<br />
climateprediction.net)
<br />
* ensemble_member_number represents CMOR realization
<br />
<br />This seems to suggest we should rethink the names to reflect the
<br />
parallel use?  For instance should we have some sort of
<br />
policy/convention for converting global attributes from single model
<br />
files into standard_names for their realisation/ensemble counter parts?
<br />
e.g. title could then replace your 'experiment_identifier' and have the
<br />
standard_name 'realization_title', similarly for source -&gt;
<br />
'realization_source' etc.?  (though this starts to look funny for CMOR's
<br />
realization which represent initial conditions).
<br />
<br />I think you would also want to adopt some conventions as to the content
<br />
- though these could be 'project' specific (e.g. operational forecasts,
<br />
IPCC AR4).  I think you really want to enforce consistency within a
<br />
project though - you suggest you may have different centres using
<br />
different names for the experiment_identifier (or realization_title)
<br />
even though these really are the same experiment - this is a bad thing.
<br />
Arguably in the case of initial condition ensembles you might want to
<br />
introduce a label to the URL of the dataset that is the initial
<br />
conditions (if these are publishable).  e.g.
<br />
realization_initial_condition could be a string with contents
<br />
identifying the actual initial condition data sets.  (though this sort
<br />
of introduces a level of indirection into CF which until now hasn't
<br />
really be done).
<br />
<br />Of course another way to side step all this is to have your own
<br />
'operational' convention for the content of a variable with
<br />
standard_name='realization'.
<br />
<br />e.g.
<br />
<br />dim:
<br />
&nbsp;&nbsp;ensemble=10
<br />
&nbsp;&nbsp;strlen=80
<br />
var:
<br />
&nbsp;&nbsp;ensemble(ensemble,strlen):
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ensemble:standard_name=&quot;realization&quot; ;
<br />
<br />ensemble=['id:SRES A1B, model:HadCM3, source:Hadley Centre',
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'id:SRES B2, model:HadCM3, source:Hadley Centre',
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'id:SRES A1B, model:HadGEM1, source:Hadley Centre',
<br />
&nbsp;...]
<br />
&nbsp;
<br />
Though I'm not sure I really like this method - it seems to make more
<br />
sense to standardise (at least on a project by project basis)  real
<br />
attributes, rather than 'sub attributes'.
<br />
&nbsp;
<br />
I don't think I have covered everything from your posting, nor have I
<br />
said too much that is new - but I've run out of steam for now (sorry).
<br />
Dealing with perturbed physics ensembles I think gets really tricky -
<br />
especially to do in a close to self describing way.
<br />
&nbsp;&nbsp;
<br />
Jamie
<br />
<br />ps at discovery level we had a proposal for dealing with this kind of
<br />
model data - it was always hard to understand the best way to represent
<br />
model ensembles.  <a href="http://proj.badc.rl.ac.uk/ndg/wiki/NumSim">http://proj.badc.rl.ac.uk/ndg/wiki/NumSim</a> if you want
<br />
the gory details.
<br />
<br />----------------------------------------------------------------------------
<br />
Jonathan 24th of October (Email 2)
<br />
<br /><br />Dear Jamie
<br />
<br />Thanks for your email to Paco - good points. I think if we standardise names
<br />
for &quot;discovery&quot; metadata this ought to be done with consideration by people
<br />
who have thought about this. Alternatively Paco could standardise the content
<br />
of a single standard name such as realization_name. Why not send your email to
<br />
the CF list? Although it is detailed, there are others who might comment -
<br />
Bryan, for instance.
<br />
<br />Best wishes
<br />
<br />Jonathan
<br />
<br />----------------------------------------------------------------------------
<br />
Paco 24th of October (Email 3)
<br />
<br />Dear Jamie,
<br />
<br />Thanks a lot for your detailed message.
<br />
<br />I agree with you that ensemble_member is not the solution to cope with 
<br />
forecasts formulated with different methods: dynamical models or 
<br />
empirical/statistical systems. That is precisely the reason I proposed 
<br />
the new variables, to cater for all these options.
<br />
<br />As you explain, realization and realization_weight offer a good start 
<br />
point. The new variables could be used, as you suggest, on top of them.
<br />
<br />The link to the CMOR global attributes is very interesting, as it points 
<br />
out at the need to bring together the climate change and weather and 
<br />
climate forecasting communities. I understand from your message that 
<br />
these attributes would have to become variables in a multi-forecast 
<br />
system NetCDF file.
<br />
<br />Concerning your proposed standard names:
<br />
- &quot;experiment_identifier represents the CMOR experiment_id that goes 
<br />
into the single model title attribute&quot;: Let's take experiment_id
<br />
- &quot;originating_centre represents the CMOR institution&quot;: This is a bit 
<br />
trickier. Operational systems (not only data generated in a project) 
<br />
need to distinguish between the data generated by an institution but 
<br />
distributed by another. An operational multi-model such as TIGGE would 
<br />
be an example, although a clearer one is offered by the operational 
<br />
European seasonal multi-model: while the Met Office is the originating 
<br />
centre of the GloSea/HadCM3 ensemble forecasts, ECMWF is responsible for 
<br />
its dissemination as part of the multi-model system. In this case, 
<br />
originating_centre=Met Office, while original_distributor=ECMWF.
<br />
- &quot;forecast_system_version_number represents something like the CMOR 
<br />
source string&quot;: I don't understand this one. Could you explain a bit 
<br />
more in detail? Furthermore, it seems that this variable shouldn't be a 
<br />
number, but a string detailing the version.
<br />
- &quot;forecast_method_number - I don't think this has an equivalent in 
<br />
CMOR/IPCC, but it could in a perturbed physics forecast (e.g 
<br />
climateprediction.net)&quot;: This is precisely the context in which we 
<br />
devised this variable. The Met Office Decadal Prediction System 
<br />
(DePreSys) is currently being developed to formulate seasonal and 
<br />
interannual forecasts using the perturbed-physics approach and requires 
<br />
this information. The same applies to multi-physics systems.
<br />
- &quot;ensemble_member_number represents CMOR realization&quot;: Fine by me.
<br />
<br />Although the idea of converting some of the already existing global 
<br />
attributes for single model files into variables for multi-forecast 
<br />
systems is great and will simplify life for the users, I'm afraid I find 
<br />
some of the translations you propose difficult to use in an operational 
<br />
forecasting context. For instance, &quot;realization_title&quot; would not have 
<br />
any meaning for a forecaster, as many forecasts are carried out as 
<br />
different sets of parallel experiments for which a title does not exist 
<br />
as the changes might be due to the removal of a satellite channel or the 
<br />
addition of certain flight data. The conversion of names would have to 
<br />
cater for the different needs of different modelling communities, and 
<br />
still having meaningful names.
<br />
<br /><em class="quotelev1"> &gt; I think you would also want to adopt some conventions as to thecontent
</em><br />
<em class="quotelev1"> &gt; - though these could be 'project' specific (e.g. operationalforecasts,
</em><br />
<em class="quotelev1"> &gt; IPCC AR4).  I think you really want to enforce consistency within a
</em><br />
<em class="quotelev1"> &gt; project though - you suggest you may have different centres using
</em><br />
<em class="quotelev1"> &gt; different names for the experiment_identifier (or realization_title)
</em><br />
<em class="quotelev1"> &gt; even though these really are the same experiment - this is a badthing.
</em><br />
<em class="quotelev1"> &gt; Arguably in the case of initial condition ensembles you might want to
</em><br />
<em class="quotelev1"> &gt; introduce a label to the URL of the dataset that is the initial
</em><br />
<em class="quotelev1"> &gt; conditions (if these are publishable).  e.g.
</em><br />
<em class="quotelev1"> &gt; realization_initial_condition could be a string with contents
</em><br />
<em class="quotelev1"> &gt; identifying the actual initial condition data sets.  (though this sort
</em><br />
<em class="quotelev1"> &gt; of introduces a level of indirection into CF which until now hasn't
</em><br />
<em class="quotelev1"> &gt; really be done).
</em><br />
The use of project specific conventions does not seem a good idea to me. 
<br />
Conventions for writing NetCDF files of operational forecasts (which 
<br />
should follow a quite stringent set of rules to allow operational use) 
<br />
do not exist. It might be a good time to start creating them. I don't 
<br />
think there is a reason for having different sets of conventions for 
<br />
IPCC or operational multi-forecast system files, as you illustrated with 
<br />
the use of the CMOR names.
<br />
<br />As for the use of different names for the experiment_identifier by 
<br />
different originating_centres included in the same multi-forecast system 
<br />
file, this obeys to the fact that each centre is not creating the 
<br />
forecasts with the same experiment: the way to produce the initial 
<br />
conditions is different, one centre might cycle the forecast model more 
<br />
frequently than another, etc. Again, operational constrains.
<br />
<br />Concerning the use of a URL which points at the initial conditions used, 
<br />
although desirable, it is rather difficult to implement. Imagine the 
<br />
difficulty to identify the initial conditions in an operational 
<br />
medium-range multi-model forecast system producing forecasts every 12 
<br />
hours from initial conditions created from millions of observations. In 
<br />
my opinion, using realization to identify the number of the ensemble 
<br />
member would be already helpful.
<br />
<br />It's obviously difficult to sort out the problem of coding ensembles of 
<br />
simulations from multiple systems (that's maybe why it hasn't been done 
<br />
before). Unless a general solution, instead of patches to satisfy the 
<br />
requirements by some projects, is available, I'm afraid the operational 
<br />
forecast community will hardly be on board.
<br />
<br />Best regards,
<br />
Paco
<br />
<br />----------------------------------------------------------------------------
<br />
Jonathan (24th of October, Email 4)
<br />
<br />Dear Paco
<br />
<br />Are the definitions of these global attributes close enough to a couple of
<br />
yours that we could (a) define them a bit more closely and (b) reuse them
<br />
as standard names:
<br />
<br />institution
<br />
&nbsp;&nbsp;&nbsp;&nbsp;Specifies where the original data was produced.
<br />
source
<br />
&nbsp;&nbsp;&nbsp;&nbsp;The method of production of the original data. If it was model-generated, 
<br />
source should name the model and its version, as specifically as could be useful. 
<br />
If it is observational, source should characterize it 
<br />
(e.g., &quot;surface observation&quot; or &quot;radiosonde&quot;).
<br />
<br />Cheers
<br />
<br />Jonathan
<br />
<br />----------------------------------------------------------------------------
<br />
Paco (24 October, Email 5)
<br />
<br />Hi Jonathan,
<br />
<br />As I mentioned in my previous message to Jamie, the use of a variable 
<br />
similar to &quot;institution&quot; in a multi-forecast system prediction may not 
<br />
be enough to discriminate the different situations that could happen. 
<br />
Let's imagine a forecast produced with the dynamical model x at its own 
<br />
institution and at institution y. Those two forecasts, even if valid at 
<br />
the same verification time, might not be the same, so that we need 
<br />
another variable to indicate where the data are distributed from. 
<br />
Therefore, the definition of &quot;institution&quot; below might not be precise 
<br />
enough. This situation is already happening and will be more frequent in 
<br />
the future as prediction models developed by one institution are run at 
<br />
a different one.
<br />
<br />As for &quot;source&quot;, it could cater for the variables I called 
<br />
&quot;forecast_system_version_number&quot; and for &quot;forecast_method_number&quot;, if 
<br />
both have to be included in the same string. I suppose that the model 
<br />
description needs to be quite detailed, which will require long strings 
<br />
for the source variable.
<br />
<br />Cheers,
<br />
Paco
<br />
----------------------------------------------------------------------------
<br />
Jonathan (25 October, Email 6)
<br />
<br />Dear Paco
<br />
<br /><em class="quotelev1">&gt; the use of a variable 
</em><br />
<em class="quotelev1">&gt; similar to &quot;institution&quot; in a multi-forecast system prediction may not 
</em><br />
<em class="quotelev1">&gt; be enough to discriminate the different situations that could happen. 
</em><br />
<em class="quotelev1">&gt; Let's imagine a forecast produced with the dynamical model x at its own 
</em><br />
<em class="quotelev1">&gt; institution and at institution y. Those two forecasts, even if valid at 
</em><br />
<em class="quotelev1">&gt; the same verification time, might not be the same, so that we need 
</em><br />
<em class="quotelev1">&gt; another variable to indicate where the data are distributed from. 
</em><br />
<em class="quotelev1">&gt; Therefore, the definition of &quot;institution&quot; below might not be precise 
</em><br />
<em class="quotelev1">&gt; enough. This situation is already happening and will be more frequent in 
</em><br />
<em class="quotelev1">&gt; the future as prediction models developed by one institution are run at 
</em><br />
<em class="quotelev1">&gt; a different one.
</em><br />
<br />It seems to me that &quot;institution&quot; is the correct description of the place
<br />
which produces the data, precisely like the global attribute. The indication
<br />
that it was done with model x doesn't seem to me to be part of the description
<br />
of the institution, but part of the description of the forecast system used.
<br />
<br /><em class="quotelev1">&gt; As for &quot;source&quot;, it could cater for the variables I called 
</em><br />
<em class="quotelev1">&gt; &quot;forecast_system_version_number&quot; and for &quot;forecast_method_number&quot;, if 
</em><br />
<em class="quotelev1">&gt; both have to be included in the same string. I suppose that the model 
</em><br />
<em class="quotelev1">&gt; description needs to be quite detailed, which will require long strings 
</em><br />
<em class="quotelev1">&gt; for the source variable.
</em><br />
<br />As suggested by the definition of the source attribute, this could name the
<br />
model e.g. GloSea (your forecast_system_version_number, but strings give
<br />
self-describing info, unlike numbers) and its variant e.g. in a perturbed
<br />
parameter ensemble, or if the model has subversions (your
<br />
forecast_method_number). It could also include the name of the centre which
<br />
produced the model e.g. &quot;Met Office GloSea&quot; or &quot;NCAR CCSM 3.0&quot;. I would guess
<br />
that in general it is sufficient to inpsect a long string. Possibly if you had
<br />
to group the members of a large perturbed physics ensemble together, separate
<br />
from other models, it would be useful to have a separate identifier for them
<br />
e.g. model_perturbation_id.
<br />
<br />That leaves realization, for members of an ensemble using the same model but
<br />
different input data, and experiment_id, for describing the intent of the
<br />
experiment. This would have been a good place to store scenario information
<br />
for IPCC experiments, for example. What do you think, Jamie?
<br />
<br />I would propose that if we allow realization and experiment_id as global
<br />
attributes too, for symmetry. Do source and institution need to be defined
<br />
as standard names so they can be used for coordinates? They are already
<br />
permitted as attributes of data variables.
<br />
<br />Cheers
<br />
<br />Jonathan
<br />
----------------------------------------------------------------------------
<br />
Jamie (25 October, Email 7)
<br />
<br />Hello Paco, Jonathan,
<br />
<br />there is a lot here isn't there?  I guess I made a bad judgement taking
<br />
this off the list.  Is the best way to get this back on the list to send
<br />
a summary mail - or just forward all the mails in this discussion to the
<br />
list?
<br />
<br />What do we need to take this forward?
<br />
<br />1) Agree a standard way to take single model file global attributes into
<br />
multi-model 'pseudo-coordinate' variables.  (I think this then becomes
<br />
more than discovery meta data - I think it becomes usage meta data - you
<br />
may want to slice your ensemble on initial conditions, or scenario or
<br />
whatever).  Jonathan suggests simply making the relevant global
<br />
attributes standard_names as well.  I think this is a good solution.
<br />
<br />2) Agree whether title, source, institution are the appropriate global
<br />
attributes to convert to pseudo-coordinate variables.  I think Paco is
<br />
concerned that these terms are not what operational forecasters expect
<br />
to see, and so using them may isolate this community from CF.  I think
<br />
we all agree that we should try and accommodate ensemble forecasts on
<br />
all timescales in the same way.
<br />
<br />3) Agree appropriate content for these attributes/pseudo coordinates for
<br />
model data.
<br />
<br />I think for 2/3 we have
<br />
<br />source - the model and version that produced this data (e.g. HadCM3).
<br />
This may include info on perturbed physics (which may be a long list of
<br />
perturbed parameter values?? e.g. 'HadCM3 but DTICE=0; RHCRIT=
<br />
(0.9,0.9...)', or it may be a reference to a doc defining that perturbed
<br />
model version)
<br />
<br />institute - the originating centre ('Met Office')  [and it would be
<br />
possible to have an institute pseudo-coordinate to represent originating
<br />
centre, and a global attribute institute to represent Paco's
<br />
dissemination/archive centre]
<br />
<br />title - I'm less sure on this one, and we may have some backwards
<br />
compatibility problems with CMOR.  In CMOR title is used to represent
<br />
the experiment_id (or forcing scenario) and other things. Yet we think
<br />
this might be worthy of splitting out into another attribute.  Paco is
<br />
also uncomfortable with title.
<br />
<br />4) Understand what is left over for describing model ensembles
<br />
(experiment_id, realization*/initial_condition).  Suggest these are
<br />
included as additional global attributes and pseudo-coordinates, and
<br />
agree their content.  I think Paco had a whole list here (archive time,
<br />
etc) - some of which we haven't really talked about.
<br />
<br />Does that sound reasonable?  If so I am happy to try and summarise to
<br />
the list.
<br />
<br />Jamie 
<br />
<br />(*I think this use of realization in this context is different from the
<br />
current use of realization in CF - that we have just added - so we'll
<br />
need a different name/label.)
<br />
<br />(When suggesting having pointers to data sets for initial conditions I
<br />
meant simply the assimilation/model start conditions - Paco is right it
<br />
would be a nightmare to keep track of the all obs that go into the
<br />
assimilation.  That said not all assimilation/model start conditions may
<br />
be publically available so this may not work?  I have reservations about
<br />
the usefulness of simply a numerical id to indicate the initial
<br />
condition ensemble number.  I'd rather try and give it some more
<br />
meaningful content).
<br />
<br />----------------------------------------------------------------------------
<br />
Jonathan 25th October, Email 8
<br />
<br />Dear Jamie
<br />
<br />Thank you.  That is a good summary. I don't like title either, by the way.
<br />
You could post it to the email list, I think, perhaps with the earlier
<br />
ones appended for reference!
<br />
<br />Cheers
<br />
<br />Jonathan
<br />
<br />----------------------------------------------------------------------------
<br />
Paco 25th of October, Email 9
<br />
<br />Dear Jonathan and Jamie,
<br />
<br />I agree that allowing the relevant global attributes to be 
<br />
standard_names as well might help a lot.
<br />
<br />As for the use of title, source and institution, see below.
<br />
<br /><em class="quotelev2">&gt;&gt; the use of a variable 
</em><br />
<em class="quotelev2">&gt;&gt; similar to &quot;institution&quot; in a multi-forecast system prediction may not 
</em><br />
<em class="quotelev2">&gt;&gt; be enough to discriminate the different situations that could happen. 
</em><br />
<em class="quotelev2">&gt;&gt; Let's imagine a forecast produced with the dynamical model x at its own 
</em><br />
<em class="quotelev2">&gt;&gt; institution and at institution y. Those two forecasts, even if valid at 
</em><br />
<em class="quotelev2">&gt;&gt; the same verification time, might not be the same, so that we need 
</em><br />
<em class="quotelev2">&gt;&gt; another variable to indicate where the data are distributed from. 
</em><br />
<em class="quotelev2">&gt;&gt; Therefore, the definition of &quot;institution&quot; below might not be precise 
</em><br />
<em class="quotelev2">&gt;&gt; enough. This situation is already happening and will be more frequent in 
</em><br />
<em class="quotelev2">&gt;&gt; the future as prediction models developed by one institution are run at 
</em><br />
<em class="quotelev2">&gt;&gt; a different one.
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; It seems to me that &quot;institution&quot; is the correct description of the place
</em><br />
<em class="quotelev1">&gt; which produces the data, precisely like the global attribute. The indication
</em><br />
<em class="quotelev1">&gt; that it was done with model x doesn't seem to me to be part of the description
</em><br />
<em class="quotelev1">&gt; of the institution, but part of the description of the forecast system used.
</em><br />
<br />The problem I see with this use of &quot;institution&quot; or &quot;institute&quot; is how 
<br />
to distinguish the forecasts run by centre x at institution y. While the 
<br />
model (system and version) could be specified in &quot;source&quot;, the 
<br />
institution x is not the same as institution y. This sort of situation 
<br />
happens in the context of the multi-model system developed by APCC 
<br />
(<a href="http://www2.apcc21.net/index.php">http://www2.apcc21.net/index.php</a>). KMA (Korea) produces seasonal 
<br />
forecasts with the NCAR (USA) model at APCC where the data are archived. 
<br />
In this case, while &quot;institution&quot; could take the value KMA and the 
<br />
information about the version of the NCAR model could go into &quot;source&quot;, 
<br />
we still need to indicate that the data have been produced, 
<br />
postprocessed and stored by APCC, which is the centre responsible. A 
<br />
variable such as &quot;forecast_producer&quot; to indicate the centre where the 
<br />
model was run could clarify the situation. In a global seasonal 
<br />
multi-model context, the same NetCDF file might contain other forecasts 
<br />
valid at the same verification time produced by other centres at, for 
<br />
instance, ECMWF, which would prevent the variable &quot;forecast_producer&quot; to 
<br />
be a global attribute. This is the sort of complex case that the working 
<br />
group on seasonal-to-interannual prediction (WGSIP) is trying to 
<br />
consider and why we initially proposed the variable &quot;original_distributor&quot;.
<br />
<br /><em class="quotelev2">&gt;&gt; As for &quot;source&quot;, it could cater for the variables I called 
</em><br />
<em class="quotelev2">&gt;&gt; &quot;forecast_system_version_number&quot; and for &quot;forecast_method_number&quot;, if 
</em><br />
<em class="quotelev2">&gt;&gt; both have to be included in the same string. I suppose that the model 
</em><br />
<em class="quotelev2">&gt;&gt; description needs to be quite detailed, which will require long strings 
</em><br />
<em class="quotelev2">&gt;&gt; for the source variable.
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; As suggested by the definition of the source attribute, this could name the
</em><br />
<em class="quotelev1">&gt; model e.g. GloSea (your forecast_system_version_number, but strings give
</em><br />
<em class="quotelev1">&gt; self-describing info, unlike numbers) and its variant e.g. in a perturbed
</em><br />
<em class="quotelev1">&gt; parameter ensemble, or if the model has subversions (your
</em><br />
<em class="quotelev1">&gt; forecast_method_number). It could also include the name of the centre which
</em><br />
<em class="quotelev1">&gt; produced the model e.g. &quot;Met Office GloSea&quot; or &quot;NCAR CCSM 3.0&quot;. I would guess
</em><br />
<em class="quotelev1">&gt; that in general it is sufficient to inpsect a long string. Possibly if you had
</em><br />
<em class="quotelev1">&gt; to group the members of a large perturbed physics ensemble together, separate
</em><br />
<em class="quotelev1">&gt; from other models, it would be useful to have a separate identifier for them
</em><br />
<em class="quotelev1">&gt; e.g. model_perturbation_id.
</em><br />
<br />This use of &quot;source&quot; and the definition given by Jamie might do the job, 
<br />
except for the inclusion of the centre. There is an increasing number of 
<br />
cases where a model developed by a centre is run by another one. I 
<br />
believe this information should be kept separate (see comments above 
<br />
concerning &quot;institution&quot;).
<br />
<br />I don't see the need to have a separate identifier for the model 
<br />
perturbation. That would be something similar to the variable 
<br />
&quot;forecast_system_method&quot; that we agreed to include in source. As I 
<br />
understand it, source might also contain URL pointers.
<br />
<br /><em class="quotelev1">&gt; That leaves realization, for members of an ensemble using the same model but
</em><br />
<em class="quotelev1">&gt; different input data, and experiment_id, for describing the intent of the
</em><br />
<em class="quotelev1">&gt; experiment. This would have been a good place to store scenario information
</em><br />
<em class="quotelev1">&gt; for IPCC experiments, for example. What do you think, Jamie?
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; I would propose that if we allow realization and experiment_id as global
</em><br />
<em class="quotelev1">&gt; attributes too, for symmetry. Do source and institution need to be defined
</em><br />
<em class="quotelev1">&gt; as standard names so they can be used for coordinates? They are already
</em><br />
<em class="quotelev1">&gt; permitted as attributes of data variables.
</em><br />
<br />Does any of you have a guess of what the dimensions of &quot;realization&quot; and 
<br />
&quot;experiment_id&quot; would be for a multi-model ensemble forecast built up 
<br />
with two models with 5 and 11 ensemble members?
<br />
<br />If &quot;realization&quot; is not to be used to identify ensemble members of an 
<br />
initial condition ensemble forecasts, then I suggest we reconsider the 
<br />
variable &quot;ensemble_member_number&quot;.
<br />
<br />I'm still reluctant to give a use to title in a forecasting context. 
<br />
Honestly, I don't see what concept it could correspond to.
<br />
<br />To end up with this long message, I feel sorry that there are not more 
<br />
members of the medium-range/seasonal operational forecast community 
<br />
following the discussion. I wouldn't like to miss any of the relevant 
<br />
issues.
<br />
<br />Cheers,
<br />
Paco
<br />
----------------------------------------------------------------------------
<br />
Paco 25th of October, Email 10
<br />
<br />Yes, I'm happy with this way forward (sending everything to the list) 
<br />
and with the closer link between the needs of coding data of different 
<br />
time scales and operational uses.
<br />
<br />Thanks a lot for the comments.
<br />
<br />Cheers,
<br />
Paco
<br />
----------------------------------------------------------------------------
<br />
Jonathan 25th of October, Email 11
<br />
<br />Dear Paco
<br />
<br /><em class="quotelev1">&gt; The problem I see with this use of &quot;institution&quot; or &quot;institute&quot; is how 
</em><br />
<em class="quotelev1">&gt; to distinguish the forecasts run by centre x at institution y. While the 
</em><br />
<em class="quotelev1">&gt; model (system and version) could be specified in &quot;source&quot;, the 
</em><br />
<em class="quotelev1">&gt; institution x is not the same as institution y. This sort of situation 
</em><br />
<em class="quotelev1">&gt; happens in the context of the multi-model system developed by APCC 
</em><br />
<em class="quotelev1">&gt; (<a href="http://www2.apcc21.net/index.php">http://www2.apcc21.net/index.php</a>). KMA (Korea) produces seasonal 
</em><br />
<em class="quotelev1">&gt; forecasts with the NCAR (USA) model at APCC where the data are archived. 
</em><br />
<em class="quotelev1">&gt; In this case, while &quot;institution&quot; could take the value KMA and the 
</em><br />
<em class="quotelev1">&gt; information about the version of the NCAR model could go into &quot;source&quot;, 
</em><br />
<em class="quotelev1">&gt; we still need to indicate that the data have been produced, 
</em><br />
<em class="quotelev1">&gt; postprocessed and stored by APCC, which is the centre responsible.
</em><br />
<br />Ah. So there are *three* centres involved - not just x and y, but z as well.
<br />
But you say &quot;KMA produces&quot; and &quot;data have been produced ... by APCC&quot;. So I
<br />
am confused. Which of them has produced the data? These three roles are not
<br />
clear to me. I agree that NCAR belongs in the source.
<br />
<br />Between global attribute and coordinate variable, there is also the
<br />
possibility of data variable attribute. These attribute are already allowed
<br />
on data variables. It depends whether you &quot;feel&quot; they are coordinates or
<br />
attributes.
<br />
<br /><em class="quotelev1">&gt; To end up with this long message, I feel sorry that there are not more 
</em><br />
<em class="quotelev1">&gt; members of the medium-range/seasonal operational forecast community 
</em><br />
<em class="quotelev1">&gt; following the discussion. I wouldn't like to miss any of the relevant 
</em><br />
<em class="quotelev1">&gt; issues.
</em><br />
<br />Yes. We should get back into public view!
<br />
<br />Cheers
<br />
<br />Jonathan
<br />
----------------------------------------------------------------------------
<br />
Paco 25th of October, Email 12
<br />
<br />Dear Jonathan,
<br />
<br /><em class="quotelev2">&gt;&gt; The problem I see with this use of &quot;institution&quot; or &quot;institute&quot; is how 
</em><br />
<em class="quotelev2">&gt;&gt; to distinguish the forecasts run by centre x at institution y. While the 
</em><br />
<em class="quotelev2">&gt;&gt; model (system and version) could be specified in &quot;source&quot;, the 
</em><br />
<em class="quotelev2">&gt;&gt; institution x is not the same as institution y. This sort of situation 
</em><br />
<em class="quotelev2">&gt;&gt; happens in the context of the multi-model system developed by APCC 
</em><br />
<em class="quotelev2">&gt;&gt; (<a href="http://www2.apcc21.net/index.php">http://www2.apcc21.net/index.php</a>). KMA (Korea) produces seasonal 
</em><br />
<em class="quotelev2">&gt;&gt; forecasts with the NCAR (USA) model at APCC where the data are archived. 
</em><br />
<em class="quotelev2">&gt;&gt; In this case, while &quot;institution&quot; could take the value KMA and the 
</em><br />
<em class="quotelev2">&gt;&gt; information about the version of the NCAR model could go into &quot;source&quot;, 
</em><br />
<em class="quotelev2">&gt;&gt; we still need to indicate that the data have been produced, 
</em><br />
<em class="quotelev2">&gt;&gt; postprocessed and stored by APCC, which is the centre responsible.
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; Ah. So there are *three* centres involved - not just x and y, but z as well.
</em><br />
<em class="quotelev1">&gt; But you say &quot;KMA produces&quot; and &quot;data have been produced ... by APCC&quot;. So I
</em><br />
<em class="quotelev1">&gt; am confused. Which of them has produced the data? These three roles are not
</em><br />
<em class="quotelev1">&gt; clear to me. I agree that NCAR belongs in the source.
</em><br />
<br />Sorry for not being clear enough. There may be 3 centres involved: the 
<br />
centre developing the forecast system, the centre running the forecast 
<br />
and the centre where the forecast is run at. In my example, NCAR is the 
<br />
model developer (it goes into source), KMA is the institution that 
<br />
develops the forecast system (it modifies the model to convert it into a 
<br />
climate forecast model) and APCC is the institution where the forecasts 
<br />
are run and archived. Another example can be provided from the EUROSIP 
<br />
operational multi-model ensemble, wherein GloSea is the forecast system 
<br />
(source), Met Office is the forecast system developer (institution) and 
<br />
ECMWF is where the model is run at (forecast_producer).
<br />
<br /><em class="quotelev1">&gt; Between global attribute and coordinate variable, there is also the
</em><br />
<em class="quotelev1">&gt; possibility of data variable attribute. These attribute are already allowed
</em><br />
<em class="quotelev1">&gt; on data variables. It depends whether you &quot;feel&quot; they are coordinates or
</em><br />
<em class="quotelev1">&gt; attributes.
</em><br />
<br />Sorry, I miss the differences. I looked at the CF conventions 
<br />
documentation and couldn't find the data variable attribute definition. 
<br />
However, it is desirable that the variables we've been discussing are 
<br />
not global for this sort of files.
<br />
<br />Cheers,
<br />
Paco
<br />
----------------------------------------------------------------------------
<br />
Jonathan 25th of October, Email 13 of 13
<br />
<br />Just to clarify, and then silence until Jamie has summarised:
<br />
<br /><em class="quotelev1">&gt; I looked at the CF conventions 
</em><br />
<em class="quotelev1">&gt; documentation and couldn't find the data variable attribute definition. 
</em><br />
<br />In 2.6.2
<br />
<br />The NUG defines title and history to be global attributes. 
<br />
We wish to allow the newly defined attributes, i.e., institution, source,
<br />
&nbsp;references, and comment, to be either global or assigned to individual 
<br />
variables. When an attribute appears both globally and as a variable attribute, 
<br />
the variable's version has precedence.
<br />
<br />Jonathan
<br />
----------------------------------------------------------
<br />
<span id="received"><dfn>Received on</dfn> Thu Oct 26 2006 - 09:53:53 BST</span>
</div>
<!-- body="end" -->
<div class="foot">
<map id="navbarfoot" name="navbarfoot" title="Related messages">
<ul class="links">
<li><dfn>This message</dfn>: [ <a href="#start371">Message body</a> ]</li>
<!-- lnext="start" -->
<li><dfn>Next message</dfn>: <a href="./0372.html" title="Next message in the list">John Caron: "[CF-metadata] CF and multi-forecast system ensemble data"</a></li>
<li><dfn>Previous message</dfn>: <a href="./0370.html" title="Previous message in the list">Kettleborough, Jamie: "[CF-metadata] CF and multi-forecast system ensemble data"</a></li>
<li><dfn>In reply to</dfn>: <a href="./0370.html" title="Message to which this message replies">Kettleborough, Jamie: "[CF-metadata] CF and multi-forecast system ensemble data"</a></li>
<!-- lnextthread="start" -->
<li><dfn>Next in thread</dfn>: <a href="./0372.html" title="Next message in this discussion thread">John Caron: "[CF-metadata] CF and multi-forecast system ensemble data"</a></li>
<li><a name="replies" id="replies"></a>
<dfn>Reply</dfn>: <a href="./0372.html" title="Message sent in reply to this message">John Caron: "[CF-metadata] CF and multi-forecast system ensemble data"</a></li>
<!-- lreply="end" -->
</ul>
<ul class="links">
<li><a name="options3" id="options3"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="index.html#msg371" title="Contemporary messages by date">by date</a> ] [ <a href="thread.html#msg371" title="Contemporary discussion threads">by thread</a> ] [ <a href="subject.html#msg371" title="Contemporary messages by subject">by subject</a> ] [ <a href="author.html#msg371" title="Contemporary messages by author">by author</a> ] [ <a href="attachment.html" title="Contemporary messages by attachment">by messages with attachments</a> ]</li>
</ul>
</map>
</div>
<!-- trailer="footer" -->
<p><small><em>
This archive was generated by <a href="http://www.hypermail-project.org/">hypermail 2.3.0</a>
: Wed Jul 27 2022 - 12:56:49 BST
</em></small></p>
</body>
<p><a style="text-decoration:none" href="./0370.html"><img src="./red-arrow-left.jpg" width="50" alt="&lArr;"></a> <a style="text-decoration:none" href="./0372.html"><img src="./red-arrow-right.jpg" width="50" alt="&rArr;"></a></html>
