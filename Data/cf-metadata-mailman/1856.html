<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
<meta name="generator" content="hypermail 2.3.0, see http://www.hypermail-project.org/" />
<title>[CF-metadata] Storing multiple NWP model runs in a NetCDF - CF file [SEC=UNCLASSIFIED] from Timothy Hume on 2009-01-08 (cf-metadata-mailman)</title>
<meta name="Author" content="Timothy Hume (T.Hume)" />
<meta name="Subject" content="[CF-metadata] Storing multiple NWP model runs in a NetCDF - CF file [SEC=UNCLASSIFIED]" />
<meta name="Date" content="2009-01-08" />
<style type="text/css">
/*<![CDATA[*/
/* To be incorporated in the main stylesheet, don't code it in hypermail! */
body {color: black; background: #ffffff}
dfn {font-weight: bold;}
pre { background-color:inherit;}
.head { border-bottom:1px solid black;}
.foot { border-top:1px solid black;}
th {font-style:italic;}
table { margin-left:2em;}map ul {list-style:none;}
#mid { font-size:0.9em;}
#received { float:right;}
address { font-style:inherit ;}
/*]]>*/
.quotelev1 {color : #990099}
.quotelev2 {color : #ff7700}
.quotelev3 {color : #007799}
.quotelev4 {color : #95c500}
.period {font-weight: bold}
</style>
</head>
<body>
<div class="head">
<a style="text-decoration:none" href="./1855.html"><img src="./red-arrow-left.jpg" width="50" alt="&lArr;"></a> <a style="text-decoration:none" href="./1857.html"><img src="./red-arrow-right.jpg" width="50" alt="&rArr;"></a><h1>[CF-metadata] Storing multiple NWP model runs in a NetCDF - CF file [SEC=UNCLASSIFIED]</h1>
<!-- received="Wed Jan  7 17:19:33 2009" -->
<!-- isoreceived="20090107171933" -->
<!-- sent="Thu, 8 Jan 2009 11:19:33 +1100" -->
<!-- isosent="20090108001933" -->
<!-- name="Timothy Hume" -->
<!-- email="T.Hume" -->
<!-- subject="[CF-metadata] Storing multiple NWP model runs in a NetCDF - CF file [SEC=UNCLASSIFIED]" -->
<!-- id="A638730E91FBA941969A262738288BFD01EEEAD3_at_officeho2.bom.gov.au" -->
<!-- charset="US-ASCII" -->
<!-- inreplyto="496542BB.9000804_at_llnl.gov" -->
<!-- expires="-1" -->
<map id="navbar" name="navbar">
<ul class="links">
<li>
<dfn>This message</dfn>:
[ <a href="#start1856" name="options1" id="options1" tabindex="1">Message body</a> ]
 [ More options (<a href="#options2">top</a>, <a href="#options3">bottom</a>) ]
</li>
<li>
<dfn>Related messages</dfn>:
<!-- unext="start" -->
[ <a href="./1857.html" accesskey="d" title="Karl Taylor: &quot;[CF-metadata] Storing multiple NWP model runs in a NetCDF - CF file [SEC=UNCLASSIFIED]&quot;">Next message</a> ]
[ <a href="./1855.html" title="Karl Taylor: &quot;[CF-metadata] Storing multiple NWP model runs in a NetCDF - CF file	[SEC=UNCLASSIFIED]&quot;">Previous message</a> ]
[ <a href="./1855.html" title="Karl Taylor: &quot;[CF-metadata] Storing multiple NWP model runs in a NetCDF - CF file	[SEC=UNCLASSIFIED]&quot;">In reply to</a> ]
<!-- unextthread="start" -->
[ <a href="./1857.html" accesskey="t" title="Karl Taylor: &quot;[CF-metadata] Storing multiple NWP model runs in a NetCDF - CF file [SEC=UNCLASSIFIED]&quot;">Next in thread</a> ]
 [ <a href="#replies">Replies</a> ]
<!-- ureply="end" -->
</li>
</ul>
</map>
<ul class="links">
<li><a name="options2" id="options2"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="index.html#msg1856" title="Contemporary messages by date">by date</a> ] [ <a href="thread.html#msg1856" title="Contemporary discussion threads">by thread</a> ] [ <a href="subject.html#msg1856" title="Contemporary messages by subject">by subject</a> ] [ <a href="author.html#msg1856" title="Contemporary messages by author">by author</a> ] [ <a href="attachment.html" title="Contemporary messages by attachment">by messages with attachments</a> ]</li>
</ul>
</div>
<!-- body="start" -->
<div class="mail">
<address class="headers">
<span id="from">
<dfn>From</dfn>: Timothy Hume &lt;<a href="mailto:T.Hume?Subject=Re%3A%20%5BCF-metadata%5D%20Storing%20multiple%20NWP%20model%20runs%20in%20a%20NetCDF%20-%20CF%20file%20%5BSEC%3DUNCLASSIFIED%5D">T.Hume</a>&gt;
</span><br />
<span id="date"><dfn>Date</dfn>: Thu, 8 Jan 2009 11:19:33 +1100</span><br />
</address>
<br />
Hi Karl,
<br />
<br />I have just checked one of my files, and get two errors:
<br />
<br />The first error is:
<br />
<br />------------------
<br />
Checking variable: forecast
<br />
------------------
<br />
ERROR (4.4): Invalid units and/or reference time
<br />
<br />This is the error I am aware of. My file should become compliant if I switch the &quot;T&quot; axis to basetime.
<br />
<br /><br />The second error is:
<br />
<br />------------------
<br />
Checking variable: level
<br />
------------------
<br />
ERROR (4): Axis attribute is not allowed for auxillary coordinate variables.
<br />
<br />I was unaware that the axis attribute should not be used for scalar coordinate variables (as describe in Section 5.7). Is this intended? In any case, I don't think this small error should cause the NetCDF viewers I tried (IDV and Joe Sirott's web application) to not work.
<br />
<br />Cheers,
<br />
<br />Tim.
<br />
<br />-----Original Message-----
<br />
From: Karl Taylor [mailto:taylor13 at llnl.gov] 
<br />
Sent: Thursday, 8 January 2009 11:03
<br />
To: Timothy Hume
<br />
Cc: cf-metadata at cgd.ucar.edu
<br />
Subject: Re: [CF-metadata] Storing multiple NWP model runs in a NetCDF - CF file [SEC=UNCLASSIFIED]
<br />
<br />Hi Tim,
<br />
<br />Other than the axis attribute for time, I didn't see any issues.  You 
<br />
might run the CF compliance checker on the file 
<br />
(<a href="http://cf-pcmdi.llnl.gov/conformance">http://cf-pcmdi.llnl.gov/conformance</a>), but it might not run if the 
<br />
other utilities stumbled.  Maybe someone else has some ideas.
<br />
<br />cheers,
<br />
Karl
<br />
<br /><br />Timothy Hume wrote:
<br />
<em class="quotelev1">&gt; Hi,
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; I am writing NetCDF files which hold surface fields (2m temperature etc) from multiple NWP model runs (all the runs from the same model for the last month or so). The files are for operational use, so I want them to strictly follow the CF conventions. I am running into a couple of problems, where the conventions don't seem to be ideally suited for storing more than a single model run.
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; Here is what I do:
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; I have four dimensions and associated coordinate variables:
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; basetime:	The base time for the model run (units: seconds since 1970-01-01 00:00:00.0 +0:00)
</em><br />
<em class="quotelev1">&gt; forecast:	The forecast lead time, relative to the basetime (units: hours)
</em><br />
<em class="quotelev1">&gt; latitude
</em><br />
<em class="quotelev1">&gt; longitude
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; There is no need for a vertical dimension, because I am using surface fields. Never-the-less I make use of a scalar vertical coordinate variable as described in Section 5.7 of the CF-1.3 metadata conventions document.
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; The use of two dimensions to store the time information (basetime and forecast) seems to be a natural way to store multiple NWP model runs, and is the standard way used in the very old NUWG conventions. As far as I can tell, what I am doing is supported by the CF conventions, provided the time axis is taken to be the basetime dimension. This is because Section 4.4 of the conventions specifies the units of the time coordinate must include a reference time. Obviously the units of the forecast coordinate cannot include a reference time, because the reference time varies, and is determined by the value of the basetime coordinate.
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; The difficulty I am encountering is that some applications which read NetCDF/CF files (such as the Unidata IDV and Joe Sirott's very nice web based NetCDF data viewer) seem to choke on my data. I suspect (but am not 100% certain in the case of the IDV) that the reason is because of the way I handle the time information in my files.
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; To illustrate in more detail what my files look like, I am attaching the CDL from an example file. The CDL is non-CF compliant, because I have specified the &quot;T&quot; axis (via the axis variable attribute) to be the forecast coordinate, and the forecast coordinate has invalid units (no reference time). I am planning on switching the &quot;T&quot; axis to the base time coordinate, which as far as I can determine should make the file CF compliant.
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; My question is: is there a better (or more standard) way of storing multiple NWP model runs in a single file than what I am doing? 
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; Cheers,
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; Tim Hume
</em><br />
<em class="quotelev1">&gt; Centre for Australian Weather and Climate Research
</em><br />
<em class="quotelev1">&gt; Australian Bureau of Meteorology
</em><br />
<em class="quotelev1">&gt; Melbourne
</em><br />
<em class="quotelev1">&gt; Australia
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; --- Example CDL follows ---
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; netcdf gasp_1p0deg_ocf_t2m_rtdb_opn {
</em><br />
<em class="quotelev1">&gt; dimensions:
</em><br />
<em class="quotelev1">&gt; 	forecast = 69 ;
</em><br />
<em class="quotelev1">&gt; 	basetime = UNLIMITED ; // (100 currently)
</em><br />
<em class="quotelev1">&gt; 	latitude = 96 ;
</em><br />
<em class="quotelev1">&gt; 	longitude = 121 ;
</em><br />
<em class="quotelev1">&gt; 	bounds = 2 ;
</em><br />
<em class="quotelev1">&gt; variables:
</em><br />
<em class="quotelev1">&gt; 	double forecast(forecast) ;
</em><br />
<em class="quotelev1">&gt; 		forecast:long_name = &quot;Time of model forecast, relative to the basetime&quot; ;
</em><br />
<em class="quotelev1">&gt; 		forecast:units = &quot;hours&quot; ;
</em><br />
<em class="quotelev1">&gt; 		forecast:standard_name = &quot;forecast_period&quot; ;
</em><br />
<em class="quotelev1">&gt; 		forecast:axis = &quot;T&quot; ;
</em><br />
<em class="quotelev1">&gt; 		forecast:bounds = &quot;forecast_bounds&quot; ;
</em><br />
<em class="quotelev1">&gt; 	double forecast_bounds(forecast, bounds) ;
</em><br />
<em class="quotelev1">&gt; 		forecast_bounds:long_name = &quot;forecast interval&quot; ;
</em><br />
<em class="quotelev1">&gt; 		forecast_bounds:units = &quot;hours&quot; ;
</em><br />
<em class="quotelev1">&gt; 	int basetime(basetime) ;
</em><br />
<em class="quotelev1">&gt; 		basetime:long_name = &quot;Model basetime&quot; ;
</em><br />
<em class="quotelev1">&gt; 		basetime:units = &quot;seconds since 1970-01-01 00:00:00.0 +0:00&quot; ;
</em><br />
<em class="quotelev1">&gt; 		basetime:calendar = &quot;gregorian&quot; ;
</em><br />
<em class="quotelev1">&gt; 		basetime:standard_name = &quot;forecast_reference_time&quot; ;
</em><br />
<em class="quotelev1">&gt; 	double latitude(latitude) ;
</em><br />
<em class="quotelev1">&gt; 		latitude:long_name = &quot;latitude&quot; ;
</em><br />
<em class="quotelev1">&gt; 		latitude:units = &quot;degrees_north&quot; ;
</em><br />
<em class="quotelev1">&gt; 		latitude:bounds = &quot;latitude_bounds&quot; ;
</em><br />
<em class="quotelev1">&gt; 		latitude:valid_min = -90. ;
</em><br />
<em class="quotelev1">&gt; 		latitude:valid_max = 90. ;
</em><br />
<em class="quotelev1">&gt; 		latitude:standard_name = &quot;latitude&quot; ;
</em><br />
<em class="quotelev1">&gt; 		latitude:axis = &quot;Y&quot; ;
</em><br />
<em class="quotelev1">&gt; 	double latitude_bounds(latitude, bounds) ;
</em><br />
<em class="quotelev1">&gt; 		latitude_bounds:long_name = &quot;grid cell latitude boundaries&quot; ;
</em><br />
<em class="quotelev1">&gt; 		latitude_bounds:units = &quot;degrees_north&quot; ;
</em><br />
<em class="quotelev1">&gt; 		latitude_bounds:valid_min = -90. ;
</em><br />
<em class="quotelev1">&gt; 		latitude_bounds:valid_max = 90. ;
</em><br />
<em class="quotelev1">&gt; 	double longitude(longitude) ;
</em><br />
<em class="quotelev1">&gt; 		longitude:long_name = &quot;longitude&quot; ;
</em><br />
<em class="quotelev1">&gt; 		longitude:units = &quot;degrees_east&quot; ;
</em><br />
<em class="quotelev1">&gt; 		longitude:bounds = &quot;longitude_bounds&quot; ;
</em><br />
<em class="quotelev1">&gt; 		longitude:valid_min = -360. ;
</em><br />
<em class="quotelev1">&gt; 		longitude:valid_max = 360. ;
</em><br />
<em class="quotelev1">&gt; 		longitude:standard_name = &quot;longitude&quot; ;
</em><br />
<em class="quotelev1">&gt; 		longitude:axis = &quot;X&quot; ;
</em><br />
<em class="quotelev1">&gt; 	double longitude_bounds(longitude, bounds) ;
</em><br />
<em class="quotelev1">&gt; 		longitude_bounds:long_name = &quot;grid cell longitude boundaries&quot; ;
</em><br />
<em class="quotelev1">&gt; 		longitude_bounds:units = &quot;degrees_east&quot; ;
</em><br />
<em class="quotelev1">&gt; 		longitude_bounds:valid_min = -360. ;
</em><br />
<em class="quotelev1">&gt; 		longitude_bounds:valid_max = 360. ;
</em><br />
<em class="quotelev1">&gt; 	float temperature_2m(basetime, forecast, latitude, longitude) ;
</em><br />
<em class="quotelev1">&gt; 		temperature_2m:long_name = &quot;Air temperature 2m above the surface&quot; ;
</em><br />
<em class="quotelev1">&gt; 		temperature_2m:units = &quot;K&quot; ;
</em><br />
<em class="quotelev1">&gt; 		temperature_2m:_FillValue = 9.96921e+36f ;
</em><br />
<em class="quotelev1">&gt; 		temperature_2m:missing_value = 9.96921e+36f ;
</em><br />
<em class="quotelev1">&gt; 		temperature_2m:valid_min = 180.f ;
</em><br />
<em class="quotelev1">&gt; 		temperature_2m:valid_max = 330.f ;
</em><br />
<em class="quotelev1">&gt; 		temperature_2m:standard_name = &quot;air_temperature&quot; ;
</em><br />
<em class="quotelev1">&gt; 		temperature_2m:cell_methods = &quot;lat: lon: mean (area weighted)&quot; ;
</em><br />
<em class="quotelev1">&gt; 		temperature_2m:coordinates = &quot;level&quot; ;
</em><br />
<em class="quotelev1">&gt; 	double level ;
</em><br />
<em class="quotelev1">&gt; 		level:long_name = &quot;Height above the surface&quot; ;
</em><br />
<em class="quotelev1">&gt; 		level:units = &quot;m&quot; ;
</em><br />
<em class="quotelev1">&gt; 		level:positive = &quot;up&quot; ;
</em><br />
<em class="quotelev1">&gt; 		level:standard_name = &quot;height&quot; ;
</em><br />
<em class="quotelev1">&gt; 		level:axis = &quot;Z&quot; ;
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; // global attributes:
</em><br />
<em class="quotelev1">&gt; 		:Conventions = &quot;CF-1.3&quot; ;
</em><br />
<em class="quotelev1">&gt; 		:history = &quot;File created by the Gridded OCF data ingest system&quot; ;
</em><br />
<em class="quotelev1">&gt; 		:institution = &quot;Australian Bureau of Meteorology&quot; ;
</em><br />
<em class="quotelev1">&gt; 		:source = &quot;model&quot; ;
</em><br />
<em class="quotelev1">&gt; 		:title = &quot;GASP forecasts of temperature_2m; resolution: 1.0 degree; source: rtdb&quot; ;
</em><br />
<em class="quotelev1">&gt; 		:topography = &quot;MSAS&quot; ;
</em><br />
<em class="quotelev1">&gt; }
</em><br />
<em class="quotelev1">&gt; _______________________________________________
</em><br />
<em class="quotelev1">&gt; CF-metadata mailing list
</em><br />
<em class="quotelev1">&gt; CF-metadata at cgd.ucar.edu
</em><br />
<em class="quotelev1">&gt; http:// mailman.cgd.ucar.edu/mailman/listinfo/cf-metadata
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<span id="received"><dfn>Received on</dfn> Wed Jan 07 2009 - 17:19:33 GMT</span>
</div>
<!-- body="end" -->
<div class="foot">
<map id="navbarfoot" name="navbarfoot" title="Related messages">
<ul class="links">
<li><dfn>This message</dfn>: [ <a href="#start1856">Message body</a> ]</li>
<!-- lnext="start" -->
<li><dfn>Next message</dfn>: <a href="./1857.html" title="Next message in the list">Karl Taylor: "[CF-metadata] Storing multiple NWP model runs in a NetCDF - CF file [SEC=UNCLASSIFIED]"</a></li>
<li><dfn>Previous message</dfn>: <a href="./1855.html" title="Previous message in the list">Karl Taylor: "[CF-metadata] Storing multiple NWP model runs in a NetCDF - CF file	[SEC=UNCLASSIFIED]"</a></li>
<li><dfn>In reply to</dfn>: <a href="./1855.html" title="Message to which this message replies">Karl Taylor: "[CF-metadata] Storing multiple NWP model runs in a NetCDF - CF file	[SEC=UNCLASSIFIED]"</a></li>
<!-- lnextthread="start" -->
<li><dfn>Next in thread</dfn>: <a href="./1857.html" title="Next message in this discussion thread">Karl Taylor: "[CF-metadata] Storing multiple NWP model runs in a NetCDF - CF file [SEC=UNCLASSIFIED]"</a></li>
<li><a name="replies" id="replies"></a>
<dfn>Reply</dfn>: <a href="./1857.html" title="Message sent in reply to this message">Karl Taylor: "[CF-metadata] Storing multiple NWP model runs in a NetCDF - CF file [SEC=UNCLASSIFIED]"</a></li>
<!-- lreply="end" -->
</ul>
<ul class="links">
<li><a name="options3" id="options3"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="index.html#msg1856" title="Contemporary messages by date">by date</a> ] [ <a href="thread.html#msg1856" title="Contemporary discussion threads">by thread</a> ] [ <a href="subject.html#msg1856" title="Contemporary messages by subject">by subject</a> ] [ <a href="author.html#msg1856" title="Contemporary messages by author">by author</a> ] [ <a href="attachment.html" title="Contemporary messages by attachment">by messages with attachments</a> ]</li>
</ul>
</map>
</div>
<!-- trailer="footer" -->
<p><small><em>
This archive was generated by <a href="http://www.hypermail-project.org/">hypermail 2.3.0</a>
: Wed Jul 27 2022 - 12:57:14 BST
</em></small></p>
</body>
<p><a style="text-decoration:none" href="./1855.html"><img src="./red-arrow-left.jpg" width="50" alt="&lArr;"></a> <a style="text-decoration:none" href="./1857.html"><img src="./red-arrow-right.jpg" width="50" alt="&rArr;"></a></html>
