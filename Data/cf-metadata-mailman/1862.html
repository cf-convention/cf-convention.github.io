<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
<meta name="generator" content="hypermail 2.3.0, see http://www.hypermail-project.org/" />
<title>[CF-metadata] Storing multiple NWP model runs in a NetCDF - CF file [SEC=UNCLASSIFIED] from Douglas Schuster on 2009-01-08 (cf-metadata-mailman)</title>
<meta name="Author" content="Douglas Schuster (schuster)" />
<meta name="Subject" content="[CF-metadata] Storing multiple NWP model runs in a NetCDF - CF file [SEC=UNCLASSIFIED]" />
<meta name="Date" content="2009-01-08" />
<style type="text/css">
/*<![CDATA[*/
/* To be incorporated in the main stylesheet, don't code it in hypermail! */
body {color: black; background: #ffffff}
dfn {font-weight: bold;}
pre { background-color:inherit;}
.head { border-bottom:1px solid black;}
.foot { border-top:1px solid black;}
th {font-style:italic;}
table { margin-left:2em;}map ul {list-style:none;}
#mid { font-size:0.9em;}
#received { float:right;}
address { font-style:inherit ;}
/*]]>*/
.quotelev1 {color : #990099}
.quotelev2 {color : #ff7700}
.quotelev3 {color : #007799}
.quotelev4 {color : #95c500}
.period {font-weight: bold}
</style>
</head>
<body>
<div class="head">
<a style="text-decoration:none" href="./1861.html"><img src="./red-arrow-left.jpg" width="50" alt="&lArr;"></a> <a style="text-decoration:none" href="./1863.html"><img src="./red-arrow-right.jpg" width="50" alt="&rArr;"></a><h1>[CF-metadata] Storing multiple NWP model runs in a NetCDF - CF file [SEC=UNCLASSIFIED]</h1>
<!-- received="Thu Jan  8 06:40:55 2009" -->
<!-- isoreceived="20090108064055" -->
<!-- sent="Thu, 8 Jan 2009 06:40:55 -0700" -->
<!-- isosent="20090108134055" -->
<!-- name="Douglas Schuster" -->
<!-- email="schuster" -->
<!-- subject="[CF-metadata] Storing multiple NWP model runs in a NetCDF - CF file [SEC=UNCLASSIFIED]" -->
<!-- id="6355F73B-DC99-4FF7-98F2-4A1AC950D8DD_at_ucar.edu" -->
<!-- charset="US-ASCII" -->
<!-- inreplyto="A638730E91FBA941969A262738288BFD01EEEAD5_at_officeho2.bom.gov.au" -->
<!-- expires="-1" -->
<map id="navbar" name="navbar">
<ul class="links">
<li>
<dfn>This message</dfn>:
[ <a href="#start1862" name="options1" id="options1" tabindex="1">Message body</a> ]
 [ More options (<a href="#options2">top</a>, <a href="#options3">bottom</a>) ]
</li>
<li>
<dfn>Related messages</dfn>:
<!-- unext="start" -->
[ <a href="./1863.html" accesskey="d" title="Timothy Hume: &quot;[CF-metadata] Storing multiple NWP model runs in a NetCDF - CFfile [SEC=UNCLASSIFIED]&quot;">Next message</a> ]
[ <a href="./1861.html" title="Jonathan Gregory: &quot;[CF-metadata] Storing multiple NWP model runs in a NetCDF - CF file [SEC=UNCLASSIFIED]&quot;">Previous message</a> ]
[ <a href="./1860.html" title="Timothy Hume: &quot;[CF-metadata] Storing multiple NWP model runs in a NetCDF - CF file [SEC=UNCLASSIFIED]&quot;">In reply to</a> ]
<!-- unextthread="start" -->
[ <a href="./1864.html" accesskey="t" title="Timothy Hume: &quot;[CF-metadata] Storing multiple NWP model runs in a NetCDF - CFfile [SEC=UNCLASSIFIED]&quot;">Next in thread</a> ]
 [ <a href="#replies">Replies</a> ]
<!-- ureply="end" -->
</li>
</ul>
</map>
<ul class="links">
<li><a name="options2" id="options2"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="index.html#msg1862" title="Contemporary messages by date">by date</a> ] [ <a href="thread.html#msg1862" title="Contemporary discussion threads">by thread</a> ] [ <a href="subject.html#msg1862" title="Contemporary messages by subject">by subject</a> ] [ <a href="author.html#msg1862" title="Contemporary messages by author">by author</a> ] [ <a href="attachment.html" title="Contemporary messages by attachment">by messages with attachments</a> ]</li>
</ul>
</div>
<!-- body="start" -->
<div class="mail">
<address class="headers">
<span id="from">
<dfn>From</dfn>: Douglas Schuster &lt;<a href="mailto:schuster?Subject=Re%3A%20%5BCF-metadata%5D%20Storing%20multiple%20NWP%20model%20runs%20in%20a%20NetCDF%20-%20CF%20file%20%5BSEC%3DUNCLASSIFIED%5D">schuster</a>&gt;
</span><br />
<span id="date"><dfn>Date</dfn>: Thu, 8 Jan 2009 06:40:55 -0700</span><br />
</address>
<br />
Hi Tim, John,
<br />
<br />NCAR has been using a structure similar to option 2 for TIGGE based  
<br />
NetCDF files that is not
<br />
technically CF compliant, but was reviewed by colleagues at ECMWF, UK  
<br />
MetOffice, and BADC
<br />
(Dec 10, 2007, ECMWF workshop) and deemed acceptable.  The structure  
<br />
is designed to handle multiple
<br />
ensemble forecast systems, and multiple init times with varying  
<br />
forecast periods.
<br />
<br /><br />i.e.
<br />
<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int reftime(reftime) ;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reftime:data_type = &quot;int&quot; ;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reftime:units = &quot;hours since 1950-01-01 00:00:00&quot; ;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reftime:standard_name = &quot;forecast_reference_time&quot; ;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reftime:long_name = &quot;Time of model initialization&quot; ;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int leadtime(reftime) ;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;leadtime:data_type = &quot;int&quot; ;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;leadtime:units = &quot;hours&quot; ;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;leadtime:standard_name = &quot;forecast_period&quot; ;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;leadtime:long_name = &quot;Hours since  
<br />
forecast_reference_time&quot; ;
<br />
<br />The structure was based on
<br />
the proposal by Francisco J. Doblas-Reyes for the &quot;Ensembles&quot;  
<br />
project.  A thread related to this proposal
<br />
can be found at:
<br />
<br /><a href="http://mailman.cgd.ucar.edu/pipermail/cf-metadata/2007/001470.html">http://mailman.cgd.ucar.edu/pipermail/cf-metadata/2007/001470.html</a>
<br />
<br />A sample file is available for download at:
<br />
<br /><a href="http://dss.ucar.edu/download/doug/data.nc">http://dss.ucar.edu/download/doug/data.nc</a>
<br />
<br />The metadata &quot;CDL&quot; dump of the file can be accessed at:
<br />
<br /><a href="http://dss.ucar.edu/download/doug/data.dump">http://dss.ucar.edu/download/doug/data.dump</a>
<br />
<br />Doug
<br />
<br /><br />On Jan 7, 2009, at 7:19 PM, Timothy Hume wrote:
<br />
<br /><em class="quotelev1">&gt; Hi John,
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; This seems a reasonable proposal to me. Often when storing NWP  
</em><br />
<em class="quotelev1">&gt; forecasts option (2) will suffice. Most centres will always include  
</em><br />
<em class="quotelev1">&gt; the same forecast lead times each time new NWP model data are  
</em><br />
<em class="quotelev1">&gt; disseminated (for example some centres will send out +6, +12, +18,  
</em><br />
<em class="quotelev1">&gt; +24, +36, +42, +48, +60 and +72 hour forecasts for two model runs  
</em><br />
<em class="quotelev1">&gt; per day, ever day). Data users will then often want to extract  
</em><br />
<em class="quotelev1">&gt; particular forecast lead times (e.g. +48 hours). Option (2) makes  
</em><br />
<em class="quotelev1">&gt; this a trivial task.
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; On the other hand option (1) is also useful, even when the time  
</em><br />
<em class="quotelev1">&gt; offsets are fixed. For example, one can construct an auxilliary  
</em><br />
<em class="quotelev1">&gt; coordinate variable called valid_time which is two dimensional. This  
</em><br />
<em class="quotelev1">&gt; aids in the cases when the user wants to extract all forecasts which  
</em><br />
<em class="quotelev1">&gt; are valid at a particular time. In fact, using both options (1) and  
</em><br />
<em class="quotelev1">&gt; (2) often yields the most useful files.
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; Tim.
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; -----Original Message-----
</em><br />
<em class="quotelev1">&gt; From: John Caron [mailto:caron at unidata.ucar.edu]
</em><br />
<em class="quotelev1">&gt; Sent: Thursday, 8 January 2009 12:56
</em><br />
<em class="quotelev1">&gt; To: Karl Taylor
</em><br />
<em class="quotelev1">&gt; Cc: Timothy Hume; cf-metadata at cgd.ucar.edu
</em><br />
<em class="quotelev1">&gt; Subject: Re: [CF-metadata] Storing multiple NWP model runs in a  
</em><br />
<em class="quotelev1">&gt; NetCDF - CF file [SEC=UNCLASSIFIED]
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; Hi Karl, Tim:
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; I think the original wording doesnt fully anticipate multiple  
</em><br />
<em class="quotelev1">&gt; datetime coordinates:
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; Section 4.4:
</em><br />
<em class="quotelev1">&gt; &quot; A time coordinate is identifiable from its units string alone. The  
</em><br />
<em class="quotelev1">&gt; Udunits routines utScan() and utIsTime() can be used to make this  
</em><br />
<em class="quotelev1">&gt; determination. Optionally, the time coordinate may be indicated  
</em><br />
<em class="quotelev1">&gt; additionally by providing the standard_name attribute with an  
</em><br />
<em class="quotelev1">&gt; appropriate value, and/or the axis attribute with the value T. &quot;
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; In Tim's example, his &quot;forecast/valid time&quot; is actually an offset  
</em><br />
<em class="quotelev1">&gt; from the base time, in units of time, not a udunit datetime. This  
</em><br />
<em class="quotelev1">&gt; allows it to be a 1D coordinate variable. But in the general case,  
</em><br />
<em class="quotelev1">&gt; if the forecast time spacing depends on the basetime, it must be 2D.  
</em><br />
<em class="quotelev1">&gt; We see this a lot in NCEP model output.
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; In general, when storing multiple forecast model runs in the same  
</em><br />
<em class="quotelev1">&gt; file there are two options:
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; 1. A 1D &quot;basetime/runtime&quot; coordinate variable identified by  
</em><br />
<em class="quotelev1">&gt; standard name &quot;forecast_reference_time&quot; which holds udunit  
</em><br />
<em class="quotelev1">&gt; datetimes, and a 2D &quot;forecast/valid time&quot; auxiliary coordinate  
</em><br />
<em class="quotelev1">&gt; variable with standard name &quot;time&quot; which also holds udunit  
</em><br />
<em class="quotelev1">&gt; datetimes. It must be dimensioned by the runtime and the time  
</em><br />
<em class="quotelev1">&gt; dimensions. Data variables will need to use the &quot;coordinates&quot;  
</em><br />
<em class="quotelev1">&gt; attribute to reference the time auxiliary coordinate, as usual.
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; 2. A 1D &quot;basetime/runtime&quot; coordinate variable identified by  
</em><br />
<em class="quotelev1">&gt; standard name &quot;forecast_reference_time&quot; which holds udunit dates,  
</em><br />
<em class="quotelev1">&gt; and a 1D or 2D &quot;forecast offset time&quot; auxiliary coordinate variable  
</em><br />
<em class="quotelev1">&gt; identified by standard name &quot;forecast_period&quot; which holds a udunit  
</em><br />
<em class="quotelev1">&gt; time unit (eg hours), which is added to the basetime to get the  
</em><br />
<em class="quotelev1">&gt; forecast datetime. If 1D, it will be dimensioned by time, if 2d it  
</em><br />
<em class="quotelev1">&gt; will be dimensioned by runtime and time, and must be referenced by  
</em><br />
<em class="quotelev1">&gt; the &quot;coordinates&quot; attribute
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; As an aside, the utIsTime() function is ambiguous as to whether we  
</em><br />
<em class="quotelev1">&gt; have a time unit or a datetime unit (which udunits calls &quot;having an  
</em><br />
<em class="quotelev1">&gt; offset&quot;). I think we need to carefully distinguish time and  
</em><br />
<em class="quotelev1">&gt; datetime, and specify where each is allowed.
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; If this seems reasonable, I can write up a proposal.
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; Karl Taylor wrote:
</em><br />
<em class="quotelev2">&gt;&gt; Hi Tim,
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; Section 4.4 (just before section 4.1) states &quot;The methods of  
</em><br />
<em class="quotelev2">&gt;&gt; identifying
</em><br />
<em class="quotelev2">&gt;&gt; coordinate types described in this section apply both to coordinate
</em><br />
<em class="quotelev2">&gt;&gt; variables and to auxiliary coordinate variables named by the  
</em><br />
<em class="quotelev2">&gt;&gt; coordinates
</em><br />
<em class="quotelev2">&gt;&gt; attribute.&quot;  Since the axis attribute is one of the methods used to
</em><br />
<em class="quotelev2">&gt;&gt; identify a vertical coordinate, it would seem to be allowed for the
</em><br />
<em class="quotelev2">&gt;&gt; level in your file.
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; On the other hand, in the 4th paragraph of section 5.7, it says that
</em><br />
<em class="quotelev2">&gt;&gt; &quot;The axis attribute is not allowed for auxiliary coordinate  
</em><br />
<em class="quotelev2">&gt;&gt; variables&quot;.
</em><br />
<em class="quotelev2">&gt;&gt; This seems to contradict the earlier statement.
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; We need to revise the document to be internally consistent.  Does  
</em><br />
<em class="quotelev2">&gt;&gt; anyone
</em><br />
<em class="quotelev2">&gt;&gt; recall why we would want to prohibit the use of the axis attribute  
</em><br />
<em class="quotelev2">&gt;&gt; for
</em><br />
<em class="quotelev2">&gt;&gt; auxiliary coordinate variables?
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; cheers,
</em><br />
<em class="quotelev2">&gt;&gt; Karl
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; Timothy Hume wrote:
</em><br />
<em class="quotelev3">&gt;&gt;&gt; Hi Karl,
</em><br />
<em class="quotelev3">&gt;&gt;&gt;
</em><br />
<em class="quotelev3">&gt;&gt;&gt; I have just checked one of my files, and get two errors:
</em><br />
<em class="quotelev3">&gt;&gt;&gt;
</em><br />
<em class="quotelev3">&gt;&gt;&gt; The first error is:
</em><br />
<em class="quotelev3">&gt;&gt;&gt;
</em><br />
<em class="quotelev3">&gt;&gt;&gt; ------------------
</em><br />
<em class="quotelev3">&gt;&gt;&gt; Checking variable: forecast
</em><br />
<em class="quotelev3">&gt;&gt;&gt; ------------------
</em><br />
<em class="quotelev3">&gt;&gt;&gt; ERROR (4.4): Invalid units and/or reference time
</em><br />
<em class="quotelev3">&gt;&gt;&gt;
</em><br />
<em class="quotelev3">&gt;&gt;&gt; This is the error I am aware of. My file should become compliant  
</em><br />
<em class="quotelev3">&gt;&gt;&gt; if I
</em><br />
<em class="quotelev3">&gt;&gt;&gt; switch the &quot;T&quot; axis to basetime.
</em><br />
<em class="quotelev3">&gt;&gt;&gt;
</em><br />
<em class="quotelev3">&gt;&gt;&gt;
</em><br />
<em class="quotelev3">&gt;&gt;&gt; The second error is:
</em><br />
<em class="quotelev3">&gt;&gt;&gt;
</em><br />
<em class="quotelev3">&gt;&gt;&gt; ------------------
</em><br />
<em class="quotelev3">&gt;&gt;&gt; Checking variable: level
</em><br />
<em class="quotelev3">&gt;&gt;&gt; ------------------
</em><br />
<em class="quotelev3">&gt;&gt;&gt; ERROR (4): Axis attribute is not allowed for auxillary coordinate
</em><br />
<em class="quotelev3">&gt;&gt;&gt; variables.
</em><br />
<em class="quotelev3">&gt;&gt;&gt;
</em><br />
<em class="quotelev3">&gt;&gt;&gt; I was unaware that the axis attribute should not be used for scalar
</em><br />
<em class="quotelev3">&gt;&gt;&gt; coordinate variables (as describe in Section 5.7). Is this intended?
</em><br />
<em class="quotelev3">&gt;&gt;&gt; In any case, I don't think this small error should cause the NetCDF
</em><br />
<em class="quotelev3">&gt;&gt;&gt; viewers I tried (IDV and Joe Sirott's web application) to not work.
</em><br />
<em class="quotelev3">&gt;&gt;&gt;
</em><br />
<em class="quotelev3">&gt;&gt;&gt; Cheers,
</em><br />
<em class="quotelev3">&gt;&gt;&gt;
</em><br />
<em class="quotelev3">&gt;&gt;&gt; Tim.
</em><br />
<em class="quotelev3">&gt;&gt;&gt;
</em><br />
<em class="quotelev3">&gt;&gt;&gt; -----Original Message-----
</em><br />
<em class="quotelev3">&gt;&gt;&gt; From: Karl Taylor [mailto:taylor13 at llnl.gov] Sent: Thursday, 8  
</em><br />
<em class="quotelev3">&gt;&gt;&gt; January
</em><br />
<em class="quotelev3">&gt;&gt;&gt; 2009 11:03
</em><br />
<em class="quotelev3">&gt;&gt;&gt; To: Timothy Hume
</em><br />
<em class="quotelev3">&gt;&gt;&gt; Cc: cf-metadata at cgd.ucar.edu
</em><br />
<em class="quotelev3">&gt;&gt;&gt; Subject: Re: [CF-metadata] Storing multiple NWP model runs in a  
</em><br />
<em class="quotelev3">&gt;&gt;&gt; NetCDF
</em><br />
<em class="quotelev3">&gt;&gt;&gt; - CF file [SEC=UNCLASSIFIED]
</em><br />
<em class="quotelev3">&gt;&gt;&gt;
</em><br />
<em class="quotelev3">&gt;&gt;&gt; Hi Tim,
</em><br />
<em class="quotelev3">&gt;&gt;&gt;
</em><br />
<em class="quotelev3">&gt;&gt;&gt; Other than the axis attribute for time, I didn't see any issues.   
</em><br />
<em class="quotelev3">&gt;&gt;&gt; You
</em><br />
<em class="quotelev3">&gt;&gt;&gt; might run the CF compliance checker on the file (http://
</em><br />
<em class="quotelev3">&gt;&gt;&gt; cf-pcmdi.llnl.gov/conformance), but it might not run if the other
</em><br />
<em class="quotelev3">&gt;&gt;&gt; utilities stumbled.  Maybe someone else has some ideas.
</em><br />
<em class="quotelev3">&gt;&gt;&gt;
</em><br />
<em class="quotelev3">&gt;&gt;&gt; cheers,
</em><br />
<em class="quotelev3">&gt;&gt;&gt; Karl
</em><br />
<em class="quotelev3">&gt;&gt;&gt;
</em><br />
<em class="quotelev3">&gt;&gt;&gt;
</em><br />
<em class="quotelev3">&gt;&gt;&gt; Timothy Hume wrote:
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; Hi,
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; I am writing NetCDF files which hold surface fields (2m temperature
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; etc) from multiple NWP model runs (all the runs from the same model
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; for the last month or so). The files are for operational use, so I
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; want them to strictly follow the CF conventions. I am running  
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; into a
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; couple of problems, where the conventions don't seem to be ideally
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; suited for storing more than a single model run.
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; Here is what I do:
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; I have four dimensions and associated coordinate variables:
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; basetime:    The base time for the model run (units: seconds since
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; 1970-01-01 00:00:00.0 +0:00)
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; forecast:    The forecast lead time, relative to the basetime  
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; (units:
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; hours)
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; latitude
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; longitude
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; There is no need for a vertical dimension, because I am using  
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; surface
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; fields. Never-the-less I make use of a scalar vertical coordinate
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; variable as described in Section 5.7 of the CF-1.3 metadata
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; conventions document.
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; The use of two dimensions to store the time information (basetime  
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; and
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; forecast) seems to be a natural way to store multiple NWP model  
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; runs,
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; and is the standard way used in the very old NUWG conventions. As  
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; far
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; as I can tell, what I am doing is supported by the CF conventions,
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; provided the time axis is taken to be the basetime dimension.  
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; This is
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; because Section 4.4 of the conventions specifies the units of the
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; time coordinate must include a reference time. Obviously the  
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; units of
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; the forecast coordinate cannot include a reference time, because  
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; the
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; reference time varies, and is determined by the value of the  
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; basetime
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; coordinate.
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; The difficulty I am encountering is that some applications which  
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; read
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; NetCDF/CF files (such as the Unidata IDV and Joe Sirott's very nice
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; web based NetCDF data viewer) seem to choke on my data. I suspect
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; (but am not 100% certain in the case of the IDV) that the reason is
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; because of the way I handle the time information in my files.
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; To illustrate in more detail what my files look like, I am  
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; attaching
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; the CDL from an example file. The CDL is non-CF compliant,  
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; because I
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; have specified the &quot;T&quot; axis (via the axis variable attribute) to be
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; the forecast coordinate, and the forecast coordinate has invalid
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; units (no reference time). I am planning on switching the &quot;T&quot;  
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; axis to
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; the base time coordinate, which as far as I can determine should  
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; make
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; the file CF compliant.
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; My question is: is there a better (or more standard) way of storing
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; multiple NWP model runs in a single file than what I am doing?
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; Cheers,
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; Tim Hume
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; Centre for Australian Weather and Climate Research
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; Australian Bureau of Meteorology
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; Melbourne
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; Australia
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; --- Example CDL follows ---
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; netcdf gasp_1p0deg_ocf_t2m_rtdb_opn {
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; dimensions:
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;    forecast = 69 ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;    basetime = UNLIMITED ; // (100 currently)
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;    latitude = 96 ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;    longitude = 121 ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;    bounds = 2 ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; variables:
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;    double forecast(forecast) ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        forecast:long_name = &quot;Time of model forecast, relative to  
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; the
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; basetime&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        forecast:units = &quot;hours&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        forecast:standard_name = &quot;forecast_period&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        forecast:axis = &quot;T&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        forecast:bounds = &quot;forecast_bounds&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;    double forecast_bounds(forecast, bounds) ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        forecast_bounds:long_name = &quot;forecast interval&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        forecast_bounds:units = &quot;hours&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;    int basetime(basetime) ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        basetime:long_name = &quot;Model basetime&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        basetime:units = &quot;seconds since 1970-01-01 00:00:00.0  
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; +0:00&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        basetime:calendar = &quot;gregorian&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        basetime:standard_name = &quot;forecast_reference_time&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;    double latitude(latitude) ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        latitude:long_name = &quot;latitude&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        latitude:units = &quot;degrees_north&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        latitude:bounds = &quot;latitude_bounds&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        latitude:valid_min = -90. ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        latitude:valid_max = 90. ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        latitude:standard_name = &quot;latitude&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        latitude:axis = &quot;Y&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;    double latitude_bounds(latitude, bounds) ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        latitude_bounds:long_name = &quot;grid cell latitude  
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; boundaries&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        latitude_bounds:units = &quot;degrees_north&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        latitude_bounds:valid_min = -90. ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        latitude_bounds:valid_max = 90. ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;    double longitude(longitude) ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        longitude:long_name = &quot;longitude&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        longitude:units = &quot;degrees_east&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        longitude:bounds = &quot;longitude_bounds&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        longitude:valid_min = -360. ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        longitude:valid_max = 360. ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        longitude:standard_name = &quot;longitude&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        longitude:axis = &quot;X&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;    double longitude_bounds(longitude, bounds) ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        longitude_bounds:long_name = &quot;grid cell longitude  
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; boundaries&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        longitude_bounds:units = &quot;degrees_east&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        longitude_bounds:valid_min = -360. ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        longitude_bounds:valid_max = 360. ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;    float temperature_2m(basetime, forecast, latitude, longitude) ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        temperature_2m:long_name = &quot;Air temperature 2m above the
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; surface&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        temperature_2m:units = &quot;K&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        temperature_2m:_FillValue = 9.96921e+36f ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        temperature_2m:missing_value = 9.96921e+36f ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        temperature_2m:valid_min = 180.f ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        temperature_2m:valid_max = 330.f ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        temperature_2m:standard_name = &quot;air_temperature&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        temperature_2m:cell_methods = &quot;lat: lon: mean (area  
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; weighted)&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        temperature_2m:coordinates = &quot;level&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;    double level ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        level:long_name = &quot;Height above the surface&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        level:units = &quot;m&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        level:positive = &quot;up&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        level:standard_name = &quot;height&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        level:axis = &quot;Z&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; // global attributes:
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        :Conventions = &quot;CF-1.3&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        :history = &quot;File created by the Gridded OCF data ingest
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; system&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        :institution = &quot;Australian Bureau of Meteorology&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        :source = &quot;model&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        :title = &quot;GASP forecasts of temperature_2m; resolution: 1.0
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; degree; source: rtdb&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;        :topography = &quot;MSAS&quot; ;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; }
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; _______________________________________________
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; CF-metadata mailing list
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; CF-metadata at cgd.ucar.edu
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt; http://  mailman.cgd.ucar.edu/mailman/listinfo/cf-metadata
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;
</em><br />
<em class="quotelev4">&gt;&gt;&gt;&gt;
</em><br />
<em class="quotelev3">&gt;&gt;&gt;
</em><br />
<em class="quotelev3">&gt;&gt;&gt;
</em><br />
<em class="quotelev3">&gt;&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; _______________________________________________
</em><br />
<em class="quotelev2">&gt;&gt; CF-metadata mailing list
</em><br />
<em class="quotelev2">&gt;&gt; CF-metadata at cgd.ucar.edu
</em><br />
<em class="quotelev2">&gt;&gt; <a href="http://mailman.cgd.ucar.edu/mailman/listinfo/cf-metadata">http://mailman.cgd.ucar.edu/mailman/listinfo/cf-metadata</a>
</em><br />
<em class="quotelev1">&gt; _______________________________________________
</em><br />
<em class="quotelev1">&gt; CF-metadata mailing list
</em><br />
<em class="quotelev1">&gt; CF-metadata at cgd.ucar.edu
</em><br />
<em class="quotelev1">&gt; <a href="http://mailman.cgd.ucar.edu/mailman/listinfo/cf-metadata">http://mailman.cgd.ucar.edu/mailman/listinfo/cf-metadata</a>
</em><br />
<br />-------------- next part --------------
<br />
An HTML attachment was scrubbed...
<br />
URL: &lt;<a href="http://mailman.cgd.ucar.edu/pipermail/cf-metadata/attachments/20090108/c89013fb/attachment-0002.html">http://mailman.cgd.ucar.edu/pipermail/cf-metadata/attachments/20090108/c89013fb/attachment-0002.html</a>&gt;
<br />
<span id="received"><dfn>Received on</dfn> Thu Jan 08 2009 - 06:40:55 GMT</span>
</div>
<!-- body="end" -->
<div class="foot">
<map id="navbarfoot" name="navbarfoot" title="Related messages">
<ul class="links">
<li><dfn>This message</dfn>: [ <a href="#start1862">Message body</a> ]</li>
<!-- lnext="start" -->
<li><dfn>Next message</dfn>: <a href="./1863.html" title="Next message in the list">Timothy Hume: "[CF-metadata] Storing multiple NWP model runs in a NetCDF - CFfile [SEC=UNCLASSIFIED]"</a></li>
<li><dfn>Previous message</dfn>: <a href="./1861.html" title="Previous message in the list">Jonathan Gregory: "[CF-metadata] Storing multiple NWP model runs in a NetCDF - CF file [SEC=UNCLASSIFIED]"</a></li>
<li><dfn>In reply to</dfn>: <a href="./1860.html" title="Message to which this message replies">Timothy Hume: "[CF-metadata] Storing multiple NWP model runs in a NetCDF - CF file [SEC=UNCLASSIFIED]"</a></li>
<!-- lnextthread="start" -->
<li><dfn>Next in thread</dfn>: <a href="./1864.html" title="Next message in this discussion thread">Timothy Hume: "[CF-metadata] Storing multiple NWP model runs in a NetCDF - CFfile [SEC=UNCLASSIFIED]"</a></li>
<li><a name="replies" id="replies"></a>
<dfn>Reply</dfn>: <a href="./1864.html" title="Message sent in reply to this message">Timothy Hume: "[CF-metadata] Storing multiple NWP model runs in a NetCDF - CFfile [SEC=UNCLASSIFIED]"</a></li>
<!-- lreply="end" -->
</ul>
<ul class="links">
<li><a name="options3" id="options3"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="index.html#msg1862" title="Contemporary messages by date">by date</a> ] [ <a href="thread.html#msg1862" title="Contemporary discussion threads">by thread</a> ] [ <a href="subject.html#msg1862" title="Contemporary messages by subject">by subject</a> ] [ <a href="author.html#msg1862" title="Contemporary messages by author">by author</a> ] [ <a href="attachment.html" title="Contemporary messages by attachment">by messages with attachments</a> ]</li>
</ul>
</map>
</div>
<!-- trailer="footer" -->
<p><small><em>
This archive was generated by <a href="http://www.hypermail-project.org/">hypermail 2.3.0</a>
: Wed Jul 27 2022 - 12:57:14 BST
</em></small></p>
</body>
<p><a style="text-decoration:none" href="./1861.html"><img src="./red-arrow-left.jpg" width="50" alt="&lArr;"></a> <a style="text-decoration:none" href="./1863.html"><img src="./red-arrow-right.jpg" width="50" alt="&rArr;"></a></html>
