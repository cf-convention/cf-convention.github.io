<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
<meta name="generator" content="hypermail 2.3.0, see http://www.hypermail-project.org/" />
<title>[CF-metadata] Are ensembles a compelling use case for &quot;group-aware&quot; metadata? from stephen.pascoe at stfc.ac.uk on 2013-09-21 (cf-metadata-mailman)</title>
<meta name="Author" content="stephen.pascoe at stfc.ac.uk (stephen.pascoe)" />
<meta name="Subject" content="[CF-metadata] Are ensembles a compelling use case for &quot;group-aware&quot; metadata?" />
<meta name="Date" content="2013-09-21" />
<style type="text/css">
/*<![CDATA[*/
/* To be incorporated in the main stylesheet, don't code it in hypermail! */
body {color: black; background: #ffffff}
dfn {font-weight: bold;}
pre { background-color:inherit;}
.head { border-bottom:1px solid black;}
.foot { border-top:1px solid black;}
th {font-style:italic;}
table { margin-left:2em;}map ul {list-style:none;}
#mid { font-size:0.9em;}
#received { float:right;}
address { font-style:inherit ;}
/*]]>*/
.quotelev1 {color : #990099}
.quotelev2 {color : #ff7700}
.quotelev3 {color : #007799}
.quotelev4 {color : #95c500}
.period {font-weight: bold}
</style>
</head>
<body>
<div class="head">
<a style="text-decoration:none" href="./5736.html"><img src="./red-arrow-left.jpg" width="50" alt="&lArr;"></a> <a style="text-decoration:none" href="./5738.html"><img src="./red-arrow-right.jpg" width="50" alt="&rArr;"></a><h1>[CF-metadata] Are ensembles a compelling use case for &quot;group-aware&quot; metadata?</h1>
<!-- received="Sat Sep 21 02:50:05 2013" -->
<!-- isoreceived="20130921015005" -->
<!-- sent="Sat, 21 Sep 2013 08:50:05 +0000" -->
<!-- isosent="20130921085005" -->
<!-- name="stephen.pascoe at stfc.ac.uk" -->
<!-- email="stephen.pascoe" -->
<!-- subject="[CF-metadata] Are ensembles a compelling use case for &quot;group-aware&quot; metadata?" -->
<!-- id="4C353E6E4A08AE4792B350DAA392B52153F31D02_at_EXCHMBX01.fed.cclrc.ac.uk" -->
<!-- charset="US-ASCII" -->
<!-- inreplyto="523D136F.7030409_at_uci.edu" -->
<!-- expires="-1" -->
<map id="navbar" name="navbar">
<ul class="links">
<li>
<dfn>This message</dfn>:
[ <a href="#start5737" name="options1" id="options1" tabindex="1">Message body</a> ]
 [ More options (<a href="#options2">top</a>, <a href="#options3">bottom</a>) ]
</li>
<li>
<dfn>Related messages</dfn>:
<!-- unext="start" -->
[ <a href="./5738.html" accesskey="d" title="Fuchs Petra: &quot;[CF-metadata] CF checker as script&quot;">Next message</a> ]
[ <a href="./5736.html" title="Charlie Zender: &quot;[CF-metadata] Towards recognizing and exploiting hierarchical groups (Charlie Zender - Steve Hankin - Richard Signell)&quot;">Previous message</a> ]
[ <a href="./5735.html" title="Charlie Zender: &quot;[CF-metadata] Are ensembles a compelling use case for &#0034;group-aware&#0034; metadata?&quot;">In reply to</a> ]
<!-- unextthread="start" -->
[ <a href="./5740.html" accesskey="t" title="Charlie Zender: &quot;[CF-metadata] Are ensembles a compelling use case for &#0034;group-aware&#0034; metadata?&quot;">Next in thread</a> ]
 [ <a href="#replies">Replies</a> ]
<!-- ureply="end" -->
</li>
</ul>
</map>
<ul class="links">
<li><a name="options2" id="options2"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="index.html#msg5737" title="Contemporary messages by date">by date</a> ] [ <a href="thread.html#msg5737" title="Contemporary discussion threads">by thread</a> ] [ <a href="subject.html#msg5737" title="Contemporary messages by subject">by subject</a> ] [ <a href="author.html#msg5737" title="Contemporary messages by author">by author</a> ] [ <a href="attachment.html" title="Contemporary messages by attachment">by messages with attachments</a> ]</li>
</ul>
</div>
<!-- body="start" -->
<div class="mail">
<address class="headers">
<span id="from">
<dfn>From</dfn>: stephen.pascoe at stfc.ac.uk &lt;<a href="mailto:stephen.pascoe?Subject=Re%3A%20%5BCF-metadata%5D%20Are%20ensembles%20a%20compelling%20use%20case%20for%20%22group-aware%22%20metadata%3F">stephen.pascoe</a>&gt;
</span><br />
<span id="date"><dfn>Date</dfn>: Sat, 21 Sep 2013 08:50:05 +0000</span><br />
</address>
<br />
Hi Charlie,
<br />
<br />Your perspective is as an end user who has autonomy over how they want to view the data.  The data provider's perspective is different.  We try to avoid transforming the data where ever possible.  Archived data shouldn't be changed at all and transforming a copy adds a lot of overhead in both disk and software complexity.  We don't like having to continually pack and unpack suitcases.
<br />
<br />My impression from this excellent discussion is that hierarchal NetCDF doesn't make sense for data providers (except in specific cases) but does for some users.  A way round this would be for CF to start by saying any hierarchal CF-NetCDF file must be equivalent to a set of non-hierarchal CF-NetCDF files, or ideally both would have definitions in terms of a CF data model (but that might take some time).  I.e. we need a standard way of packing and unpacking the suitcase.  If we did this first (and stuck to it!) I think I'd be happy. 
<br />
<br />I've made a couple more comments inline.
<br />
<br />Cheers,
<br />
Stephen.
<br />
<br />On 21 Sep 2013, at 04:33, Charlie Zender wrote:
<br />
<br /><em class="quotelev1">&gt; Hi Bryan,
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; Your last point is crucial so let me address it first.
</em><br />
<em class="quotelev1">&gt; I agree that placing metadata that is &quot;external&quot; to the dataset into
</em><br />
<em class="quotelev1">&gt; the dataset is a mistake! A &quot;category error&quot; as you put it. As the
</em><br />
<em class="quotelev1">&gt; interleaved response explains, our proposal neither recommends nor
</em><br />
<em class="quotelev1">&gt; requires this.
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; Le 20/09/2013 00:21, Bryan Lawrence a ?crit :
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev2">&gt;&gt; Great use case, but not compelling :-) Before I get going, I can see
</em><br />
<em class="quotelev2">&gt;&gt; that folks might want to do this, and fair play, but it's not
</em><br />
<em class="quotelev2">&gt;&gt; compelling. Let me give you a couple of examples of where this approach
</em><br />
<em class="quotelev2">&gt;&gt; would cause others problems.
</em><br />
<em class="quotelev2">&gt;&gt; 
</em><br />
<em class="quotelev2">&gt;&gt; Let's imagine that the ensemble members take time to produce, and that
</em><br />
<em class="quotelev2">&gt;&gt; not everything can be stored online and some stuff has to go to tape.
</em><br />
<em class="quotelev2">&gt;&gt; So now we have a situation where we are encouraging folks to write into
</em><br />
<em class="quotelev2">&gt;&gt; files that *will* need to be altered, and we'll have to pull all those
</em><br />
<em class="quotelev2">&gt;&gt; files off tape to modify them. Further, we can be sure that the axes of
</em><br />
<em class="quotelev2">&gt;&gt; analyses will change over time as different users analyse the data for
</em><br />
<em class="quotelev2">&gt;&gt; different problems.
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; Back-end storage (e.g., your tape farm) need not change at all.
</em><br />
<em class="quotelev1">&gt; Servers can continue to store flat datasets as primary sources.
</em><br />
<em class="quotelev1">&gt; Servers could aggregate into hierarchies as user or provider desires.
</em><br />
<em class="quotelev1">&gt; Datasets matching a query (&quot;all ECMWF Historical simulations&quot;)
</em><br />
<em class="quotelev1">&gt; could be aggregated into a hierarchy by the server and returned.
</em><br />
<em class="quotelev1">&gt; No one advocates needing to know how many ensemble members will be
</em><br />
<em class="quotelev1">&gt; performed and including that number in a model dataset at run time.
</em><br />
<em class="quotelev1">&gt; It would be unwise and practically impossible to do.
</em><br />
<em class="quotelev1">&gt; Let the query retrieve what it will and aggregate the data if and how
</em><br />
<em class="quotelev1">&gt; the query specifies. Then the user/provider could obtain/serve ONE
</em><br />
<em class="quotelev1">&gt; or a few hierarchical files or possibly flat files with equivalent
</em><br />
<em class="quotelev1">&gt; metadata (subject to size limitations, of course).
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<br />As a convenient package for delivering collections of data to the user this would be useful. However, to maintain the interoperability of CF we would need watertight rules for transforming a grouped CF-NetCDF file into a set of equivalent NetCDF files, and visa versa. 
<br />
<br /><br /><em class="quotelev1">&gt; In fact the group aggregation CF could consider would solve many
</em><br />
<em class="quotelev1">&gt; problems without appending _any_ metadata, for groups hierarchies can
</em><br />
<em class="quotelev1">&gt; be automatically traversed and counted (thus determining ensemble axis
</em><br />
<em class="quotelev1">&gt; size), and/or extra group metadata can be added outside the &quot;ensemble&quot;
</em><br />
<em class="quotelev1">&gt; without touching the original data. A logical place for &quot;external&quot;
</em><br />
<em class="quotelev1">&gt; data for members of the CESM ensemble could be group metadata in
</em><br />
<em class="quotelev1">&gt; the supergroup (/cesm) that holds the members (/cesm/cesm_??).
</em><br />
<em class="quotelev1">&gt; Do flat files offer a cleaner method for handling &quot;external&quot; data?
</em><br />
<em class="quotelev1">&gt; And one that generalizes to ensembles of any order?
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; As mentioned in a previous thread, some users prefer all their data in
</em><br />
<em class="quotelev1">&gt; one place. Where they can, e.g., average it with one command:
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; ncwa mme_cnt.nc. Done. No loops or wildcards necessary.
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; Some users will prefer their current methods. Some will shift
</em><br />
<em class="quotelev1">&gt; gradually as tools, producers, distributors, and conventions improve
</em><br />
<em class="quotelev1">&gt; support.
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; Many objections to hierarchies understandably come from data
</em><br />
<em class="quotelev1">&gt; distributors with an investment in an existing codebase.
</em><br />
<br />Not entirely.  Sure, we don't want to be given &quot;CF-NetCDF&quot; that breaks all our tools because of hierarchies but that sort of problem is a fact or life for us.  My objection is from experience of building codebases which use hierarchal concepts and how they invariably are more difficult to work with at scale than non-hierarchal ones.  That's not to say they don't use tree algorithms underneath (e.g. btrees in a database) but at the interface level hierarchies normally get in the way.
<br />
<br />Take your idea that some &quot;external&quot; metadata will be inside the files in a supergroup. I predict that some of the same class of metadata will end up in some other part of the system: e.g. in a database or a metadata file.  The code now needs to deal with multiple heterogeneous sources of the same metadata.  It needs rules for deciding which source takes precedence, etc.
<br />
<br /><br /><em class="quotelev1">&gt; That's a fact---not a criticism---because who else reads this list?
</em><br />
<em class="quotelev1">&gt; Once users have their data, they don't spend so much time looking at
</em><br />
<em class="quotelev1">&gt; catalogs and web services. They massage the data they have obtained.
</em><br />
<em class="quotelev1">&gt; As files. Lots and lots of flat files. Many users, and some
</em><br />
<em class="quotelev1">&gt; distributors, would appreciate a tidier solution.
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; We could start a whole thread on the use case of &quot;return all the data
</em><br />
<em class="quotelev1">&gt; sets relevant to this bounding box&quot;. Practically impossible with
</em><br />
<em class="quotelev1">&gt; flat files because of all the grids that could be involved. Yet quite
</em><br />
<em class="quotelev1">&gt; plausible with groups. However, this case does not interest me as much
</em><br />
<em class="quotelev1">&gt; as MME. Please be aware of the general issue of file proliferation,
</em><br />
<em class="quotelev1">&gt; though.
</em><br />
<br />For the end user, who has complete autonomy over how the data is grouped this makes sense but not for those of use holding data where we have to serve multiple views of the data.  On the server side we would use spatial indexing to solve the bounding box problem.  I think that solution is far superior to putting the actual data into groups.  I would hope in time those sort of tools will be available to users.
<br />
<br />As a passing jibe: you also seem influenced by your current set of tools that happen to be group-aware (nco).  Everyone's tools must keep moving forward.  Maybe we could work on a  spatial index format?
<br />
<br /><em class="quotelev1">&gt; 
</em><br />
<em class="quotelev2">&gt;&gt; A priori grouping is the same as deciding a priori on the most efficient
</em><br />
<em class="quotelev2">&gt;&gt; axes of analysis. In general, for climate data analysis (and for us at
</em><br />
<em class="quotelev2">&gt;&gt; BADC with very diverse user groupings) this approach would be very
</em><br />
<em class="quotelev2">&gt;&gt; inefficient ...
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; In other words, ability to aggregate, dismember, flatten, invert, and
</em><br />
<em class="quotelev1">&gt; reorder hierarchies easily without loss of information is desirable.
</em><br />
<em class="quotelev1">&gt; Fully agree.
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev2">&gt;&gt; If you want to avoid relying on ls/grep and friends, then why not have a
</em><br />
<em class="quotelev2">&gt;&gt; short line text file, a manifest? So we only need to alter the manifest.
</em><br />
<em class="quotelev2">&gt;&gt; 
</em><br />
<em class="quotelev2">&gt;&gt; (Incidentally that' the same solution that NASA should be using.)
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; No argument from me that that can work well for providers.
</em><br />
<em class="quotelev1">&gt; However, many users rely on typing commands to analyze datasets on
</em><br />
<em class="quotelev1">&gt; their local machine which have been previously downloaded or produced
</em><br />
<em class="quotelev1">&gt; locally. I was thinking more of them. When information needed for an
</em><br />
<em class="quotelev1">&gt; analysis in not in the file, then the file in incomplete.
</em><br />
<em class="quotelev1">&gt; Self-describing datasets are great.
</em><br />
<em class="quotelev1">&gt; Self-describing and complete datasets are even better.
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev2">&gt;&gt; IMHO it's a category error to push everything into internal file
</em><br />
<em class="quotelev2">&gt;&gt; metadata. The suitcase metaphor is exactly appropriate for this
</em><br />
<em class="quotelev2">&gt;&gt; approach, since the reason for doing it is to transfer stuff you think
</em><br />
<em class="quotelev2">&gt;&gt; belongs together. However, five minutes after getting home, you empty
</em><br />
<em class="quotelev2">&gt;&gt; the suitcase .... and reorganise it. At petascale, we can't afford to do
</em><br />
<em class="quotelev2">&gt;&gt; that!
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; Pack a suitcase when it makes sense.
</em><br />
<em class="quotelev1">&gt; Users will let you know when you've packed well by their silence.
</em><br />
<em class="quotelev1">&gt; Or poorly by their complaints :)
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; Finally, your reponse does not indicate how/if you would solve Point 3
</em><br />
<em class="quotelev1">&gt; of my &quot;compelling ensemble&quot; example, e.g., weights. How would you
</em><br />
<em class="quotelev1">&gt; attach data that is &quot;external&quot; to a dataset to the dataset without
</em><br />
<em class="quotelev1">&gt; running into all the problems of a priori writing?
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; cz
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; Le 20/09/2013 00:21, Bryan Lawrence a ?crit :
</em><br />
<em class="quotelev2">&gt;&gt; Hi Charlie
</em><br />
<em class="quotelev2">&gt;&gt; 
</em><br />
<em class="quotelev2">&gt;&gt; Great use case, but not compelling :-) Before I get going, I can see
</em><br />
<em class="quotelev2">&gt;&gt; that folks might want to do this, and fair play, but it's not
</em><br />
<em class="quotelev2">&gt;&gt; compelling. Let me give you a couple of examples of where this approach
</em><br />
<em class="quotelev2">&gt;&gt; would cause others problems.
</em><br />
<em class="quotelev2">&gt;&gt; 
</em><br />
<em class="quotelev2">&gt;&gt; Let's imagine that the ensemble members take time to produce, and that
</em><br />
<em class="quotelev2">&gt;&gt; not everything can be stored online and some stuff has to go to tape.
</em><br />
<em class="quotelev2">&gt;&gt; So now we have a situation where we are encouraging folks to write into
</em><br />
<em class="quotelev2">&gt;&gt; files that *will* need to be altered, and we'll have to pull all those
</em><br />
<em class="quotelev2">&gt;&gt; files off tape to modify them. Further, we can be sure that the axes of
</em><br />
<em class="quotelev2">&gt;&gt; analyses will change over time as different users analyse the data for
</em><br />
<em class="quotelev2">&gt;&gt; different problems.
</em><br />
<em class="quotelev2">&gt;&gt; 
</em><br />
<em class="quotelev2">&gt;&gt; A priori grouping is the same as deciding a priori on the most efficient
</em><br />
<em class="quotelev2">&gt;&gt; axes of analysis. In general, for climate data analysis (and for us at
</em><br />
<em class="quotelev2">&gt;&gt; BADC with very diverse user groupings) this approach would be very
</em><br />
<em class="quotelev2">&gt;&gt; inefficient ...
</em><br />
<em class="quotelev2">&gt;&gt; 
</em><br />
<em class="quotelev2">&gt;&gt; If you want to avoid relying on ls/grep and friends, then why not have a
</em><br />
<em class="quotelev2">&gt;&gt; short line text file, a manifest? So we only need to alter the manifest.
</em><br />
<em class="quotelev2">&gt;&gt; 
</em><br />
<em class="quotelev2">&gt;&gt; (Incidentally that' the same solution that NASA should be using.)
</em><br />
<em class="quotelev2">&gt;&gt; 
</em><br />
<em class="quotelev2">&gt;&gt; IMHO it's a category error to push everything into internal file
</em><br />
<em class="quotelev2">&gt;&gt; metadata. The suitcase metaphor is exactly appropriate for this
</em><br />
<em class="quotelev2">&gt;&gt; approach, since the reason for doing it is to transfer stuff you think
</em><br />
<em class="quotelev2">&gt;&gt; belongs together. However, five minutes after getting home, you empty
</em><br />
<em class="quotelev2">&gt;&gt; the suitcase .... and reorganise it. At petascale, we can't afford to do
</em><br />
<em class="quotelev2">&gt;&gt; that!
</em><br />
<em class="quotelev2">&gt;&gt; 
</em><br />
<em class="quotelev2">&gt;&gt; Bryan
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; -- 
</em><br />
<em class="quotelev1">&gt; Charlie Zender, Earth System Sci. &amp; Computer Sci.
</em><br />
<em class="quotelev1">&gt; University of California, Irvine 949-891-2429 )'(
</em><br />
<em class="quotelev1">&gt; _______________________________________________
</em><br />
<em class="quotelev1">&gt; CF-metadata mailing list
</em><br />
<em class="quotelev1">&gt; CF-metadata at cgd.ucar.edu
</em><br />
<em class="quotelev1">&gt; <a href="http://mailman.cgd.ucar.edu/mailman/listinfo/cf-metadata">http://mailman.cgd.ucar.edu/mailman/listinfo/cf-metadata</a>
</em><br />
<br /><pre>
-- 
Scanned by iCritical.
</pre>
<span id="received"><dfn>Received on</dfn> Sat Sep 21 2013 - 02:50:05 BST</span>
</div>
<!-- body="end" -->
<div class="foot">
<map id="navbarfoot" name="navbarfoot" title="Related messages">
<ul class="links">
<li><dfn>This message</dfn>: [ <a href="#start5737">Message body</a> ]</li>
<!-- lnext="start" -->
<li><dfn>Next message</dfn>: <a href="./5738.html" title="Next message in the list">Fuchs Petra: "[CF-metadata] CF checker as script"</a></li>
<li><dfn>Previous message</dfn>: <a href="./5736.html" title="Previous message in the list">Charlie Zender: "[CF-metadata] Towards recognizing and exploiting hierarchical groups (Charlie Zender - Steve Hankin - Richard Signell)"</a></li>
<li><dfn>In reply to</dfn>: <a href="./5735.html" title="Message to which this message replies">Charlie Zender: "[CF-metadata] Are ensembles a compelling use case for &#0034;group-aware&#0034; metadata?"</a></li>
<!-- lnextthread="start" -->
<li><dfn>Next in thread</dfn>: <a href="./5740.html" title="Next message in this discussion thread">Charlie Zender: "[CF-metadata] Are ensembles a compelling use case for &#0034;group-aware&#0034; metadata?"</a></li>
<li><a name="replies" id="replies"></a>
<dfn>Reply</dfn>: <a href="./5740.html" title="Message sent in reply to this message">Charlie Zender: "[CF-metadata] Are ensembles a compelling use case for &#0034;group-aware&#0034; metadata?"</a></li>
<!-- lreply="end" -->
</ul>
<ul class="links">
<li><a name="options3" id="options3"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="index.html#msg5737" title="Contemporary messages by date">by date</a> ] [ <a href="thread.html#msg5737" title="Contemporary discussion threads">by thread</a> ] [ <a href="subject.html#msg5737" title="Contemporary messages by subject">by subject</a> ] [ <a href="author.html#msg5737" title="Contemporary messages by author">by author</a> ] [ <a href="attachment.html" title="Contemporary messages by attachment">by messages with attachments</a> ]</li>
</ul>
</map>
</div>
<!-- trailer="footer" -->
<p><small><em>
This archive was generated by <a href="http://www.hypermail-project.org/">hypermail 2.3.0</a>
: Wed Jul 27 2022 - 12:58:29 BST
</em></small></p>
</body>
<p><a style="text-decoration:none" href="./5736.html"><img src="./red-arrow-left.jpg" width="50" alt="&lArr;"></a> <a style="text-decoration:none" href="./5738.html"><img src="./red-arrow-right.jpg" width="50" alt="&rArr;"></a></html>
