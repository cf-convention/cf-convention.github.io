<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
<meta name="generator" content="hypermail 2.3.0, see http://www.hypermail-project.org/" />
<title>[CF-metadata] Are ensembles a compelling use case for &quot;group-aware&quot; metadata? (CZ) from Charlie Zender on 2013-09-25 (cf-metadata-mailman)</title>
<meta name="Author" content="Charlie Zender (zender)" />
<meta name="Subject" content="[CF-metadata] Are ensembles a compelling use case for &quot;group-aware&quot; metadata? (CZ)" />
<meta name="Date" content="2013-09-25" />
<style type="text/css">
/*<![CDATA[*/
/* To be incorporated in the main stylesheet, don't code it in hypermail! */
body {color: black; background: #ffffff}
dfn {font-weight: bold;}
pre { background-color:inherit;}
.head { border-bottom:1px solid black;}
.foot { border-top:1px solid black;}
th {font-style:italic;}
table { margin-left:2em;}map ul {list-style:none;}
#mid { font-size:0.9em;}
#received { float:right;}
address { font-style:inherit ;}
/*]]>*/
.quotelev1 {color : #990099}
.quotelev2 {color : #ff7700}
.quotelev3 {color : #007799}
.quotelev4 {color : #95c500}
.period {font-weight: bold}
</style>
</head>
<body>
<div class="head">
<a style="text-decoration:none" href="./5738.html"><img src="./red-arrow-left.jpg" width="50" alt="&lArr;"></a> <a style="text-decoration:none" href="./5740.html"><img src="./red-arrow-right.jpg" width="50" alt="&rArr;"></a><h1>[CF-metadata] Are ensembles a compelling use case for &quot;group-aware&quot; metadata? (CZ)</h1>
<!-- received="Tue Sep 24 22:45:40 2013" -->
<!-- isoreceived="20130924214540" -->
<!-- sent="Tue, 24 Sep 2013 21:45:40 -0700" -->
<!-- isosent="20130925044540" -->
<!-- name="Charlie Zender" -->
<!-- email="zender" -->
<!-- subject="[CF-metadata] Are ensembles a compelling use case for &quot;group-aware&quot; metadata? (CZ)" -->
<!-- id="52426A74.3060306_at_uci.edu" -->
<!-- charset="US-ASCII" -->
<!-- inreplyto="4A980E5ADF859E4E9007AA5514CF9C8E19AA8AFF_at_MBX2010-E01.ad.fz-juelich.de" -->
<!-- expires="-1" -->
<map id="navbar" name="navbar">
<ul class="links">
<li>
<dfn>This message</dfn>:
[ <a href="#start5739" name="options1" id="options1" tabindex="1">Message body</a> ]
 [ More options (<a href="#options2">top</a>, <a href="#options3">bottom</a>) ]
</li>
<li>
<dfn>Related messages</dfn>:
<!-- unext="start" -->
[ <a href="./5740.html" accesskey="d" title="Charlie Zender: &quot;[CF-metadata] Are ensembles a compelling use case for &#0034;group-aware&#0034; metadata?&quot;">Next message</a> ]
[ <a href="./5738.html" title="Fuchs Petra: &quot;[CF-metadata] CF checker as script&quot;">Previous message</a> ]
[ <a href="./5730.html" title="Schultz, Martin: &quot;[CF-metadata] Are ensembles a compelling use case for &#0034;group-aware&#0034; metadata? (CZ)&quot;">In reply to</a> ]
<!-- unextthread="start" -->
[ <a href="./5744.html" accesskey="t" title="Steve Hankin: &quot;[CF-metadata] Are ensembles a compelling use case for &#0034;group-aware&#0034; metadata? (CZ)&quot;">Next in thread</a> ]
 [ <a href="#replies">Replies</a> ]
<!-- ureply="end" -->
</li>
</ul>
</map>
<ul class="links">
<li><a name="options2" id="options2"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="index.html#msg5739" title="Contemporary messages by date">by date</a> ] [ <a href="thread.html#msg5739" title="Contemporary discussion threads">by thread</a> ] [ <a href="subject.html#msg5739" title="Contemporary messages by subject">by subject</a> ] [ <a href="author.html#msg5739" title="Contemporary messages by author">by author</a> ] [ <a href="attachment.html" title="Contemporary messages by attachment">by messages with attachments</a> ]</li>
</ul>
</div>
<!-- body="start" -->
<div class="mail">
<address class="headers">
<span id="from">
<dfn>From</dfn>: Charlie Zender &lt;<a href="mailto:zender?Subject=Re%3A%20%5BCF-metadata%5D%20Are%20ensembles%20a%20compelling%20use%20case%20for%20%22group-aware%22%20metadata%3F%20(CZ)">zender</a>&gt;
</span><br />
<span id="date"><dfn>Date</dfn>: Tue, 24 Sep 2013 21:45:40 -0700</span><br />
</address>
<br />
Hi Martin,
<br />
<br />Thank you for taking the time to address my 3 points about ensembles,
<br />
and for adding some new examples. Response interleaved...
<br />
<br /><em class="quotelev1">&gt; Le 19/09/2013 14:58, Schultz, Martin a ?crit :
</em><br />
<em class="quotelev1">&gt; Hi Charlie,
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; very good and extensive explanation of the potential use for groups
</em><br />
<em class="quotelev1">&gt; and group-aware metadata. Yet, I have a few remarks (which may in
</em><br />
<em class="quotelev1">&gt; part reveal that I should probably read the preamble of the CF
</em><br />
<em class="quotelev1">&gt; convention again ;-):
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev2">&gt;&gt; Point 1: How does the user know she has all the realizations?
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; Is this question best addressed with metadata in a (series of)
</em><br />
<em class="quotelev1">&gt; file(s)?
</em><br />
<br /><em class="quotelev1">&gt; In a modern, interoperable architecture, I would think that
</em><br />
<em class="quotelev1">&gt; this belongs into the realm of data discovery, which would be done
</em><br />
<em class="quotelev1">&gt; via web catalogues using metadata facets. File-based metadata IMHO
</em><br />
<em class="quotelev1">&gt; may be more prone to failure. Just imagine, ECMWF had first
</em><br />
<em class="quotelev1">&gt; generated two ensemble members, and their metadata would say so
</em><br />
<em class="quotelev1">&gt; (your &quot;page 2/2&quot; analogy). Now they run another two: do you really
</em><br />
<em class="quotelev1">&gt; expect the metadata from the old files to be updated? A web
</em><br />
<em class="quotelev1">&gt; catalogue would provide a more robust solution to this question, I
</em><br />
<em class="quotelev1">&gt; believe.
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; This doesn't mean that it may not be useful to have such information
</em><br />
<em class="quotelev1">&gt; in a file! However, to come back to the suitcases: this can only be
</em><br />
<em class="quotelev1">&gt; a packing list for the current trip and not an inventory of all the
</em><br />
<em class="quotelev1">&gt; socks you may possibly own. Of course your young aspiring researcher
</em><br />
<em class="quotelev1">&gt; may wish to express her knowledge about other ensemble members she
</em><br />
<em class="quotelev1">&gt; found on the web but didn't include in the file (the suitcase). But
</em><br />
<em class="quotelev1">&gt; will her supervisor or colleague on the other side of the world
</em><br />
<em class="quotelev1">&gt; understand what she is talking about? I think, if you intend to go
</em><br />
<em class="quotelev1">&gt; beyond the packing list, you open too many cans with too many
</em><br />
<em class="quotelev1">&gt; worms.
</em><br />
<br />Agreed, and not what I am suggesting. The ensemble use-case I posted
<br />
was designed to show an interesting use-case for which flat-file
<br />
solutions are currently lacking, where groups would help.
<br />
<br />As discussed in my response to Bryan Lawrence, I agree that adding
<br />
&quot;temporary&quot; or &quot;out-of-scope&quot; metadata to a dataset is unwise and
<br />
unmaintainable. If servers served hierarchical files then ensemble
<br />
sizes, for example, could be simply counted by counting groups.
<br />
Ensemble metadata, like weights, could be stored as group metadata
<br />
rather than within the realization dataset itself. This preserves the
<br />
boundary between internal and external. I have yet to hear a
<br />
flat-file-based method of accomplishing this that does not violate
<br />
the internal/external barrier.
<br />
<br />To get back to the researcher, if she has a collection of flat-files
<br />
on her local disk, obtained from a flawless discovery-server, then
<br />
she can still make a typos when analyzing the files on her disk.
<br />
Despite years of trying, the number of papers produced via analysis on
<br />
remote-files is near zero :) Bookkeeping with lots of files can be
<br />
error-prone. If we reduce the number of files by putting datasets in
<br />
suitcases, this type of mistake may be less likely.
<br />
<br /><em class="quotelev2">&gt;&gt; Point 2: Multiple and/or Non-numeric Ensemble axes
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; Here, you have a  valid point, although - again - I would not
</em><br />
<em class="quotelev1">&gt; connect this to knowing &quot; that she has all the models&quot;. Yet, within
</em><br />
<em class="quotelev1">&gt; the packed file (the suitcase) you want to know which hierarchy
</em><br />
<em class="quotelev1">&gt; model (packing order) was applied in order to be able to aggregate
</em><br />
<em class="quotelev1">&gt; things (for example by computing ensemble averages). See also my
</em><br />
<em class="quotelev1">&gt; use-case on aircraft data introduced below. Question: what happens
</em><br />
<em class="quotelev1">&gt; to this kind of information when the files are flattened and
</em><br />
<em class="quotelev1">&gt; re-packaged? It might well become meaningless, which would indicate
</em><br />
<em class="quotelev1">&gt; that these are &quot;temporary&quot; metadata, and thus probably out of scope
</em><br />
<em class="quotelev1">&gt; for CF. This actually reminds me a bit of my experiences with the
</em><br />
<em class="quotelev1">&gt; history attribute when I use ncks -A. This command will preserve the
</em><br />
<em class="quotelev1">&gt; history of one file, but discard the history of the other file,
</em><br />
<em class="quotelev1">&gt; which is certainly not the behavior you would like to see in
</em><br />
<em class="quotelev1">&gt; ungrouping/re-grouping software.
</em><br />
<br />First, we all agree on the necessity of being able to aggregate and
<br />
dismember hierarchical files without loss of information.
<br />
A new example in the NCO manual shows this is a solved problem:
<br />
<a href="http://nco.sf.net/nco.html#dismember">http://nco.sf.net/nco.html#dismember</a>
<br />
Perhaps this will assuage people. May this zombie not re-animate!
<br />
Dismembering into flat files a dataset aggregated from flat files
<br />
will not lose any information. And, if suitable conventions are
<br />
adopted, flat file products need not contain any new information.
<br />
<br />Which brings us to Martin's point: what does disaggregation do with
<br />
any &quot;external&quot; metadata? This is, by definition, metadata that was
<br />
never in the flat files. So I see no alternative answer to: the
<br />
disposal of &quot;external&quot; metadata must be determined by convention.
<br />
The options include deleting it forever/completely, or appending it
<br />
to the flat files.
<br />
<br />Finally, if you want ncks -A to save all the metadata from both files
<br />
somehow, e.g., in &quot;history_1&quot; and &quot;history_2&quot; attributes, or some
<br />
such, just post your suggestion to our help forum and we'll find a way
<br />
forward. Squeaky wheels...
<br />
<br /><em class="quotelev2">&gt;&gt; Point 3: Weights and intentional reproducibility of MME statistics
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; In my view this is actually just another viewing angle on your point #2.
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; --
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; Your use-case does however highlight the &quot;convenience&quot; of grouping
</em><br />
<em class="quotelev1">&gt; data which somehow belong to each other into one file. In a world of
</em><br />
<em class="quotelev1">&gt; flat files, one must check coordinates each time when you want to
</em><br />
<em class="quotelev1">&gt; perform some sort of (ensemble) averaging operation. A hierarchical
</em><br />
<em class="quotelev1">&gt; file will tell you that it is OK to average by placing the common
</em><br />
<em class="quotelev1">&gt; coordinates on the upper level. IMPORTANT: again, this doesn't mean
</em><br />
<em class="quotelev1">&gt; that this is the only or best way to do the grouping - yet, it seems
</em><br />
<em class="quotelev1">&gt; a compelling advantage to have this coordinate-consistency problem
</em><br />
<em class="quotelev1">&gt; eliminated somewhere along your processing steps. As others said
</em><br />
<em class="quotelev1">&gt; already: there are reasons for why people use suitcases.
</em><br />
<br />Yes, the power and convenience of this should not be overlooked. E.g.,
<br />
<br />ncks -d lat,-30.,30. cmip5.nc cmip5_tropics.nc
<br />
<br />obtains the tropical hyperslab of each model in cmip5.nc, despite
<br />
the likely heterogeneity of the underlying coordinate grids.
<br />
<br /><em class="quotelev1">&gt; Now, here is another use case, which we haven't implemented yet -
</em><br />
<em class="quotelev1">&gt; partly because we didn't see how it can be done in a CF consistent
</em><br />
<em class="quotelev1">&gt; way:
</em><br />
<em class="quotelev1">&gt; While there has been a definition of a standard file layout for data
</em><br />
<em class="quotelev1">&gt; from multiple stations (a contribution from Ben Domenico and Stefano
</em><br />
<em class="quotelev1">&gt; Nativi if I am not mistaken), this concept cannot be applied to
</em><br />
<em class="quotelev1">&gt; multiple aircraft flight data. The station data can be packaged
</em><br />
<em class="quotelev1">&gt; together with help of a non-geophysical &quot;station&quot; coordinate,
</em><br />
<em class="quotelev1">&gt; because all stations share the same time axis. With aircraft
</em><br />
<em class="quotelev1">&gt; flights, the time axes often don't overlap, and forcing all data
</em><br />
<em class="quotelev1">&gt; onto the superset of time would be a tremendous waste of
</em><br />
<em class="quotelev1">&gt; space. Groups would seem as  the natural solution to this problem!
</em><br />
<em class="quotelev1">&gt; Why not flat files? Because you might wish to retrieve all the
</em><br />
<em class="quotelev1">&gt; aircraft data which were sampled in a given region during a specific
</em><br />
<em class="quotelev1">&gt; period (a natural use case for a catalogue query it seems) in one
</em><br />
<em class="quotelev1">&gt; entity, and not in N entities, where you cannot even predict N.
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; I would think the same applies to &quot;granules&quot; of satellite data which
</em><br />
<em class="quotelev1">&gt; share a common calibration, for example.
</em><br />
<br />Indeed, archiving multiple satellite granules is a main reason NASA
<br />
uses groups.
<br />
<br /><em class="quotelev1">&gt; As Nan said, we should try to come back to define what is really at
</em><br />
<em class="quotelev1">&gt; stake for CF and what exactly shall be proposed. Now this is where
</em><br />
<em class="quotelev1">&gt; my failure to re-read the convention preamble may show ;-). The main
</em><br />
<em class="quotelev1">&gt; question is: is CF about files or about interoperability?
</em><br />
<br />Another rhetorical dichotomy: is CF about data providers or users?
<br />
There is both tension alignment between the two.
<br />
Just ask tech support :)
<br />
<br /><em class="quotelev1">&gt; Unfortunately, my view on this is not entirely clear, because it
</em><br />
<em class="quotelev1">&gt; seems to be a bit of both. The standard_names clearly have a bearing
</em><br />
<em class="quotelev1">&gt; in the interoperable world, and this shows through various links to
</em><br />
<em class="quotelev1">&gt; the CF standard_names in web catalogues or controlled vocabulary
</em><br />
<em class="quotelev1">&gt; collections (e.g. SeaDataNet). The conventions themselves seem to be
</em><br />
<em class="quotelev1">&gt; more file-oriented - even though the discussions about the data
</em><br />
<em class="quotelev1">&gt; model always make a strong point to go beyond representation in a
</em><br />
<em class="quotelev1">&gt; (single) file. [If someone disagrees and wishes to see the CF
</em><br />
<em class="quotelev1">&gt; convention play a more important role in interoperability, then I
</em><br />
<em class="quotelev1">&gt; would ask why it is not cast into an XML schema extending ISO19115
</em><br />
<em class="quotelev1">&gt; then. ] If CF is indeed &quot;file-oriented&quot;, then I do think that it
</em><br />
<em class="quotelev1">&gt; makes a lot of sense to support &quot;modern&quot; file structures, which
</em><br />
<em class="quotelev1">&gt; include groups and hierarchies, whether we like them or
</em><br />
<em class="quotelev1">&gt; not. Therefore, I would advocate that we focus the discussion on two
</em><br />
<em class="quotelev1">&gt; major points with a couple of sub-issues:
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; 1. which parts of CF might fail when we have a hierarchical file?
</em><br />
<em class="quotelev1">&gt; (and let's stick to the simple inheritance model of netcdf4 for
</em><br />
<em class="quotelev1">&gt; now!)
</em><br />
<em class="quotelev1">&gt; 1a. what would the current CF checker say if it is fed a
</em><br />
<em class="quotelev1">&gt; hierarchical file?
</em><br />
<br /><a href="http://puma.nerc.ac.uk/cgi-bin/cf-checker.pl">http://puma.nerc.ac.uk/cgi-bin/cf-checker.pl</a>
<br />
This compliance checker sometimes chokes on complex hierarcical files,
<br />
and sometimes (as far as I can tell) does a standard check of the
<br />
root group only.
<br />
<br /><em class="quotelev1">&gt; 1b. what happens to global attributes when flat files are grouped
</em><br />
<em class="quotelev1">&gt; together?
</em><br />
<em class="quotelev1">&gt; 1c. do we need to re-phrase some aspects of the convention to make
</em><br />
<em class="quotelev1">&gt; them &quot;group-aware&quot;? (this does not include defining new rules - that
</em><br />
<em class="quotelev1">&gt; is covered in point 2)
</em><br />
<em class="quotelev1">&gt; 1d. anything else?
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; 2. where do we need to extend the current CF concept?
</em><br />
<em class="quotelev1">&gt; 2a. introduction of a new attribute &quot;level&quot; (equate &quot;global&quot; with
</em><br />
<em class="quotelev1">&gt; &quot;root&quot;? What happens when hierarchical files are flattened? [please
</em><br />
<em class="quotelev1">&gt; see the 3 varieties of flattening operations mentioned in an earlier
</em><br />
<em class="quotelev1">&gt; post])
</em><br />
<em class="quotelev1">&gt; 2b. specification of &quot;ensemble_...&quot; attributes? &quot;ensemble_axis&quot; may
</em><br />
<em class="quotelev1">&gt; not be needed of these axes are defined on the group level (?)
</em><br />
<em class="quotelev1">&gt; Something like &quot;ensemble_history&quot; or &quot;ensemble_structure&quot; to inform
</em><br />
<em class="quotelev1">&gt; the user about the grouping principle?
</em><br />
<em class="quotelev1">&gt; 2c. what other &quot;relations&quot; need to be expressed within a
</em><br />
<em class="quotelev1">&gt; hierarchical file? The guiding principle here should be that
</em><br />
<em class="quotelev1">&gt; additional rules are only needed if they avoid ambiguity and
</em><br />
<em class="quotelev1">&gt; misinterpretation of the data. And here we get onto interoperability
</em><br />
<em class="quotelev1">&gt; territory again (see my use case about aircraft data above).
</em><br />
<br />Thank you for your suggestion of starting points.
<br />
If and when there is consensus on the desirability of including groups
<br />
and/or &quot;ensemble&quot; features into CF, numbers 1 and 2 above seem like
<br />
reasonable starting points. It is not my place to determine whether
<br />
there is a consensus, or how close we are, but it's clear to me there
<br />
is no consensus yet. Bryan Lawrence, Steve Hankin, Jonathan Gregory,
<br />
Karl Taylor, and Philip Cameron-Smith are not &quot;on board&quot;. I hope they
<br />
will speak-up and say if they concur that maintaining the status quo
<br />
(flat files) is best (period), or whether they do wish to extend CF to
<br />
hierarchies (starting now), or the additional information they would
<br />
need to decide.
<br />
<br /><em class="quotelev1">&gt; Sorry for this long post -- this just somehow seems to be quite relevant!
</em><br />
<br />I think you've hit many of the most pressing points.
<br />
Look forward to hearing whether this discussion has persuaded anyone
<br />
that reasons to include hierarchies in CF outweigh reasons not to.
<br />
<br />cz
<br />
<br /><em class="quotelev1">&gt; Best regards,
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; Martin
</em><br />
<br /><pre>
-- 
Charlie Zender, Earth System Sci. &amp; Computer Sci.
University of California, Irvine 949-891-2429 )'(
</pre>
<span id="received"><dfn>Received on</dfn> Tue Sep 24 2013 - 22:45:40 BST</span>
</div>
<!-- body="end" -->
<div class="foot">
<map id="navbarfoot" name="navbarfoot" title="Related messages">
<ul class="links">
<li><dfn>This message</dfn>: [ <a href="#start5739">Message body</a> ]</li>
<!-- lnext="start" -->
<li><dfn>Next message</dfn>: <a href="./5740.html" title="Next message in the list">Charlie Zender: "[CF-metadata] Are ensembles a compelling use case for &#0034;group-aware&#0034; metadata?"</a></li>
<li><dfn>Previous message</dfn>: <a href="./5738.html" title="Previous message in the list">Fuchs Petra: "[CF-metadata] CF checker as script"</a></li>
<li><dfn>In reply to</dfn>: <a href="./5730.html" title="Message to which this message replies">Schultz, Martin: "[CF-metadata] Are ensembles a compelling use case for &#0034;group-aware&#0034; metadata? (CZ)"</a></li>
<!-- lnextthread="start" -->
<li><dfn>Next in thread</dfn>: <a href="./5744.html" title="Next message in this discussion thread">Steve Hankin: "[CF-metadata] Are ensembles a compelling use case for &#0034;group-aware&#0034; metadata? (CZ)"</a></li>
<li><a name="replies" id="replies"></a>
<dfn>Reply</dfn>: <a href="./5744.html" title="Message sent in reply to this message">Steve Hankin: "[CF-metadata] Are ensembles a compelling use case for &#0034;group-aware&#0034; metadata? (CZ)"</a></li>
<!-- lreply="end" -->
</ul>
<ul class="links">
<li><a name="options3" id="options3"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="index.html#msg5739" title="Contemporary messages by date">by date</a> ] [ <a href="thread.html#msg5739" title="Contemporary discussion threads">by thread</a> ] [ <a href="subject.html#msg5739" title="Contemporary messages by subject">by subject</a> ] [ <a href="author.html#msg5739" title="Contemporary messages by author">by author</a> ] [ <a href="attachment.html" title="Contemporary messages by attachment">by messages with attachments</a> ]</li>
</ul>
</map>
</div>
<!-- trailer="footer" -->
<p><small><em>
This archive was generated by <a href="http://www.hypermail-project.org/">hypermail 2.3.0</a>
: Wed Jul 27 2022 - 12:58:30 BST
</em></small></p>
</body>
<p><a style="text-decoration:none" href="./5738.html"><img src="./red-arrow-left.jpg" width="50" alt="&lArr;"></a> <a style="text-decoration:none" href="./5740.html"><img src="./red-arrow-right.jpg" width="50" alt="&rArr;"></a></html>
