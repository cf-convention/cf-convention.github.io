<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
<meta name="generator" content="hypermail 2.3.0, see http://www.hypermail-project.org/" />
<title>[CF-metadata] Feedback requested on proposed CF Simple Geometries from Jonathan Gregory on 2016-09-22 (cf-metadata-mailman)</title>
<meta name="Author" content="Jonathan Gregory (j.m.gregory)" />
<meta name="Subject" content="[CF-metadata] Feedback requested on proposed CF Simple Geometries" />
<meta name="Date" content="2016-09-22" />
<style type="text/css">
/*<![CDATA[*/
/* To be incorporated in the main stylesheet, don't code it in hypermail! */
body {color: black; background: #ffffff}
dfn {font-weight: bold;}
pre { background-color:inherit;}
.head { border-bottom:1px solid black;}
.foot { border-top:1px solid black;}
th {font-style:italic;}
table { margin-left:2em;}map ul {list-style:none;}
#mid { font-size:0.9em;}
#received { float:right;}
address { font-style:inherit ;}
/*]]>*/
.quotelev1 {color : #990099}
.quotelev2 {color : #ff7700}
.quotelev3 {color : #007799}
.quotelev4 {color : #95c500}
.period {font-weight: bold}
</style>
</head>
<body>
<div class="head">
<a style="text-decoration:none" href="./7779.html"><img src="./red-arrow-left.jpg" width="50" alt="&lArr;"></a> <a style="text-decoration:none" href="./7781.html"><img src="./red-arrow-right.jpg" width="50" alt="&rArr;"></a><h1>[CF-metadata] Feedback requested on proposed CF Simple Geometries</h1>
<!-- received="Thu Sep 22 04:40:07 2016" -->
<!-- isoreceived="20160922034007" -->
<!-- sent="Thu, 22 Sep 2016 11:40:07 +0100" -->
<!-- isosent="20160922104007" -->
<!-- name="Jonathan Gregory" -->
<!-- email="j.m.gregory" -->
<!-- subject="[CF-metadata] Feedback requested on proposed CF Simple Geometries" -->
<!-- id="20160922104007.GB3531_at_met.reading.ac.uk" -->
<!-- charset="US-ASCII" -->
<!-- inreplyto="20160922103941.GA3531_at_met.reading.ac.uk" -->
<!-- expires="-1" -->
<map id="navbar" name="navbar">
<ul class="links">
<li>
<dfn>This message</dfn>:
[ <a href="#start7780" name="options1" id="options1" tabindex="1">Message body</a> ]
 [ More options (<a href="#options2">top</a>, <a href="#options3">bottom</a>) ]
</li>
<li>
<dfn>Related messages</dfn>:
<!-- unext="start" -->
[ <a href="./7781.html" accesskey="d" title="Jonathan Gregory: &quot;[CF-metadata] Temporal nitpicks. Was: CF-metadata Digest, Vol 161, Issue 3&quot;">Next message</a> ]
[ <a href="./7779.html" title="Lowry, Roy K.: &quot;[CF-metadata] Temporal nitpicks. Was: CF-metadata Digest, Vol 161, Issue 3&quot;">Previous message</a> ]
<!-- unextthread="start" -->
[ <a href="./7782.html" accesskey="t" title="Arctur, David K: &quot;[CF-metadata] Feedback requested on proposed CF Simple	Geometries&quot;">Next in thread</a> ]
 [ <a href="#replies">Replies</a> ]
<!-- ureply="end" -->
</li>
</ul>
</map>
<ul class="links">
<li><a name="options2" id="options2"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="index.html#msg7780" title="Contemporary messages by date">by date</a> ] [ <a href="thread.html#msg7780" title="Contemporary discussion threads">by thread</a> ] [ <a href="subject.html#msg7780" title="Contemporary messages by subject">by subject</a> ] [ <a href="author.html#msg7780" title="Contemporary messages by author">by author</a> ] [ <a href="attachment.html" title="Contemporary messages by attachment">by messages with attachments</a> ]</li>
</ul>
</div>
<!-- body="start" -->
<div class="mail">
<address class="headers">
<span id="from">
<dfn>From</dfn>: Jonathan Gregory &lt;<a href="mailto:j.m.gregory?Subject=Re%3A%20%5BCF-metadata%5D%20Feedback%20requested%20on%20proposed%20CF%20Simple%20Geometries">j.m.gregory</a>&gt;
</span><br />
<span id="date"><dfn>Date</dfn>: Thu, 22 Sep 2016 11:40:07 +0100</span><br />
</address>
<br />
Dear Ben
<br />
<br />Thank you for your thoughtful and interesting proposal. I have quite a lot of
<br />
questions and comments about it.
<br />
<br />* You explain that the need is to specify spatial coordinates with a simple
<br />
geometry for a timeSeries variable. For example, this could be for the
<br />
discharge as a function of time across some line in a river (your example), or
<br />
I suppose it could be an average temperature as a function of time for the
<br />
Atlantic Ocean, where you wanted to supply the polygon which drew the outline
<br />
of the basin. Have I got the idea? Timeseries like this can be stored in CF,
<br />
but their geographical extent is usually described only in words e.g. a region
<br />
name of atlantic_ocean, and this is fine for applications like CMIP where you
<br />
want to compare data from different data sources in which the Atlantic Ocean
<br />
may have different exact shapes (different AOGCMs, in particular). An array of
<br />
region names is also possible, so I don't think we need a new convention to
<br />
contain your dwarf planet example.
<br />
<br />* Sect 9.1 on discrete sampling geometries says it cannot yet be used for cases
<br />
&quot;where geo-positioning cannot be described as a discrete point location.
<br />
Problematic examples include time series that refer to a geographical region
<br />
(e.g. the northern hemisphere) ...&quot;. Actually I think that's not quite right.
<br />
The existing convention *can* describe regions which are contiguous, and
<br />
rectangular or polygonal, using its usual bounds convention (Sect 7.1). I think
<br />
we should consider changing this text, because it seems unnecessarily
<br />
restrictive. For example, a timeSeries for the average temperature in the
<br />
Northern Hemisphere can be stored like this:
<br />
<br />&nbsp;&nbsp;dimensions:
<br />
&nbsp;&nbsp;&nbsp;&nbsp;region=1;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;nv=2;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;time=UNLIMITED;
<br />
&nbsp;&nbsp;variables:
<br />
&nbsp;&nbsp;&nbsp;&nbsp;float temperature(region,time);
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temperature:standard_name=&quot;surface_temperature&quot;;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temperature:units=&quot;K&quot;;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temperature:coordinates=&quot;lat lon&quot;;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;temperature:cell_methods=&quot;time: mean area: mean&quot;;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;float lat(region);
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lat:standard_name=&quot;latitude&quot;;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lat:units=&quot;degrees_north&quot;;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lat:bounds=&quot;lat_bounds&quot;;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;float lat_bounds(region,nv);
<br />
&nbsp;&nbsp;&nbsp;&nbsp;float lon(region);
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lon:standard_name=&quot;longitude&quot;;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lon:units=&quot;degrees_east&quot;;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lon:bounds=&quot;lon_bounds&quot;;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;float lon_bounds(region,nv);
<br />
&nbsp;&nbsp;data:
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lat_bounds=0,90;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;lon_bounds=0,360;
<br />
<br />which means the region is 0-90N and 0-360E. If the regions were irregular
<br />
polygons in latitude and longitude, nv would be the number of vertices and the
<br />
lat and lon bounds would trace the outline of the polygon e.g. nv=3, lat=0,90,0
<br />
and lon=0,0,90 describes the eighth of the sphere which is bounded by the
<br />
meridians at 0E and 90E and the Equator. I think, therefore, we do not need an
<br />
additional convention for points or polygonal regions. However, we would need
<br />
new conventions for a timeseries where each value applies to a set of
<br />
discontiguous regions or regions with holes in them, a set of points, a line or
<br />
a set of lines. I guess that these are included in the geometry types you list
<br />
(LineString, Multipoint, MultiLineString, and MultiPolygon). Do you have
<br />
definite use-cases for all of these?  (I ask this because we don't add new
<br />
functionality to CF until there is a definite and common need for it in
<br />
practice.)
<br />
<br />* I suspect that geometries of this kind can be described by the ugrid
<br />
convention <a href="http://ugrid-conventions.github.io/ugrid-conventions">http://ugrid-conventions.github.io/ugrid-conventions</a>, which is
<br />
compliant with CF. Their purpose is to describe a set of connected points,
<br />
edges or faces at which values are given, whereas in your case you'd give a
<br />
single value for the whole set, but the description of the geometry itself
<br />
might be similar. Have you had a look at whether ugrid could meet your needs?
<br />
If it almost does so, perhaps a better thing to do would be to propose
<br />
additions to ugrid. We would like to avoid having more than one way to describe
<br />
such geometries.
<br />
<br />If you decide to make use of ugrid instead, the rest of my comments may
<br />
not be relevant!
<br />
<br />* So far CF does not say anything about the use of netCDF-4 features (i.e. not
<br />
the classic model). We have often discussed allowing them but the general
<br />
argument is also made that there has to be a compelling case for providing a
<br />
new way to do something which can already be done. (Steve Hankin often made
<br />
this argument, but since he's mostly retired I'll make it now in his name :-)
<br />
If there are two ways to do something, software has to support both of them. We
<br />
already have ways to encode ragged arrays, so is there a compelling case for
<br />
needing the netCDF-4 vlen array as well? We already have a way to encode
<br />
strings too, as character arrays. I think this is probably a discussion we
<br />
should have again in a different thread, so I'll just talk about your classic
<br />
encoding. The same points apply to both encodings.
<br />
<br />* Your approach uses a coordinate_index variable to identify indices of
<br />
geometry coordinates e.g.
<br />
<br />&nbsp;&nbsp;dimensions:
<br />
&nbsp;&nbsp;&nbsp;&nbsp;indices = 30;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;node = 25 ;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;geom = 1 ;
<br />
&nbsp;&nbsp;variables:
<br />
&nbsp;&nbsp;&nbsp;&nbsp;int coordinate_index(indices) ;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;coordinate_index:coordinates = &quot;x y&quot; ;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;double x(node) ;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;double y(node) ;
<br />
&nbsp;&nbsp;data:
<br />
&nbsp;&nbsp;&nbsp;&nbsp;coordinate_index = 0, 1, 2, 3, 4, -2, 5, 6, 7, 8, -2, 9, 10, 11, 12, -2,
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;13, 14, 15, 16, -1, 17, 18, 19, 20, -1, 21, 22, 23, 24 ;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;x = 0, 20, 20, 0, 0, 1, 10, 19, 1, 5, 7, 9, 5, 11, 13, 15, 11, 5, 9, 7, 5,
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11, 15, 13, 11 ;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;y = 0, 0, 20, 20, 0, 1, 5, 1, 1, 15, 19, 15, 15, 15, 19, 15, 15, 25, 25,
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;29, 25, 25, 25, 29, 25 ;
<br />
<br />where the -1 and -2 indices indicates where exterior and interior polygons
<br />
begin, and the first polygon has an implied -1 at the start. Is that right?
<br />
Given this example, I wonder why you need the index array, because none of the
<br />
coordinates indices (values &gt;=0) is repeated, so no space is saved in the x
<br />
and y arrays. I guess this would be the usual case. If polygons did touch or
<br />
lines crossed, a few points would be in common, but not so many that seems to
<br />
need the complication of the index array. A simpler way to do it would be
<br />
<br />&nbsp;&nbsp;&nbsp;&nbsp;int outside_inside(node); // -1 for exterior, -2 for interior
<br />
&nbsp;&nbsp;&nbsp;&nbsp;double x(node) ;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;double y(node) ;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;outside_inside=-1,-1,-1,-1,-1, -2,-2,-2,-2, -2,-2,-2,-2,-2,
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-1,-1,-1,-1,-1, -1,-1,-1,-1,-1;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;x = 0, 20, 20, 0, 0, 1, 10, 19, 1, 5, 7, 9, 5, 11, 13, 15, 11, 5, 9, 7, 5,
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11, 15, 13, 11 ;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;y = 0, 0, 20, 20, 0, 1, 5, 1, 1, 15, 19, 15, 15, 15, 19, 15, 15, 25, 25,
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;29, 25, 25, 25, 29, 25 ;
<br />
<br />which needs only one dimension, or you could use the CF ragged array
<br />
convention (Sect 9.3.3):
<br />
<br />&nbsp;&nbsp;&nbsp;&nbsp;segment=5;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;node=25;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;int count(segment);
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;count:sample_dimension=&quot;node&quot;;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;int outside_inside(segment); // -1 for exterior, -2 for interior
<br />
&nbsp;&nbsp;&nbsp;&nbsp;double x(node) ;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;double y(node) ;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;outside_inside=-1,-2,-2,-1,-1;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;count=5,5,5,5,5;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;x = 0, 20, 20, 0, 0, 1, 10, 19, 1, 5, 7, 9, 5, 11, 13, 15, 11, 5, 9, 7, 5,
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11, 15, 13, 11 ;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;y = 0, 0, 20, 20, 0, 1, 5, 1, 1, 15, 19, 15, 15, 15, 19, 15, 15, 25, 25,
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;29, 25, 25, 25, 29, 25 ;
<br />
<br />* You provide the attributes multipart_break_value and hole_break_value to
<br />
specify the values (-1 and -2 above) for the outside vs inside distinction.  Do
<br />
you need the generality of being able to choose these values? It would seem
<br />
simpler to use a character array and specify in the convention which letters
<br />
should be used e.g.
<br />
<br />&nbsp;&nbsp;&nbsp;&nbsp;char outside_inside(segment)
<br />
&nbsp;&nbsp;&nbsp;&nbsp;outside_inside=&quot;OOIIO&quot;;
<br />
<br />That makes it more readable, perhaps.
<br />
<br />* Similarly, you propose attributes for clockwise/anticlockwise node order and
<br />
for the polygon closure convention.  Do these need to be freely choosable? You
<br />
could specify clockwise, like the existing CF bounds convention, and that the
<br />
polygons are closed. In the latter case, you could omit the last vertex of each
<br />
polygon since it must be the same as the first, and that would save a bit of
<br />
space. If you specify these choices, the attributes aren't needed.
<br />
<br />* If this convention is going to be used for discrete sampling geometries,
<br />
an additional dimension is needed, because in a single data variable you
<br />
might have data for several of these geometries. That is, you need an array
<br />
of ragged arrays. Again, I wonder whether this suggests trying to use ugrid.
<br />
It might be you could name each one as a mesh, and specify the geometry of
<br />
for the set of timeSeries as an array of mesh names. That would be a very
<br />
easy change to the existing Sect 9.
<br />
<br />Best wishes
<br />
<br />Jonathan
<br />
<span id="received"><dfn>Received on</dfn> Thu Sep 22 2016 - 04:40:07 BST</span>
</div>
<!-- body="end" -->
<div class="foot">
<map id="navbarfoot" name="navbarfoot" title="Related messages">
<ul class="links">
<li><dfn>This message</dfn>: [ <a href="#start7780">Message body</a> ]</li>
<!-- lnext="start" -->
<li><dfn>Next message</dfn>: <a href="./7781.html" title="Next message in the list">Jonathan Gregory: "[CF-metadata] Temporal nitpicks. Was: CF-metadata Digest, Vol 161, Issue 3"</a></li>
<li><dfn>Previous message</dfn>: <a href="./7779.html" title="Previous message in the list">Lowry, Roy K.: "[CF-metadata] Temporal nitpicks. Was: CF-metadata Digest, Vol 161, Issue 3"</a></li>
<!-- lnextthread="start" -->
<li><dfn>Next in thread</dfn>: <a href="./7782.html" title="Next message in this discussion thread">Arctur, David K: "[CF-metadata] Feedback requested on proposed CF Simple	Geometries"</a></li>
<li><a name="replies" id="replies"></a>
<dfn>Reply</dfn>: <a href="./7782.html" title="Message sent in reply to this message">Arctur, David K: "[CF-metadata] Feedback requested on proposed CF Simple	Geometries"</a></li>
<li><dfn>Reply</dfn>: <a href="./7784.html" title="Message sent in reply to this message">Chris Barker: "[CF-metadata] Feedback requested on proposed CF Simple Geometries"</a></li>
<!-- lreply="end" -->
</ul>
<ul class="links">
<li><a name="options3" id="options3"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="index.html#msg7780" title="Contemporary messages by date">by date</a> ] [ <a href="thread.html#msg7780" title="Contemporary discussion threads">by thread</a> ] [ <a href="subject.html#msg7780" title="Contemporary messages by subject">by subject</a> ] [ <a href="author.html#msg7780" title="Contemporary messages by author">by author</a> ] [ <a href="attachment.html" title="Contemporary messages by attachment">by messages with attachments</a> ]</li>
</ul>
</map>
</div>
<!-- trailer="footer" -->
<p><small><em>
This archive was generated by <a href="http://www.hypermail-project.org/">hypermail 2.3.0</a>
: Wed Jul 27 2022 - 12:59:06 BST
</em></small></p>
</body>
<p><a style="text-decoration:none" href="./7779.html"><img src="./red-arrow-left.jpg" width="50" alt="&lArr;"></a> <a style="text-decoration:none" href="./7781.html"><img src="./red-arrow-right.jpg" width="50" alt="&rArr;"></a></html>
