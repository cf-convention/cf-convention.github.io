<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
<meta name="generator" content="hypermail 2.3.0, see http://www.hypermail-project.org/" />
<title>[CF-metadata]  Usage of histogram_of_X_over_Z from Jonathan Gregory on 2016-10-14 (cf-metadata-mailman)</title>
<meta name="Author" content="Jonathan Gregory (j.m.gregory)" />
<meta name="Subject" content="[CF-metadata]  Usage of histogram_of_X_over_Z" />
<meta name="Date" content="2016-10-14" />
<style type="text/css">
/*<![CDATA[*/
/* To be incorporated in the main stylesheet, don't code it in hypermail! */
body {color: black; background: #ffffff}
dfn {font-weight: bold;}
pre { background-color:inherit;}
.head { border-bottom:1px solid black;}
.foot { border-top:1px solid black;}
th {font-style:italic;}
table { margin-left:2em;}map ul {list-style:none;}
#mid { font-size:0.9em;}
#received { float:right;}
address { font-style:inherit ;}
/*]]>*/
.quotelev1 {color : #990099}
.quotelev2 {color : #ff7700}
.quotelev3 {color : #007799}
.quotelev4 {color : #95c500}
.period {font-weight: bold}
</style>
</head>
<body>
<div class="head">
<a style="text-decoration:none" href="./7853.html"><img src="./red-arrow-left.jpg" width="50" alt="&lArr;"></a> <a style="text-decoration:none" href="./7855.html"><img src="./red-arrow-right.jpg" width="50" alt="&rArr;"></a><h1>[CF-metadata]  Usage of histogram_of_X_over_Z</h1>
<!-- received="Fri Oct 14 03:27:22 2016" -->
<!-- isoreceived="20161014022722" -->
<!-- sent="Fri, 14 Oct 2016 10:27:22 +0100" -->
<!-- isosent="20161014092722" -->
<!-- name="Jonathan Gregory" -->
<!-- email="j.m.gregory" -->
<!-- subject="[CF-metadata]  Usage of histogram_of_X_over_Z" -->
<!-- id="20161014092722.GA13395_at_met.reading.ac.uk" -->
<!-- charset="US-ASCII" -->
<!-- expires="-1" -->
<map id="navbar" name="navbar">
<ul class="links">
<li>
<dfn>This message</dfn>:
[ <a href="#start7854" name="options1" id="options1" tabindex="1">Message body</a> ]
 [ More options (<a href="#options2">top</a>, <a href="#options3">bottom</a>) ]
</li>
<li>
<dfn>Related messages</dfn>:
<!-- unext="start" -->
[ <a href="./7855.html" accesskey="d" title="martin.juckes at stfc.ac.uk: &quot;[CF-metadata] Metadata/standard names for variables involving thresholds (e.g. climate indices)&quot;">Next message</a> ]
[ <a href="./7853.html" title="Heiko Klein: &quot;[CF-metadata] Broken links to NUG in conventions document&quot;">Previous message</a> ]
<!-- unextthread="start" -->
<!-- ureply="end" -->
</li>
</ul>
</map>
<ul class="links">
<li><a name="options2" id="options2"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="index.html#msg7854" title="Contemporary messages by date">by date</a> ] [ <a href="thread.html#msg7854" title="Contemporary discussion threads">by thread</a> ] [ <a href="subject.html#msg7854" title="Contemporary messages by subject">by subject</a> ] [ <a href="author.html#msg7854" title="Contemporary messages by author">by author</a> ] [ <a href="attachment.html" title="Contemporary messages by attachment">by messages with attachments</a> ]</li>
</ul>
</div>
<!-- body="start" -->
<div class="mail">
<address class="headers">
<span id="from">
<dfn>From</dfn>: Jonathan Gregory &lt;<a href="mailto:j.m.gregory?Subject=Re%3A%20%5BCF-metadata%5D%20%20Usage%20of%20histogram_of_X_over_Z">j.m.gregory</a>&gt;
</span><br />
<span id="date"><dfn>Date</dfn>: Fri, 14 Oct 2016 10:27:22 +0100</span><br />
</address>
<br />
Dear Martin and Alejandro  (following off-list discussions)
<br />
<br /><em class="quotelev1">&gt; The CF definitions say ''&quot;histogram_of_X[_over_Z]&quot; means histogram (i.e. number of counts for each range of X) of variations (over Z) of X.'
</em><br />
<br />Yes, that's in the guidelines for construction of standard names, and there
<br />
are only two of them at present, as you say. The simplest case is when you
<br />
have some quantity Q depending on only one dimension, Q(Z). Then the histogram
<br />
H(Q) is the number of values of Q which fall into each interval of Q,
<br />
considering variation over Z.  In general there could be more than one
<br />
dimension retained, and more than one removed. If the original field was
<br />
Q(P,Y,Z,T), we might construct a histogram H(Q,Z,T), for instance, containing
<br />
the frequencies of values of Q falling into joint intervals of Q, Z and T, for
<br />
variation over P and Y. Following the guideline above, we would call this a
<br />
histogram of Q over P and Y, I think.
<br />
<br />It is not necessary to indicate in the standard name the dimensions which
<br />
the histogram depends on (Z and T in my example) because the coordinate
<br />
variables (of Z and T) make that clear. Martin suggests that by this argument
<br />
we could also omit Q from the standard name, and just call it a histogram
<br />
(or frequency distribution) rather than a histogram of Q, where Q is air
<br />
temperature, precipitation amount, backscattering ratio, etc. I think there
<br />
are two reasons why we include Q in the standard name,
<br />
<br />* I think a histogram of air temperature is not the same geophysical quantity
<br />
as a histogram of precipitation amount, for instance, so they should be
<br />
distinguished by standard name.
<br />
<br />* Although histograms are pure numbers, and so are probabilities, probability
<br />
densities are not. Histograms, probability distributions and probability
<br />
density functions are all related ways of expressing the same information.
<br />
In the guidelines, we foresee that we might need names for all of them (though
<br />
so far we have only histograms) and it would make sense to give them consistent
<br />
names. The probability density function of air temperature has units of K-1,
<br />
and of precipitation amount kg-1 m2, for instance. Because they have different
<br />
canonical units, they must have different standard names, so Q needs to be
<br />
included in the standard name.
<br />
<br />Cell methods describe how the values represent variation within the cells.
<br />
The transformation from the values of a quantity to a histogram of the
<br />
quantity makes the original quantity into a dimension. This seems more of
<br />
a radical transformation than computing a mean or a standard deviation, which
<br />
doesn't change the dimensions of the variable, but just reduces their size
<br />
(to unity if completely collapsed). A frequency distribution of Q is
<br />
regarded as a different geophysical quantity from Q itself, so we have not
<br />
used cell methods to describe the relationship. Of course, this is a bit
<br />
arbitrary (like everything else in the CF convention!).
<br />
<br />I agree with Martin that we could omit the &quot;over&quot; part of the standard name for
<br />
histograms, probabilities and probability densities. It is useful to retain the
<br />
collapsed dimensions as size-1 dimensions, so that their original range can
<br />
be recorded. They could be assigned cell_method of &quot;sum&quot;, the default for
<br />
extensive quantities, because the histogram applies to their entire range.
<br />
The same applies to the variable with has been histogrammed and is now a
<br />
dimension; the histogram is a sum for each of its cells.
<br />
<br />For example, in the 1D case, suppose the original field is air_temperature
<br />
as a function of time only. Then the histogram variable is
<br />
&nbsp;&nbsp;float hair(tair);
<br />
&nbsp;&nbsp;&nbsp;&nbsp;hair:standard_name=&quot;histogram_of_air_temperature&quot;;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;hair:units=&quot;1&quot;;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;hair:cell_methods=&quot;time: sum tair: sum&quot;;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;hair:coordinates=&quot;time&quot;;
<br />
&nbsp;&nbsp;float time; // scalar coordinate variable with bounds
<br />
&nbsp;&nbsp;float tair(tair);
<br />
&nbsp;&nbsp;&nbsp;&nbsp;tair:units=&quot;K&quot;;
<br />
<br />As a multidimensional example, suppose the original field is
<br />
&nbsp;&nbsp;float tair(time,altitude,latitude,longitude);
<br />
&nbsp;&nbsp;&nbsp;&nbsp;tair:units=&quot;K&quot;;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;tair:standard_name=&quot;air_temperature&quot;;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;tair:cell_methods=&quot;altitude: mean area: mean time: mean&quot;;
<br />
from which we might construct
<br />
&nbsp;&nbsp;float pair(tair,time,altitude);
<br />
&nbsp;&nbsp;&nbsp;&nbsp;pair:standard_name=&quot;probability_density_function_of_air_temperature&quot;;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;pair:units=&quot;K-1&quot;;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;pair:cell_methods=&quot;altitude: mean time: mean area: sum tair: mean&quot;;
<br />
&nbsp;&nbsp;&nbsp;&nbsp;pair:coordinates=&quot;latitude longitude&quot;; // to record the ranges
<br />
Here, I suggest that the cell_method for area is &quot;sum&quot;, because the PDF
<br />
applies to the whole area, which is an extensive quantity. For air temperature
<br />
it seems more sense to interpret a PDF as a mean within cells, since a PDF is
<br />
an intensive quantity - you can interpolate it, for example - but not a point
<br />
quantity if it's calculated from a histogram with finite bin-widths.
<br />
&nbsp;&nbsp;&nbsp;&nbsp;
<br />
Best wishes
<br />
<br />Jonathan
<br />
<br />----- Forwarded message from martin.juckes at stfc.ac.uk -----
<br />
<br /><em class="quotelev1">&gt; Date: Wed, 12 Oct 2016 18:05:06 +0000
</em><br />
<em class="quotelev1">&gt; From: martin.juckes at stfc.ac.uk
</em><br />
<em class="quotelev1">&gt; To: cf-metadata at cgd.ucar.edu
</em><br />
<em class="quotelev1">&gt; Subject: [CF-metadata] Usage of histogram_of_X_over_Z
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; Hello,
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; There are two standard names of the form histogram_of_..... in the CF Standard Name list (at version 36): histogram_of_backscattering_ratio_over_height_above_reference_ellipsoid and histogram_of_equivalent_reflectivity_factor_over_height_above_reference_ellipsoid. Both of these where used in CMIP5 and set to be used in CMIP6, but the usage does not appear to match the standard name desecriptions. 
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; The possible confusion is over the role of different coordinates. The CF definitions say ''&quot;histogram_of_X[_over_Z]&quot; means histogram (i.e. number of counts for each range of X) of variations (over Z) of X.' This implies to me that you start with a function of Z and possibly other coordinates and end up with a function of X and the other coordinates. E.g. if the source data is X(lat,lon,Z), then the histogram data will be of the form frequency(lat,lon,X).
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; In the two CMIP5/CMIP6 draft variables (cfadLidarsr532, cfadDbze94) using these standard names the &quot;Z&quot; coordinate  which is included in the standard name (&quot;height_above_reference_ellipsoid&quot;) is one of the coordinates of the histogram data variable. Both these variables appear to be joint distributions (frequency of X and Y values) over sub-grid variability as a function of latitude, longitude and time. 
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; I've been reviewing these existing definitions in some detail because there are some new distribution variables in the request and I'd like to make sure that we have a consistent approach. 
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; If we need to described a variable which carries a joint distribution of X and Y, then the variable will have to use X and Y as coordinates, so perhaps we can simplify the process by leaving them out of the standard name. Similarly the &quot;over_Z&quot; part of the name would be better expressed as a cell_methods construct. This line of reasoning suggests using a new standard name such as &quot;frequency_distribution&quot; (units &quot;1&quot;). The only difficulty is that the frequency distribution might be a function of the quantities X and Y (scattering ratio and cloud top height for cfadLidarsr532) and also of latitude, longitude and time. There should be some way of distinguishing the different roles of these 5 coordinates: is is the distribution of X and Y as a function of latitude, longitude and time. I think this could be done conveniently by introducing a single new attribute, e.g. &quot;bin_coords: X Y&quot;.
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; &quot;frequency_distribution&quot; could be used for single or joint distributions.
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; My questions to the list are:
</em><br />
<em class="quotelev1">&gt; (1) am I missing something in my interpretation of the existing histogram_of_... names?
</em><br />
<em class="quotelev1">&gt; (2) if not, is the adoption of a &quot;frequency_distribution&quot; standard name an appropriate way forward?
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; regards,
</em><br />
<em class="quotelev1">&gt; Martin
</em><br />
<em class="quotelev1">&gt; 
</em><br />
<em class="quotelev1">&gt; regards,
</em><br />
<em class="quotelev1">&gt; Martin
</em><br />
<em class="quotelev1">&gt; _______________________________________________
</em><br />
<em class="quotelev1">&gt; CF-metadata mailing list
</em><br />
<em class="quotelev1">&gt; CF-metadata at cgd.ucar.edu
</em><br />
<em class="quotelev1">&gt; <a href="http://mailman.cgd.ucar.edu/mailman/listinfo/cf-metadata">http://mailman.cgd.ucar.edu/mailman/listinfo/cf-metadata</a>
</em><br />
<br />----- End forwarded message -----
<br />
<span id="received"><dfn>Received on</dfn> Fri Oct 14 2016 - 03:27:22 BST</span>
</div>
<!-- body="end" -->
<div class="foot">
<map id="navbarfoot" name="navbarfoot" title="Related messages">
<ul class="links">
<li><dfn>This message</dfn>: [ <a href="#start7854">Message body</a> ]</li>
<!-- lnext="start" -->
<li><dfn>Next message</dfn>: <a href="./7855.html" title="Next message in the list">martin.juckes at stfc.ac.uk: "[CF-metadata] Metadata/standard names for variables involving thresholds (e.g. climate indices)"</a></li>
<li><dfn>Previous message</dfn>: <a href="./7853.html" title="Previous message in the list">Heiko Klein: "[CF-metadata] Broken links to NUG in conventions document"</a></li>
<!-- lnextthread="start" -->
<!-- lreply="end" -->
</ul>
<ul class="links">
<li><a name="options3" id="options3"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="index.html#msg7854" title="Contemporary messages by date">by date</a> ] [ <a href="thread.html#msg7854" title="Contemporary discussion threads">by thread</a> ] [ <a href="subject.html#msg7854" title="Contemporary messages by subject">by subject</a> ] [ <a href="author.html#msg7854" title="Contemporary messages by author">by author</a> ] [ <a href="attachment.html" title="Contemporary messages by attachment">by messages with attachments</a> ]</li>
</ul>
</map>
</div>
<!-- trailer="footer" -->
<p><small><em>
This archive was generated by <a href="http://www.hypermail-project.org/">hypermail 2.3.0</a>
: Wed Jul 27 2022 - 12:59:07 BST
</em></small></p>
</body>
<p><a style="text-decoration:none" href="./7853.html"><img src="./red-arrow-left.jpg" width="50" alt="&lArr;"></a> <a style="text-decoration:none" href="./7855.html"><img src="./red-arrow-right.jpg" width="50" alt="&rArr;"></a></html>
