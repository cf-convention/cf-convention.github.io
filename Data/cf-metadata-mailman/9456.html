<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
<meta name="generator" content="hypermail 2.3.0, see http://www.hypermail-project.org/" />
<title>[CF-metadata] Using units with a scale factor from Taylor, Karl E. on 2018-11-01 (cf-metadata-mailman)</title>
<meta name="Author" content="Taylor, Karl E. (taylor13)" />
<meta name="Subject" content="[CF-metadata] Using units with a scale factor" />
<meta name="Date" content="2018-11-01" />
<style type="text/css">
/*<![CDATA[*/
/* To be incorporated in the main stylesheet, don't code it in hypermail! */
body {color: black; background: #ffffff}
dfn {font-weight: bold;}
pre { background-color:inherit;}
.head { border-bottom:1px solid black;}
.foot { border-top:1px solid black;}
th {font-style:italic;}
table { margin-left:2em;}map ul {list-style:none;}
#mid { font-size:0.9em;}
#received { float:right;}
address { font-style:inherit ;}
/*]]>*/
.quotelev1 {color : #990099}
.quotelev2 {color : #ff7700}
.quotelev3 {color : #007799}
.quotelev4 {color : #95c500}
.period {font-weight: bold}
</style>
</head>
<body>
<div class="head">
<a style="text-decoration:none" href="./9455.html"><img src="./red-arrow-left.jpg" width="50" alt="&lArr;"></a> <a style="text-decoration:none" href="./9457.html"><img src="./red-arrow-right.jpg" width="50" alt="&rArr;"></a><h1>[CF-metadata] Using units with a scale factor</h1>
<!-- received="Thu Nov  1 10:58:08 2018" -->
<!-- isoreceived="20181101105808" -->
<!-- sent="Thu, 1 Nov 2018 16:58:08 +0000" -->
<!-- isosent="20181101165808" -->
<!-- name="Taylor, Karl E." -->
<!-- email="taylor13" -->
<!-- subject="[CF-metadata] Using units with a scale factor" -->
<!-- id="ae30a804-09f4-ec3b-8cf1-9848586529bb_at_llnl.gov" -->
<!-- charset="US-ASCII" -->
<!-- inreplyto="dddbabf57d324724878c43bcbfdcc069_at_stfc.ac.uk" -->
<!-- expires="-1" -->
<map id="navbar" name="navbar">
<ul class="links">
<li>
<dfn>This message</dfn>:
[ <a href="#start9456" name="options1" id="options1" tabindex="1">Message body</a> ]
 [ More options (<a href="#options2">top</a>, <a href="#options3">bottom</a>) ]
</li>
<li>
<dfn>Related messages</dfn>:
<!-- unext="start" -->
[ <a href="./9457.html" accesskey="d" title="Dave Allured - NOAA Affiliate: &quot;[CF-metadata] Using units with a scale factor&quot;">Next message</a> ]
[ <a href="./9455.html" title="Martin Juckes - UKRI STFC: &quot;[CF-metadata] [CF-metadar ata] [EXTERNAL] &#0039;months since&#0039; and &#0039;years since&#0039; time units&quot;">Previous message</a> ]
[ <a href="./9452.html" title="Martin Juckes - UKRI STFC: &quot;[CF-metadata] Using units with a scale factor&quot;">In reply to</a> ]
<!-- unextthread="start" -->
[ <a href="./9457.html" accesskey="t" title="Dave Allured - NOAA Affiliate: &quot;[CF-metadata] Using units with a scale factor&quot;">Next in thread</a> ]
 [ <a href="#replies">Replies</a> ]
<!-- ureply="end" -->
</li>
</ul>
</map>
<ul class="links">
<li><a name="options2" id="options2"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="index.html#msg9456" title="Contemporary messages by date">by date</a> ] [ <a href="thread.html#msg9456" title="Contemporary discussion threads">by thread</a> ] [ <a href="subject.html#msg9456" title="Contemporary messages by subject">by subject</a> ] [ <a href="author.html#msg9456" title="Contemporary messages by author">by author</a> ] [ <a href="attachment.html" title="Contemporary messages by attachment">by messages with attachments</a> ]</li>
</ul>
</div>
<!-- body="start" -->
<div class="mail">
<address class="headers">
<span id="from">
<dfn>From</dfn>: Taylor, Karl E. &lt;<a href="mailto:taylor13?Subject=Re%3A%20%5BCF-metadata%5D%20Using%20units%20with%20a%20scale%20factor">taylor13</a>&gt;
</span><br />
<span id="date"><dfn>Date</dfn>: Thu, 1 Nov 2018 16:58:08 +0000</span><br />
</address>
<br />
Hi Martin,
<br />
<br />I think the main point of the relevant paragraph in section 3.1, which reads
<br />
<br />&quot;The Udunits syntax that allows scale factors and offsets to be applied to a unit is not supported by this standard. The application of any scale factors or offsets to data should be indicated by the scale_factor and add_offset attributes. Use of these attributes for data packing, which is their most important application, is discussed in detail in Section 8.1, &quot;Packed Data&quot;&lt;<a href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.7/cf-conventions.html#packed-data">http://cfconventions.org/Data/cf-conventions/cf-conventions-1.7/cf-conventions.html#packed-data</a>&gt;.&quot;
<br />
<br />is that if you want to pack the data, the proper way to do that is through scale_factor and add_offset, not through the scale and offset options allowed by udunits in the units attribute. In general I find the &quot;scale_factor&quot; and &quot;add_offset&quot; attributes much easier to interpret than the scale and offset udunits options.    I would therefore:
<br />
<br />1) continue to forbid (or strongly discourage?) use of offset and scale in the units attribute (and modify the conformance document to be consistent with this).
<br />
<br />2)  replace the scaled units in the CMIP6 data request with units that might be less user friendly, but include equivalent prefix (e.g., replace  &quot;1e6 J&quot; with &quot;MJ&quot;)
<br />
<br />3)  replace in the standard names table all non-conforming units with conforming units.  I don't think the new units need to be identical to the old (e.g., I would replace &quot;1e-3 kg m-2&quot; with &quot;kg m-2&quot;, not &quot;g m-2&quot;).
<br />
<br />Regarding this last point, note that the so-called &quot;Canonical units&quot; in the standard names table are there to provide guidance on what the quantity represents (e.g., W m-2 indicates the quantity is a flux density, not a flux).  CF does not recommend a particular unit among all equivalent (e.g., &quot;kg&quot; might appear in the canonical units, but &quot;g&quot; would be just as acceptable).
<br />
<br />Do others have opinions about this?
<br />
<br />best regards,
<br />
Karl
<br />
<br /><br />On 10/29/18 7:45 AM, Martin Juckes - UKRI STFC wrote:
<br />
<br />Hello Karl, Alison,
<br />
<br /><br />As part of a separate discussion on 'months since' and 'years since' in time units&lt;<a href="http://mailman.cgd.ucar.edu/pipermail/cf-metadata/2018/020648.html">http://mailman.cgd.ucar.edu/pipermail/cf-metadata/2018/020648.html</a>&gt;&lt;<a href="http://mailman.cgd.ucar.edu/pipermail/cf-metadata/2018/020648.html">http://mailman.cgd.ucar.edu/pipermail/cf-metadata/2018/020648.html</a>&gt;, Klaus pointed out the use of numerical scale factors in units strings, although allowed by Udunits, is prohibited by the CF convention in section 3.1. I'm raising this here because there are 3 standard names which make use of such scale factors in their canonical units, and a number of CMIP6 variables. The CF conformance document diverges from the standard and allows any string which is accepted by Udunits, and hence accepts such factors. The CF checker implements the version according to the conformance document, as does the cf-python code (and hence checks on the CMIP6 variables using cf-python didn't detect this problem).
<br />
<br /><br />The CF standard names are:
<br />
<br />integral_wrt_depth_of_product_of_sea_water_density_and_salinity  : 1e-3 kg m-2
<br />
<br />ocean_salt_x_transport, ocean_salt_y_transport: 1e-3 kg s-1
<br />
<br /><br />In the CMIP6 data request, we have:
<br />
<br />1.e6 J m-1 s-1 for atmospheric energy transport (intuadse, intvadse);
<br />
<br />1e-3 kg m-2 for integral wrt depth of density and salinity (somint);
<br />
<br />1e-6 m s-1 for saturated hydraulic conductivity;
<br />
<br />1e3 km3 for sea ice volumes (sivoln, sivols);
<br />
<br />1e6 km2 for sea ice areas (siarean, siareas, siextentn, siextents);
<br />
<br /><br />Should we stick to the statement in the standards document ... and bring the conformance document etc into line, or could the standards document be interpreted more loosely?
<br />
<br /><br />These scale factors could be replaced by prefixes, but I think there is some loss of legibility in some cases:
<br />
<br />1e-3 kg --&gt; g
<br />
<br />1e6 J --&gt; MJ
<br />
<br />1e-6 m --&gt; um
<br />
<br />1e3 km3 --&gt; hm3
<br />
<br />1e6 km2 --&gt; Mm2
<br />
<br /><br />(here &quot;um&quot; is a micrometer, &quot;hm&quot; a hectometer and &quot;Mm&quot; a megameter).
<br />
<br /><br />regards,
<br />
<br />Martin
<br />
<br /><br />_______________________________________________
<br />
CF-metadata mailing list
<br />
CF-metadata at cgd.ucar.edu&lt;mailto:CF-metadata at cgd.ucar.edu&gt;
<br />
<a href="http://mailman.cgd.ucar.edu/mailman/listinfo/cf-metadata">http://mailman.cgd.ucar.edu/mailman/listinfo/cf-metadata</a>
<br />
<br /><br />-------------- next part --------------
<br />
An HTML attachment was scrubbed...
<br />
URL: &lt;<a href="http://mailman.cgd.ucar.edu/pipermail/cf-metadata/attachments/20181101/7eccb26d/attachment.html">http://mailman.cgd.ucar.edu/pipermail/cf-metadata/attachments/20181101/7eccb26d/attachment.html</a>&gt;
<br />
<span id="received"><dfn>Received on</dfn> Thu Nov 01 2018 - 10:58:08 GMT</span>
</div>
<!-- body="end" -->
<div class="foot">
<map id="navbarfoot" name="navbarfoot" title="Related messages">
<ul class="links">
<li><dfn>This message</dfn>: [ <a href="#start9456">Message body</a> ]</li>
<!-- lnext="start" -->
<li><dfn>Next message</dfn>: <a href="./9457.html" title="Next message in the list">Dave Allured - NOAA Affiliate: "[CF-metadata] Using units with a scale factor"</a></li>
<li><dfn>Previous message</dfn>: <a href="./9455.html" title="Previous message in the list">Martin Juckes - UKRI STFC: "[CF-metadata] [CF-metadar ata] [EXTERNAL] &#0039;months since&#0039; and &#0039;years since&#0039; time units"</a></li>
<li><dfn>In reply to</dfn>: <a href="./9452.html" title="Message to which this message replies">Martin Juckes - UKRI STFC: "[CF-metadata] Using units with a scale factor"</a></li>
<!-- lnextthread="start" -->
<li><dfn>Next in thread</dfn>: <a href="./9457.html" title="Next message in this discussion thread">Dave Allured - NOAA Affiliate: "[CF-metadata] Using units with a scale factor"</a></li>
<li><a name="replies" id="replies"></a>
<dfn>Reply</dfn>: <a href="./9457.html" title="Message sent in reply to this message">Dave Allured - NOAA Affiliate: "[CF-metadata] Using units with a scale factor"</a></li>
<!-- lreply="end" -->
</ul>
<ul class="links">
<li><a name="options3" id="options3"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="index.html#msg9456" title="Contemporary messages by date">by date</a> ] [ <a href="thread.html#msg9456" title="Contemporary discussion threads">by thread</a> ] [ <a href="subject.html#msg9456" title="Contemporary messages by subject">by subject</a> ] [ <a href="author.html#msg9456" title="Contemporary messages by author">by author</a> ] [ <a href="attachment.html" title="Contemporary messages by attachment">by messages with attachments</a> ]</li>
</ul>
</map>
</div>
<!-- trailer="footer" -->
<p><small><em>
This archive was generated by <a href="http://www.hypermail-project.org/">hypermail 2.3.0</a>
: Wed Jul 27 2022 - 12:59:31 BST
</em></small></p>
</body>
<p><a style="text-decoration:none" href="./9455.html"><img src="./red-arrow-left.jpg" width="50" alt="&lArr;"></a> <a style="text-decoration:none" href="./9457.html"><img src="./red-arrow-right.jpg" width="50" alt="&rArr;"></a></html>
