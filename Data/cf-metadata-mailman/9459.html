<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
<meta name="generator" content="hypermail 2.3.0, see http://www.hypermail-project.org/" />
<title>[CF-metadata] Using units with a scale factor from Dave Allured - NOAA Affiliate on 2018-11-01 (cf-metadata-mailman)</title>
<meta name="Author" content="Dave Allured - NOAA Affiliate (dave.allured)" />
<meta name="Subject" content="[CF-metadata] Using units with a scale factor" />
<meta name="Date" content="2018-11-01" />
<style type="text/css">
/*<![CDATA[*/
/* To be incorporated in the main stylesheet, don't code it in hypermail! */
body {color: black; background: #ffffff}
dfn {font-weight: bold;}
pre { background-color:inherit;}
.head { border-bottom:1px solid black;}
.foot { border-top:1px solid black;}
th {font-style:italic;}
table { margin-left:2em;}map ul {list-style:none;}
#mid { font-size:0.9em;}
#received { float:right;}
address { font-style:inherit ;}
/*]]>*/
.quotelev1 {color : #990099}
.quotelev2 {color : #ff7700}
.quotelev3 {color : #007799}
.quotelev4 {color : #95c500}
.period {font-weight: bold}
</style>
</head>
<body>
<div class="head">
<a style="text-decoration:none" href="./9458.html"><img src="./red-arrow-left.jpg" width="50" alt="&lArr;"></a> <a style="text-decoration:none" href="./9460.html"><img src="./red-arrow-right.jpg" width="50" alt="&rArr;"></a><h1>[CF-metadata] Using units with a scale factor</h1>
<!-- received="Thu Nov  1 14:43:39 2018" -->
<!-- isoreceived="20181101144339" -->
<!-- sent="Thu, 1 Nov 2018 14:43:39 -0600" -->
<!-- isosent="20181101204339" -->
<!-- name="Dave Allured - NOAA Affiliate" -->
<!-- email="dave.allured" -->
<!-- subject="[CF-metadata] Using units with a scale factor" -->
<!-- id="CALqwTFPtktUkOa57XAXbazg+xGEA4-vfmt697QP4_BSXA_yoxw_at_mail.gmail.com" -->
<!-- charset="US-ASCII" -->
<!-- inreplyto="78aa6089-6320-b3bc-fdcf-6d00622b671c_at_llnl.gov" -->
<!-- expires="-1" -->
<map id="navbar" name="navbar">
<ul class="links">
<li>
<dfn>This message</dfn>:
[ <a href="#start9459" name="options1" id="options1" tabindex="1">Message body</a> ]
 [ More options (<a href="#options2">top</a>, <a href="#options3">bottom</a>) ]
</li>
<li>
<dfn>Related messages</dfn>:
<!-- unext="start" -->
[ <a href="./9460.html" accesskey="d" title="Jim Biard: &quot;[CF-metadata] Looking for input on discussion of new calendars proposal&quot;">Next message</a> ]
[ <a href="./9458.html" title="Taylor, Karl E.: &quot;[CF-metadata] Using units with a scale factor&quot;">Previous message</a> ]
[ <a href="./9458.html" title="Taylor, Karl E.: &quot;[CF-metadata] Using units with a scale factor&quot;">In reply to</a> ]
<!-- unextthread="start" -->
[ <a href="./9461.html" accesskey="t" title="Martin Juckes - UKRI STFC: &quot;[CF-metadata] Using units with a scale factor&quot;">Next in thread</a> ]
 [ <a href="#replies">Replies</a> ]
<!-- ureply="end" -->
</li>
</ul>
</map>
<ul class="links">
<li><a name="options2" id="options2"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="index.html#msg9459" title="Contemporary messages by date">by date</a> ] [ <a href="thread.html#msg9459" title="Contemporary discussion threads">by thread</a> ] [ <a href="subject.html#msg9459" title="Contemporary messages by subject">by subject</a> ] [ <a href="author.html#msg9459" title="Contemporary messages by author">by author</a> ] [ <a href="attachment.html" title="Contemporary messages by attachment">by messages with attachments</a> ]</li>
</ul>
</div>
<!-- body="start" -->
<div class="mail">
<address class="headers">
<span id="from">
<dfn>From</dfn>: Dave Allured - NOAA Affiliate &lt;<a href="mailto:dave.allured?Subject=Re%3A%20%5BCF-metadata%5D%20Using%20units%20with%20a%20scale%20factor">dave.allured</a>&gt;
</span><br />
<span id="date"><dfn>Date</dfn>: Thu, 1 Nov 2018 14:43:39 -0600</span><br />
</address>
<br />
It sounds like consistency is more important than CF perfection in a
<br />
particular use case.  In that case, I suggest continuing use of CMIP6
<br />
prescribed unit strings for CMIP6 purposes only, and let the CMIP6
<br />
community know of this inconsistency with CF 3.1.  This will probably be
<br />
the least confusing for all concerned.  People and software that understand
<br />
UDUNITS will understand those scaled unit strings without help from CF.
<br />
<br />--Dave
<br />
<br /><br />On Thu, Nov 1, 2018 at 1:39 PM, Taylor, Karl E. &lt;taylor13 at llnl.gov&gt; wrote:
<br />
<br /><em class="quotelev1">&gt; Hi again,
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; I think some groups may have already written CMIP6 fields with  the
</em><br />
<em class="quotelev1">&gt; currently specified units that violate the CF standard, but I'd rather have
</em><br />
<em class="quotelev1">&gt; all CMIP6 datasets have comparable numeric values, so we shouldn't change
</em><br />
<em class="quotelev1">&gt; the units themselves, just the units attribute, as suggested originally.
</em><br />
<em class="quotelev1">&gt; This is possible, as Martin already indicated with one exception:
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; 1e3 km3 --&gt; hm3
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; I think this may be incorrect.  Wouldn't 1e3 km3 be interpreted as 1e3 (km)^3  If so, then
</em><br />
<em class="quotelev1">&gt; 1e3 km3 = (10 km)^3
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; and there is no prefix equivalent to &quot;10 km&quot;, so I think we're in a fix for this one variable.
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; Karl
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; On 11/1/18 11:03 AM, Dave Allured - NOAA Affiliate wrote:
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; Martin, thanks for a well stated summation of this problem.
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; My opinion is there are good reasons for prohibiting numeric scale and
</em><br />
<em class="quotelev1">&gt; offset in the units string, as indicated in section 3.1.  (Decimal prefixes
</em><br />
<em class="quotelev1">&gt; are fine, as always.)  Therefore I agree with Karl's #1 and #3, keep the
</em><br />
<em class="quotelev1">&gt; prohibition and do not change 3.1.
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; The CMIP6 data request itself is a problem because it actually violates CF
</em><br />
<em class="quotelev1">&gt; 3.1.  Best remedy would be to get CMIP6 authority to agree to alternate
</em><br />
<em class="quotelev1">&gt; units that do not use numeric scale factors.  I would modify Karl's #2 like
</em><br />
<em class="quotelev1">&gt; this:
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; 2)  Replace the scaled units in the CMIP6 data request with unscaled units
</em><br />
<em class="quotelev1">&gt; and equivalent decimal prefix (e.g., replace  &quot;1e6 J&quot; with &quot;MJ&quot;).  However,
</em><br />
<em class="quotelev1">&gt; if the result is deemed not user friendly in some way, then decide on some
</em><br />
<em class="quotelev1">&gt; user friendly unscaled units, e.g. &quot;J&quot;, and consumers will need to re-scale
</em><br />
<em class="quotelev1">&gt; data later, for some purposes.
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; Does anyone know why CMIP6 requested units in violation of CF 3.1?
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; --Dave
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; On Thu, Nov 1, 2018 at 10:58 AM, Taylor, Karl E. &lt;taylor13 at llnl.gov&gt;
</em><br />
<em class="quotelev1">&gt; wrote:
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev2">&gt;&gt; Hi Martin,
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; I think the main point of the relevant paragraph in section 3.1, which
</em><br />
<em class="quotelev2">&gt;&gt; reads
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; &quot;The Udunits syntax that allows scale factors and offsets to be applied
</em><br />
<em class="quotelev2">&gt;&gt; to a unit is not supported by this standard. The application of any scale
</em><br />
<em class="quotelev2">&gt;&gt; factors or offsets to data should be indicated by the *scale_factor* and
</em><br />
<em class="quotelev2">&gt;&gt; *add_offset* attributes. Use of these attributes for data packing, which
</em><br />
<em class="quotelev2">&gt;&gt; is their most important application, is discussed in detail in Section
</em><br />
<em class="quotelev2">&gt;&gt; 8.1, &quot;Packed Data&quot;
</em><br />
<em class="quotelev2">&gt;&gt; &lt;<a href="http://cfconventions.org/Data/cf-conventions/cf-conventions-1.7/cf-conventions.html#packed-data">http://cfconventions.org/Data/cf-conventions/cf-conventions-1.7/cf-conventions.html#packed-data</a>&gt;
</em><br />
<em class="quotelev2">&gt;&gt; .&quot;
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; is that if you want to pack the data, the proper way to do that is
</em><br />
<em class="quotelev2">&gt;&gt; through scale_factor and add_offset, not through the scale and offset
</em><br />
<em class="quotelev2">&gt;&gt; options allowed by udunits in the units attribute. In general I find the
</em><br />
<em class="quotelev2">&gt;&gt; &quot;scale_factor&quot; and &quot;add_offset&quot; attributes much easier to interpret than
</em><br />
<em class="quotelev2">&gt;&gt; the scale and offset udunits options.    I would therefore:
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; 1) continue to forbid (or strongly discourage?) use of offset and scale
</em><br />
<em class="quotelev2">&gt;&gt; in the units attribute (and modify the conformance document to be
</em><br />
<em class="quotelev2">&gt;&gt; consistent with this).
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; 2)  replace the scaled units in the CMIP6 data request with units that
</em><br />
<em class="quotelev2">&gt;&gt; might be less user friendly, but include equivalent prefix (e.g., replace
</em><br />
<em class="quotelev2">&gt;&gt; &quot;1e6 J&quot; with &quot;MJ&quot;)
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; 3)  replace in the standard names table all non-conforming units with
</em><br />
<em class="quotelev2">&gt;&gt; conforming units.  I don't think the new units need to be identical to the
</em><br />
<em class="quotelev2">&gt;&gt; old (e.g., I would replace &quot;1e-3 kg m-2&quot; with &quot;kg m-2&quot;, not &quot;g m-2&quot;).
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; Regarding this last point, note that the so-called &quot;Canonical units&quot; in
</em><br />
<em class="quotelev2">&gt;&gt; the standard names table are there to provide guidance on what the quantity
</em><br />
<em class="quotelev2">&gt;&gt; represents (e.g., W m-2 indicates the quantity is a flux density, not a
</em><br />
<em class="quotelev2">&gt;&gt; flux).  CF does not recommend a particular unit among all equivalent (e.g.,
</em><br />
<em class="quotelev2">&gt;&gt; &quot;kg&quot; might appear in the canonical units, but &quot;g&quot; would be just as
</em><br />
<em class="quotelev2">&gt;&gt; acceptable).
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; Do others have opinions about this?
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; best regards,
</em><br />
<em class="quotelev2">&gt;&gt; Karl
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; On 10/29/18 7:45 AM, Martin Juckes - UKRI STFC wrote:
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; Hello Karl, Alison,
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; As part of a separate discussion on 'months since' and 'years since' in time units&lt;<a href="http://mailman.cgd.ucar.edu/pipermail/cf-metadata/2018/020648.html">http://mailman.cgd.ucar.edu/pipermail/cf-metadata/2018/020648.html</a>&gt; &lt;<a href="http://mailman.cgd.ucar.edu/pipermail/cf-metadata/2018/020648.html">http://mailman.cgd.ucar.edu/pipermail/cf-metadata/2018/020648.html</a>&gt;, Klaus pointed out the use of numerical scale factors in units strings, although allowed by Udunits, is prohibited by the CF convention in section 3.1. I'm raising this here because there are 3 standard names which make use of such scale factors in their canonical units, and a number of CMIP6 variables. The CF conformance document diverges from the standard and allows any string which is accepted by Udunits, and hence accepts such factors. The CF checker implements the version according to the conformance document, as does the cf-python code (and hence checks on the CMIP6 variables using cf-python didn't detect this problem).
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; The CF standard names are:
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; integral_wrt_depth_of_product_of_sea_water_density_and_salinity  : 1e-3 kg m-2
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; ocean_salt_x_transport, ocean_salt_y_transport: 1e-3 kg s-1
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; In the CMIP6 data request, we have:
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; 1.e6 J m-1 s-1 for atmospheric energy transport (intuadse, intvadse);
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; 1e-3 kg m-2 for integral wrt depth of density and salinity (somint);
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; 1e-6 m s-1 for saturated hydraulic conductivity;
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; 1e3 km3 for sea ice volumes (sivoln, sivols);
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; 1e6 km2 for sea ice areas (siarean, siareas, siextentn, siextents);
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; Should we stick to the statement in the standards document ... and bring the conformance document etc into line, or could the standards document be interpreted more loosely?
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; These scale factors could be replaced by prefixes, but I think there is some loss of legibility in some cases:
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; 1e-3 kg --&gt; g
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; 1e6 J --&gt; MJ
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; 1e-6 m --&gt; um
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; 1e3 km3 --&gt; hm3
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; 1e6 km2 --&gt; Mm2
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; (here &quot;um&quot; is a micrometer, &quot;hm&quot; a hectometer and &quot;Mm&quot; a megameter).
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; regards,
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt; Martin
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
<em class="quotelev2">&gt;&gt;
</em><br />
-------------- next part --------------
<br />
An HTML attachment was scrubbed...
<br />
URL: &lt;<a href="http://mailman.cgd.ucar.edu/pipermail/cf-metadata/attachments/20181101/456e3c81/attachment-0001.html">http://mailman.cgd.ucar.edu/pipermail/cf-metadata/attachments/20181101/456e3c81/attachment-0001.html</a>&gt;
<br />
<span id="received"><dfn>Received on</dfn> Thu Nov 01 2018 - 14:43:39 GMT</span>
</div>
<!-- body="end" -->
<div class="foot">
<map id="navbarfoot" name="navbarfoot" title="Related messages">
<ul class="links">
<li><dfn>This message</dfn>: [ <a href="#start9459">Message body</a> ]</li>
<!-- lnext="start" -->
<li><dfn>Next message</dfn>: <a href="./9460.html" title="Next message in the list">Jim Biard: "[CF-metadata] Looking for input on discussion of new calendars proposal"</a></li>
<li><dfn>Previous message</dfn>: <a href="./9458.html" title="Previous message in the list">Taylor, Karl E.: "[CF-metadata] Using units with a scale factor"</a></li>
<li><dfn>In reply to</dfn>: <a href="./9458.html" title="Message to which this message replies">Taylor, Karl E.: "[CF-metadata] Using units with a scale factor"</a></li>
<!-- lnextthread="start" -->
<li><dfn>Next in thread</dfn>: <a href="./9461.html" title="Next message in this discussion thread">Martin Juckes - UKRI STFC: "[CF-metadata] Using units with a scale factor"</a></li>
<li><a name="replies" id="replies"></a>
<dfn>Reply</dfn>: <a href="./9461.html" title="Message sent in reply to this message">Martin Juckes - UKRI STFC: "[CF-metadata] Using units with a scale factor"</a></li>
<!-- lreply="end" -->
</ul>
<ul class="links">
<li><a name="options3" id="options3"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="index.html#msg9459" title="Contemporary messages by date">by date</a> ] [ <a href="thread.html#msg9459" title="Contemporary discussion threads">by thread</a> ] [ <a href="subject.html#msg9459" title="Contemporary messages by subject">by subject</a> ] [ <a href="author.html#msg9459" title="Contemporary messages by author">by author</a> ] [ <a href="attachment.html" title="Contemporary messages by attachment">by messages with attachments</a> ]</li>
</ul>
</map>
</div>
<!-- trailer="footer" -->
<p><small><em>
This archive was generated by <a href="http://www.hypermail-project.org/">hypermail 2.3.0</a>
: Wed Jul 27 2022 - 12:59:31 BST
</em></small></p>
</body>
<p><a style="text-decoration:none" href="./9458.html"><img src="./red-arrow-left.jpg" width="50" alt="&lArr;"></a> <a style="text-decoration:none" href="./9460.html"><img src="./red-arrow-right.jpg" width="50" alt="&rArr;"></a></html>
