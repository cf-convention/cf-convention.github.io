<?xml version="1.0" encoding="Windows-1252"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1252" />
<meta name="generator" content="hypermail 2.3.0, see http://www.hypermail-project.org/" />
<title>[CF-metadata] same attribute name in variable and in global from Bärring Lars on 2019-03-27 (cf-metadata-mailman)</title>
<meta name="Author" content="Bärring Lars (Lars.Barring)" />
<meta name="Subject" content="[CF-metadata] same attribute name in variable and in global" />
<meta name="Date" content="2019-03-27" />
<style type="text/css">
/*<![CDATA[*/
/* To be incorporated in the main stylesheet, don't code it in hypermail! */
body {color: black; background: #ffffff}
dfn {font-weight: bold;}
pre { background-color:inherit;}
.head { border-bottom:1px solid black;}
.foot { border-top:1px solid black;}
th {font-style:italic;}
table { margin-left:2em;}map ul {list-style:none;}
#mid { font-size:0.9em;}
#received { float:right;}
address { font-style:inherit ;}
/*]]>*/
.quotelev1 {color : #990099}
.quotelev2 {color : #ff7700}
.quotelev3 {color : #007799}
.quotelev4 {color : #95c500}
.period {font-weight: bold}
</style>
</head>
<body>
<div class="head">
<a style="text-decoration:none" href="./9632.html"><img src="./red-arrow-left.jpg" width="50" alt="&lArr;"></a> <a style="text-decoration:none" href="./9634.html"><img src="./red-arrow-right.jpg" width="50" alt="&rArr;"></a><h1>[CF-metadata] same attribute name in variable and in global</h1>
<!-- received="Wed Mar 27 14:10:18 2019" -->
<!-- isoreceived="20190327141018" -->
<!-- sent="Wed, 27 Mar 2019 20:10:18 +0000" -->
<!-- isosent="20190327201018" -->
<!-- name="Bärring Lars" -->
<!-- email="Lars.Barring" -->
<!-- subject="[CF-metadata] same attribute name in variable and in global" -->
<!-- id="02047865DE893F45802A039AA761834E01A1CAA673_at_WINVMSERV463.ad.smhi.se" -->
<!-- charset="Windows-1252" -->
<!-- inreplyto="CAEMt9PMca_+gsW3P-m2fc+xtK4MhrPqHxNZHzY7ht7=+-irjgA_at_mail.gmail.com" -->
<!-- expires="-1" -->
<map id="navbar" name="navbar">
<ul class="links">
<li>
<dfn>This message</dfn>:
[ <a href="#start9633" name="options1" id="options1" tabindex="1">Message body</a> ]
 [ More options (<a href="#options2">top</a>, <a href="#options3">bottom</a>) ]
</li>
<li>
<dfn>Related messages</dfn>:
<!-- unext="start" -->
[ <a href="./9634.html" accesskey="d" title="Dan Say: &quot;[CF-metadata] New halocarbon standard name requests&quot;">Next message</a> ]
[ <a href="./9632.html" title="David Hassell: &quot;[CF-metadata] same attribute name in variable and in global&quot;">Previous message</a> ]
[ <a href="./9632.html" title="David Hassell: &quot;[CF-metadata] same attribute name in variable and in global&quot;">In reply to</a> ]
<!-- unextthread="start" -->
[ <a href="./9646.html" accesskey="t" title="Chris Barker - NOAA Federal: &quot;[CF-metadata] same attribute name in variable and in global&quot;">Next in thread</a> ]
<!-- ureply="end" -->
</li>
</ul>
</map>
<ul class="links">
<li><a name="options2" id="options2"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="index.html#msg9633" title="Contemporary messages by date">by date</a> ] [ <a href="thread.html#msg9633" title="Contemporary discussion threads">by thread</a> ] [ <a href="subject.html#msg9633" title="Contemporary messages by subject">by subject</a> ] [ <a href="author.html#msg9633" title="Contemporary messages by author">by author</a> ] [ <a href="attachment.html" title="Contemporary messages by attachment">by messages with attachments</a> ]</li>
</ul>
</div>
<!-- body="start" -->
<div class="mail">
<address class="headers">
<span id="from">
<dfn>From</dfn>: Bärring Lars &lt;<a href="mailto:Lars.Barring?Subject=Re%3A%20%5BCF-metadata%5D%20same%20attribute%20name%20in%20variable%20and%20in%20global">Lars.Barring</a>&gt;
</span><br />
<span id="date"><dfn>Date</dfn>: Wed, 27 Mar 2019 20:10:18 +0000</span><br />
</address>
<br />
Hi David,
<br />
<br />Thanks for pointing me to the Trac ticket. I knew I had read this before somewhere, but now when the issue resurfaced in a very concrete sense I could not find it when searching the email archive, and I never thought of the Trac.
<br />
<br />First of all, I do agree that the convention should not be linked (restrained) to a specific file format or the concept of a file. And I do not want to retrace the discussion from 6 years ago. However, given the outcome back then I have two suggestions:
<br />
<br />1. I would wish that the convention would express more clearly what &quot;.... has precedence&quot; means, i.e. that it implies that the information held in the global attribute may not persist if duplicated by the same variable attribute. Indeed, your own inlined comment &quot;...(whatever that means!)&quot; suggests that something more is needed. The same goes for the language in the specification of the data model, i.e. I do not think that the word &quot;superseded&quot; is clear enough (but that might be due to limitations of my English language skills). Making this clear in both text I think is essential when incorporating the CF Data Model into the CF Conventions (&lt;<a href="https://github.com/cf-convention/cf-conventions/issues/159">https://github.com/cf-convention/cf-conventions/issues/159</a>&gt;).
<br />
<br />2. The initial post on this thread was prompted by that I noted that in many CMIP5 files CMOR had written different information (and relevant) in the variable history and the global history. And the global variable was actually not transferred through some processing steps. As CMIP5, and CMIP6, aims at publishing CF compliant data, I suggest that CMOR and/or its usage documentation is updated to prevent, or at least discourage, duplication of attributes.
<br />
<br /><br />Kind regards,
<br />
Lars
<br />
<br />________________________________
<br />
Fr?n: David Hassell [david.hassell at ncas.ac.uk]
<br />
Skickat: den 27 mars 2019 15:22
<br />
Till: B?rring Lars
<br />
Kopia: cf-metadata at cgd.ucar.edu
<br />
?mne: Re: [CF-metadata] same attribute name in variable and in global
<br />
<br />Hi Lars,
<br />
<br />Thanks for bringing this up. Here is the background, as I understand it, to the data model description of global attributes.
<br />
<br />The conventions do not state rules for combining attributes that appear both globally and on variables; rightly so, because there is no generically correct way to do it, even assuming that they are consistent. Which order to you concatenate strings? What if the attributes are numbers? Bearing this in mind, and noting that i) variable attributes take precedence (whatever that means!) and ii) the data model has no concept of a file (this is deliberate, as one of the aims of the data model is to transcend the file format), leads to the data model saying that &quot;netCDF global file attributes apply to every data variable in the file, except where they are superseded by netCDF data variable attributes with the same name.&quot;
<br />
<br />There was some of interesting discussion on this, around 6 years ago, in Trac ticket #95 (starting at <a href="https://cf-trac.llnl.gov/trac/ticket/95#comment:59">https://cf-trac.llnl.gov/trac/ticket/95#comment:59</a>). The current discussion, and the one in the Trac ticket, highlights that there are multiple interpretations of the conventions in common use, and that not all of these interpretations are suitable for all users.
<br />
<br />Even though the data model interpretation has to be as described, this does not preclude a software implementation of the data model from adding extra functionality to record the provenance of attributes, or even combing global/variable attributes in a particular manner. Software does this sort of thing all the time, for example in remembering netCDF variable names, which are also not part of the data model. For example, the cf-python library will note which field properties were global attributes in a file that it has read, so when you write the field back to disk it can create the same global attributes (assuming there that no inconsistencies have been introduced after the read ...).
<br />
<br />I hope this is useful,
<br />
<br />All the best,
<br />
David
<br />
<br />On Fri, 15 Mar 2019 at 12:48, B?rring Lars &lt;Lars.Barring at smhi.se&lt;mailto:Lars.Barring at smhi.se&gt;&gt; wrote:
<br />
Dear all,
<br />
<br />I have come across many CMIP5 files that have the same attribute [name] attached to the data variable as found in the globals.
<br />
<br />In particular it seems that CMOR was writing variable processing history attached to the variable, and more general file processing in the global history.
<br />
<br />I have also seen that &quot;comment&quot; sometimes occur both as global and as variable attribute.
<br />
<br />If such a duplication occurs, CF writes:
<br />
&quot;When an attribute appears both globally and as a variable attribute, the variable?s version has precedence.&quot;
<br />
<br />My interpretation of this is that if there are contradictory information then the variable's attribute has precedence, but otherwise it does not invalidate or overshadows what is in the global attribute.
<br />
<br />However, the data model presented in the GMD paper (<a href="https://www.geosci-model-dev.net/10/4619/2017/">https://www.geosci-model-dev.net/10/4619/2017/</a> page 4629, [page 11], under &quot;4.1 The field construct&quot;) presents a more restrictive interpretation:
<br />
&quot;In the data model, we consider that netCDF global file attributes apply to every data variable in the file, except where they are superseded by netCDF data variable attributes with the same name.&quot;
<br />
<br />I understand this to mean that if the same attributes (e.g. comment or history) is present both as global and variable attribute, then the global attribute is overshadowed (as if it did not exist at all)?
<br />
<br />Is this correct? If so, is this the best solution?
<br />
<br />Would not concatenating the information contained in each (putting the variable text first) be a more appropriate way to resolve the situation (and thus specify in the data model)?
<br />
<br /><br />Kind regards,
<br />
Lars
<br />
<br /><pre>
--
Lars B?rring
FDr, Forskare
PhD, Research Scientist
SMHI  /  Swedish Meteorological and Hydrological Institute
Rossby Centre
SE - 601 76 NORRK?PING
<a href="http://www.smhi.se">http://www.smhi.se</a>&lt;<a href="http://www.smhi.se/">http://www.smhi.se/</a>&gt;
E-post / Email: lars.barring at smhi.se&lt;mailto:lars.barring at smhi.se&gt;
Tel / Phone: +46 (0)11 495 8604
Fax: +46 (0)11 495 8001
Bes?ksadress / Visiting address: Folkborgsv?gen 17
_______________________________________________
CF-metadata mailing list
CF-metadata at cgd.ucar.edu&lt;mailto:CF-metadata at cgd.ucar.edu&gt;
<a href="http://mailman.cgd.ucar.edu/mailman/listinfo/cf-metadata">http://mailman.cgd.ucar.edu/mailman/listinfo/cf-metadata</a>
--
David Hassell
National Centre for Atmospheric Science
Department of Meteorology, University of Reading,
Earley Gate, PO Box 243, Reading RG6 6BB
Tel: +44 118 3785183
<a href="http://www.met.reading.ac.uk/">http://www.met.reading.ac.uk/</a>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<a href="http://mailman.cgd.ucar.edu/pipermail/cf-metadata/attachments/20190327/7db8dc61/attachment-0001.html">http://mailman.cgd.ucar.edu/pipermail/cf-metadata/attachments/20190327/7db8dc61/attachment-0001.html</a>&gt;
</pre>
<span id="received"><dfn>Received on</dfn> Wed Mar 27 2019 - 14:10:18 GMT</span>
</div>
<!-- body="end" -->
<div class="foot">
<map id="navbarfoot" name="navbarfoot" title="Related messages">
<ul class="links">
<li><dfn>This message</dfn>: [ <a href="#start9633">Message body</a> ]</li>
<!-- lnext="start" -->
<li><dfn>Next message</dfn>: <a href="./9634.html" title="Next message in the list">Dan Say: "[CF-metadata] New halocarbon standard name requests"</a></li>
<li><dfn>Previous message</dfn>: <a href="./9632.html" title="Previous message in the list">David Hassell: "[CF-metadata] same attribute name in variable and in global"</a></li>
<li><dfn>In reply to</dfn>: <a href="./9632.html" title="Message to which this message replies">David Hassell: "[CF-metadata] same attribute name in variable and in global"</a></li>
<!-- lnextthread="start" -->
<li><dfn>Next in thread</dfn>: <a href="./9646.html" title="Next message in this discussion thread">Chris Barker - NOAA Federal: "[CF-metadata] same attribute name in variable and in global"</a></li>
<!-- lreply="end" -->
</ul>
<ul class="links">
<li><a name="options3" id="options3"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="index.html#msg9633" title="Contemporary messages by date">by date</a> ] [ <a href="thread.html#msg9633" title="Contemporary discussion threads">by thread</a> ] [ <a href="subject.html#msg9633" title="Contemporary messages by subject">by subject</a> ] [ <a href="author.html#msg9633" title="Contemporary messages by author">by author</a> ] [ <a href="attachment.html" title="Contemporary messages by attachment">by messages with attachments</a> ]</li>
</ul>
</map>
</div>
<!-- trailer="footer" -->
<p><small><em>
This archive was generated by <a href="http://www.hypermail-project.org/">hypermail 2.3.0</a>
: Wed Jul 27 2022 - 12:59:34 BST
</em></small></p>
</body>
<p><a style="text-decoration:none" href="./9632.html"><img src="./red-arrow-left.jpg" width="50" alt="&lArr;"></a> <a style="text-decoration:none" href="./9634.html"><img src="./red-arrow-right.jpg" width="50" alt="&rArr;"></a></html>
