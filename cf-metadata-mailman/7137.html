<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
<meta name="generator" content="hypermail 2.3.0, see http://www.hypermail-project.org/" />
<title>[CF-metadata] How to define time coordinate in GPS? from Jim Biard on 2015-06-18 (cf-metadata-mailman)</title>
<meta name="Author" content="Jim Biard (jbiard)" />
<meta name="Subject" content="[CF-metadata] How to define time coordinate in GPS?" />
<meta name="Date" content="2015-06-18" />
<style type="text/css">
/*<![CDATA[*/
/* To be incorporated in the main stylesheet, don't code it in hypermail! */
body {color: black; background: #ffffff}
dfn {font-weight: bold;}
pre { background-color:inherit;}
.head { border-bottom:1px solid black;}
.foot { border-top:1px solid black;}
th {font-style:italic;}
table { margin-left:2em;}map ul {list-style:none;}
#mid { font-size:0.9em;}
#received { float:right;}
address { font-style:inherit ;}
/*]]>*/
.quotelev1 {color : #990099}
.quotelev2 {color : #ff7700}
.quotelev3 {color : #007799}
.quotelev4 {color : #95c500}
.period {font-weight: bold}
</style>
</head>
<body>
<div class="head">
<a style="text-decoration:none" href="./7136.html"><img src="./red-arrow-left.jpg" width="50" alt="&lArr;"></a> <a style="text-decoration:none" href="./7138.html"><img src="./red-arrow-right.jpg" width="50" alt="&rArr;"></a><h1>[CF-metadata] How to define time coordinate in GPS?</h1>
<!-- received="Thu Jun 18 11:18:41 2015" -->
<!-- isoreceived="20150618101841" -->
<!-- sent="Thu, 18 Jun 2015 13:18:41 -0400" -->
<!-- isosent="20150618171841" -->
<!-- name="Jim Biard" -->
<!-- email="jbiard" -->
<!-- subject="[CF-metadata] How to define time coordinate in GPS?" -->
<!-- id="5582FD71.1030601_at_cicsnc.org" -->
<!-- charset="US-ASCII" -->
<!-- inreplyto="20150612163007.GA2062_at_met.reading.ac.uk" -->
<!-- expires="-1" -->
<map id="navbar" name="navbar">
<ul class="links">
<li>
<dfn>This message</dfn>:
[ <a href="#start7137" name="options1" id="options1" tabindex="1">Message body</a> ]
 [ More options (<a href="#options2">top</a>, <a href="#options3">bottom</a>) ]
</li>
<li>
<dfn>Related messages</dfn>:
<!-- unext="start" -->
[ <a href="./7138.html" accesskey="d" title="alison.pamment at stfc.ac.uk: &quot;[CF-metadata] Practical Salinity units&quot;">Next message</a> ]
[ <a href="./7136.html" title="alison.pamment at stfc.ac.uk: &quot;[CF-metadata] Practical Salinity units&quot;">Previous message</a> ]
[ <a href="./7116.html" title="Jonathan Gregory: &quot;[CF-metadata] How to define time coordinate in GPS?&quot;">In reply to</a> ]
<!-- unextthread="start" -->
[ <a href="./7144.html" accesskey="t" title="Jonathan Gregory: &quot;[CF-metadata] How to define time coordinate in GPS?&quot;">Next in thread</a> ]
 [ <a href="#replies">Replies</a> ]
<!-- ureply="end" -->
</li>
</ul>
</map>
<ul class="links">
<li><a name="options2" id="options2"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="index.html#msg7137" title="Contemporary messages by date">by date</a> ] [ <a href="thread.html#msg7137" title="Contemporary discussion threads">by thread</a> ] [ <a href="subject.html#msg7137" title="Contemporary messages by subject">by subject</a> ] [ <a href="author.html#msg7137" title="Contemporary messages by author">by author</a> ] [ <a href="attachment.html" title="Contemporary messages by attachment">by messages with attachments</a> ]</li>
</ul>
</div>
<!-- body="start" -->
<div class="mail">
<address class="headers">
<span id="from">
<dfn>From</dfn>: Jim Biard &lt;<a href="mailto:jbiard?Subject=Re%3A%20%5BCF-metadata%5D%20How%20to%20define%20time%20coordinate%20in%20GPS%3F">jbiard</a>&gt;
</span><br />
<span id="date"><dfn>Date</dfn>: Thu, 18 Jun 2015 13:18:41 -0400</span><br />
</address>
<br />
Jonathan,
<br />
<br />On 6/12/15 12:30 PM, Jonathan Gregory wrote:
<br />
<em class="quotelev1">&gt; Dear Jim
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; It appears that we have some irreconcilable differences in interpretation but
</em><br />
<em class="quotelev1">&gt; I am not sure that they make any difference in practice, which is fortunate
</em><br />
<em class="quotelev1">&gt; if correct.
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev2">&gt;&gt; The definition of a calendar includes (by implication) the rules for how
</em><br />
<em class="quotelev2">&gt;&gt; to convert between an elapsed time count since a reference epoch and
</em><br />
<em class="quotelev2">&gt;&gt; a timestamp as expressed in that calendar.
</em><br />
<em class="quotelev1">&gt; Yes. The elapsed time count is the time coordinate. That's what I mean by the
</em><br />
<em class="quotelev1">&gt; rules for encoding and decoding. In addition, the calendar attribute states
</em><br />
<em class="quotelev1">&gt; the calendar of the reference time. (I can't understand why taking these
</em><br />
<em class="quotelev1">&gt; together doesn't mean that the attribute implies the calendar of the decoded
</em><br />
<em class="quotelev1">&gt; timestamps too, but I don't mind if we don't say that! I've always assumed
</em><br />
<em class="quotelev1">&gt; that the calendar is regarded as a property of the time coordinate construct
</em><br />
<em class="quotelev1">&gt; as a whole, because it's an attribute of the time coordinate variable.)
</em><br />
I'm good with that!
<br />
<em class="quotelev1">&gt; Yes, I agree that you can change the calendar without modifying the time
</em><br />
<em class="quotelev1">&gt; coordinate values if you instead alter the reference time so that it refers
</em><br />
<em class="quotelev1">&gt; to the same instant of real time in the new calendar. (I was considering the
</em><br />
<em class="quotelev1">&gt; case when you wished to keep the same reference time, say 1st Jan 2015, but
</em><br />
<em class="quotelev1">&gt; alter the calendar. In that case you have to add an offset to the coordinate
</em><br />
<em class="quotelev1">&gt; values, which can be done be decoding and reencoding or by other means, but
</em><br />
<em class="quotelev1">&gt; the method used isn't material to the definition, so there is no need to say
</em><br />
<em class="quotelev1">&gt; how this is done.)
</em><br />
<em class="quotelev1">&gt;
</em><br />
I agree again. The means is not important in a practical sense. When 
<br />
attempting to define the convention, it's a useful exercise to 
<br />
understand what the &quot;essential&quot; elements are.
<br />
<em class="quotelev2">&gt;&gt; Matching timestamps without conversion is exactly what you would
</em><br />
<em class="quotelev2">&gt;&gt; *not* want to do when comparing observations recorded using two
</em><br />
<em class="quotelev2">&gt;&gt; different real-world calendars.
</em><br />
<em class="quotelev1">&gt; That is true. But it is exactly what you do want to do when comparing real-
</em><br />
<em class="quotelev1">&gt; world and model calendars, or different model calendars, which is the common
</em><br />
<em class="quotelev1">&gt; case for a lot of CF data. In that common case, the timestamps are primary.
</em><br />
<em class="quotelev1">&gt; For example, climatological means, for which we have a CF conversion, assume
</em><br />
<em class="quotelev1">&gt; that users want to deal with time in a timestamp-based way, in which months
</em><br />
<em class="quotelev1">&gt; are equivalent regardless of calendar. It is inexact in a sense, but it's what
</em><br />
<em class="quotelev1">&gt; we need to do. More generally, you could argue that CF is quite a lot concerned
</em><br />
<em class="quotelev1">&gt; with the general problem of comparing apples and quinces. CF provides metadata
</em><br />
<em class="quotelev1">&gt; which enables users to indicate that the comparison is valid, by giving the
</em><br />
<em class="quotelev1">&gt; two things the same label.
</em><br />
Yes. The needs of the observations (and particularly satellite) 
<br />
community and the modeling community are different. A big part of my 
<br />
motivation in all this has been to make sure we don't paint anyone into 
<br />
a corner as we introduce changes to the time conventions. I'd say (as 
<br />
you mention below) that the job of CF is to describe what is present in 
<br />
a file, so that users can make informed decisions about how to use the 
<br />
data. I think it's best if CF doesn't try to tell users how they are 
<br />
supposed to use the data (as you mention below as well).
<br />
<em class="quotelev1">&gt; I don't think the question of whether timestamps are primary makes a material
</em><br />
<em class="quotelev1">&gt; difference to the convention or its use. It would be fine to state that the
</em><br />
<em class="quotelev1">&gt; encoded time coordinate is an elapsed time and has no discontinuities, except
</em><br />
<em class="quotelev1">&gt; for small ones in the case of using the no-leap-second calendar to encode UTC
</em><br />
<em class="quotelev1">&gt; time. I think we have to support this case because it is almost certainly in
</em><br />
<em class="quotelev1">&gt; use, perhaps widespread use, and it's better to be explicit about it. CF does
</em><br />
<em class="quotelev1">&gt; not generally try to tell people what to do, but to enable them to describe
</em><br />
<em class="quotelev1">&gt; clearly what they have done.
</em><br />
There are almost certainly files &quot;in the wild&quot; that have encoded 
<br />
discontinuities and/or offsets due to unwary application of software. I 
<br />
am completely fine with having some verbiage in the conventions 
<br />
mentioning this, but I'm not so sure about providing a way to tell 
<br />
someone, &quot;I played fast and loose with the time data.&quot;
<br />
<em class="quotelev1">&gt; I agree that seconds are always the same length. If only days were too! (But
</em><br />
<em class="quotelev1">&gt; they are in udunits, so we could warn against using days as a unit of time
</em><br />
<em class="quotelev1">&gt; in calendar=&quot;gregorian_utc&quot; because it could be confusing, although encoding
</em><br />
<em class="quotelev1">&gt; and decoding would work correctly.)
</em><br />
Time is horribly messy! Of course, from the udunits perspective, all 
<br />
days do have the same length. The confusion crops up if people start 
<br />
with UTC timestamps, encode them correctly, and expect their elapsed day 
<br />
numbers to remain nice integers or half integers (1.5, 2.5, etc) (or 
<br />
equivalent &quot;nice&quot; numbers) over time scales longer than the time between 
<br />
leap second appearances. Or if people start by storing &quot;nice&quot; elapsed 
<br />
times and expect all the results to come out as &quot;nice&quot; timestamps over 
<br />
those same long time scales.
<br />
<br />So it sounds like the only real open question is what, if anything, to 
<br />
do about cases where people use the wrong time functions to encode their 
<br />
elapsed times. (We can't do anything about people using the wrong 
<br />
functions to decode.) It seems to me that this amounts to providing a 
<br />
way for people to describe what algorithm was used to do the encode of 
<br />
their elapsed times and what calendar their original timestamps were 
<br />
expressed in (assuming that they started with timestamps), independent 
<br />
of what calendar the reference timestamp is expressed in. I think it's 
<br />
pushing the calendar definition pretty hard to include all three 
<br />
components above into a single package.
<br />
<br />As an example, the likely options that I can think of involving a 
<br />
Gregorian calendar with GPS and UTC are (there are plenty more, but I 
<br />
hope that the other combinations are highly unlikely and don't make much 
<br />
difference):
<br />
<br />Calendar for reference timestamp
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Calendar for input timestamp
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Encoding algorithm
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Comment
<br />
UTC or GPS
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UTC
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UTC
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;No errors.
<br />
UTC or GPS
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UTC
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GPS
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Possible errors.
<br />
Input timestamps assumed leap second free.
<br />
UTC or GPS
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GPS
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UTC
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Possible errors. (This option is pretty unlikely.)
<br />
Input timestamps assumed to have leap seconds.
<br />
UTC or GPS
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GPS
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GPS
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;No errors.
<br />
UTC or GPS
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;none
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;none
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;No errors. Original times are elapsed times.
<br />
<br /><br />The GPS timestamp to elapsed time encoding algorithm is (apart from 
<br />
epoch date &amp; time) the same as the POSIX algorithm assuming you haven't 
<br />
enabled POSIX leap second sensitivity (which is possible, but almost no 
<br />
one does it). It handles Gregorian leap days, but not leap seconds.
<br />
<br />Notice that the only times a problem arises are when there are input 
<br />
timestamps and the encoding algorithm doesn't match the input 
<br />
timestamps. The reference timestamp doesn't get involved. Since the only 
<br />
thing that affects the contents of the time variable is whether or not 
<br />
the encoding algorithm matched the input timestamp calendar, we could 
<br />
compress the input calendar and encoding algorithm columns of the table 
<br />
like so:
<br />
<br />Calendar for reference timestamp
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Properly encoded
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Comment
<br />
UTC or GPS
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yes
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;No errors.
<br />
UTC or GPS
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Possible errors.
<br />
Improper encoding algorithm used.
<br />
<br /><br />I'm not convinced that signaling the case where there was an encoding 
<br />
algorithm mismatch is best done by defining calendars that include 
<br />
mention of encoding errors in their definitions. Let's run with the idea 
<br />
though. If we exclude the unlikely cases (such as Gregorian+GPS with 
<br />
encoding errors), we get:
<br />
<br />Calendar
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Definition
<br />
gregorian_utc
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reference timestamp expressed in Gregorian calendar with UTC time 
<br />
system. Elapsed times are free of leap second errors.
<br />
gregorian_utc_lse
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gregorian_utc, but elapsed times are not necessarily free of leap 
<br />
second errors. There is no exact conversion between this and other 
<br />
calendars.
<br />
gregorian_gps
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reference timestamp expressed in Gregorian calendar with GPS time 
<br />
system. Elapsed times are free of leap second errors.
<br />
gregorian_nls
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reference timestamp expressed in Gregorian calendar with generic time 
<br />
system having 86400 seconds per day based at longitude 0 degrees. There 
<br />
is no exact conversion available between this and other calendars.
<br />
<br /><br />And, of course, there are the proleptic_gregorian, julian, 360_day, etc 
<br />
calendars, all of which use the generic NLS time system, and none of 
<br />
which can be exactly converted to other calendars.
<br />
<br />If we changed the definition of the 'gregorian' calendar to be the same 
<br />
as the 'gregorian_nls' calendar above and included some text warning 
<br />
people that resolutions of &lt; 1 minute are suspect, then we'd have a 
<br />
backward compatibility path. In fact, we could just use 'gregorian' to 
<br />
cover the 'gregorian_utc_lse' case.
<br />
<br />What do you think?
<br />
<em class="quotelev1">&gt; Best wishes
</em><br />
<em class="quotelev1">&gt;
</em><br />
<em class="quotelev1">&gt; Jonathan
</em><br />
<em class="quotelev1">&gt; _______________________________________________
</em><br />
<em class="quotelev1">&gt; CF-metadata mailing list
</em><br />
<em class="quotelev1">&gt; CF-metadata at cgd.ucar.edu
</em><br />
<em class="quotelev1">&gt; <a href="http://mailman.cgd.ucar.edu/mailman/listinfo/cf-metadata">http://mailman.cgd.ucar.edu/mailman/listinfo/cf-metadata</a>
</em><br />
Grace and peace,
<br />
<br />Jim
<br />
<pre>
-- 
CICS-NC &lt;<a href="http://www.cicsnc.org/">http://www.cicsnc.org/</a>&gt; Visit us on
Facebook &lt;<a href="http://www.facebook.com/cicsnc">http://www.facebook.com/cicsnc</a>&gt; 	*Jim Biard*
*Research Scholar*
Cooperative Institute for Climate and Satellites NC &lt;<a href="http://cicsnc.org/">http://cicsnc.org/</a>&gt;
North Carolina State University &lt;<a href="http://ncsu.edu/">http://ncsu.edu/</a>&gt;
NOAA National Centers for Environmental Information &lt;<a href="http://ncdc.noaa.gov/">http://ncdc.noaa.gov/</a>&gt;
/formerly NOAA?s National Climatic Data Center/
151 Patton Ave, Asheville, NC 28801
e: jbiard at cicsnc.org &lt;mailto:jbiard at cicsnc.org&gt;
o: +1 828 271 4900
/Connect with us on Facebook for climate 
&lt;<a href="https://www.facebook.com/NOAANCEIclimate">https://www.facebook.com/NOAANCEIclimate</a>&gt; and ocean and geophysics 
&lt;<a href="https://www.facebook.com/NOAANCEIoceangeo">https://www.facebook.com/NOAANCEIoceangeo</a>&gt; information, and follow us 
on Twitter at _at_NOAANCEIclimate &lt;<a href="https://twitter.com/NOAANCEIclimate">https://twitter.com/NOAANCEIclimate</a>&gt; and 
_at_NOAANCEIocngeo &lt;<a href="https://twitter.com/NOAANCEIocngeo">https://twitter.com/NOAANCEIocngeo</a>&gt;. /
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<a href="http://mailman.cgd.ucar.edu/pipermail/cf-metadata/attachments/20150618/2a228b42/attachment-0001.html">http://mailman.cgd.ucar.edu/pipermail/cf-metadata/attachments/20150618/2a228b42/attachment-0001.html</a>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: image/png
Size: 15784 bytes
Desc: not available
URL: &lt;<a href="http://mailman.cgd.ucar.edu/pipermail/cf-metadata/attachments/20150618/2a228b42/attachment-0001.png">http://mailman.cgd.ucar.edu/pipermail/cf-metadata/attachments/20150618/2a228b42/attachment-0001.png</a>&gt;
</pre>
<span id="received"><dfn>Received on</dfn> Thu Jun 18 2015 - 11:18:41 BST</span>
</div>
<!-- body="end" -->
<div class="foot">
<map id="navbarfoot" name="navbarfoot" title="Related messages">
<ul class="links">
<li><dfn>This message</dfn>: [ <a href="#start7137">Message body</a> ]</li>
<!-- lnext="start" -->
<li><dfn>Next message</dfn>: <a href="./7138.html" title="Next message in the list">alison.pamment at stfc.ac.uk: "[CF-metadata] Practical Salinity units"</a></li>
<li><dfn>Previous message</dfn>: <a href="./7136.html" title="Previous message in the list">alison.pamment at stfc.ac.uk: "[CF-metadata] Practical Salinity units"</a></li>
<li><dfn>In reply to</dfn>: <a href="./7116.html" title="Message to which this message replies">Jonathan Gregory: "[CF-metadata] How to define time coordinate in GPS?"</a></li>
<!-- lnextthread="start" -->
<li><dfn>Next in thread</dfn>: <a href="./7144.html" title="Next message in this discussion thread">Jonathan Gregory: "[CF-metadata] How to define time coordinate in GPS?"</a></li>
<li><a name="replies" id="replies"></a>
<dfn>Reply</dfn>: <a href="./7144.html" title="Message sent in reply to this message">Jonathan Gregory: "[CF-metadata] How to define time coordinate in GPS?"</a></li>
<!-- lreply="end" -->
</ul>
<ul class="links">
<li><a name="options3" id="options3"></a><dfn>Contemporary messages sorted</dfn>: [ <a href="index.html#msg7137" title="Contemporary messages by date">by date</a> ] [ <a href="thread.html#msg7137" title="Contemporary discussion threads">by thread</a> ] [ <a href="subject.html#msg7137" title="Contemporary messages by subject">by subject</a> ] [ <a href="author.html#msg7137" title="Contemporary messages by author">by author</a> ] [ <a href="attachment.html" title="Contemporary messages by attachment">by messages with attachments</a> ]</li>
</ul>
</map>
</div>
<!-- trailer="footer" -->
<p><small><em>
This archive was generated by <a href="http://www.hypermail-project.org/">hypermail 2.3.0</a>
: Wed Jul 27 2022 - 12:58:57 BST
</em></small></p>
</body>
<p><a style="text-decoration:none" href="./7136.html"><img src="./red-arrow-left.jpg" width="50" alt="&lArr;"></a> <a style="text-decoration:none" href="./7138.html"><img src="./red-arrow-right.jpg" width="50" alt="&rArr;"></a></html>
